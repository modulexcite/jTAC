jTAC._internal.temp._TypeManagers_BaseRegionString={extend:"TypeManagers.BaseString","abstract":true,constructor:function(a){this.callParent([a])},config:{region:"",regionsData:null},configrules:{},_nativeToString:function(b){if(b==null){return""}var c=b.toString();if(c==""){return""}var a=this._getRegionNode(c);if(!a){this._inputError("Invalid "+this.dataTypeName())}if(a.toFormat){c=a.toFormat(c)}return c},_reviewValue:function(b){b=this.callParent([b]);if(b==""){return b}var a=this._getRegionNode(b);if(!a){this._inputError("Invalid "+this.dataTypeName()+" ["+b+"]")}return b},isValidChar:function(d){if(!this.callParent([d])){return false}var a=this._selectRegionNodes();if(!a.length){return true}for(var b=0;b<a.length;b++){var e=a[b];if(!e.validChar){return true}if(typeof e.validChar=="string"){var c=this._cache.validCharRE;if(!c){c=this._cache=new RegExp(e.validChar)}return c.test(d)}if(e.validChar(d)){return true}}return false},toValueNeutral:function(b){if(!b){return""}try{this._pushContext();var a=this._getRegionNode(b);if(!a){this._inputError("Invalid "+this.dataTypeName()+" ["+b+"]")}if(a.toNeutral){b=a.toNeutral(b)}return b}finally{this._popContext()}},_selectRegionNodes:function(){function d(j){var h=j.split("|");var f=this.getRegionsData();for(var e=0;e<h.length;e++){var g=f[h[e]];if(!g){this._error("Region ["+h[e]+"] not defined in the regionsData object.")}if(typeof g=="string"){d.call(this,g);continue}if(typeof g=="object"){c.push(g)}else{this._error("Region ["+g+"] definition invalid.")}}}var a=this._internal.rds;if(!a||(this._internal.rdc!=jTAC._globalRegionNameCount)){var b=this.getRegion();if(b==""){b=this.getRegionsData().defaultName}if(b=="GLOBAL"){b=jTAC._globalRegionName}if(!b){this._error("Could not identify a region name from the region property.")}var c=[];d.call(this,b);a=this._internal.rds=c;this._internal.rdc=jTAC._globalRegionNameCount}return a},_getRegionNode:function(e){var d=this._selectRegionNodes();for(var b=0;b<d.length;b++){var a=d[b];if(!e){return a}if(typeof a.pattern=="function"){if(a.call(this,e)){return a}}else{var c=new RegExp(this._resolvePattern.call(this,a),a.caseIns?"i":"");if(c.test(e)){return a}}}return null},_resolvePattern:function(a){return a.pattern},_defaultRegionsData:function(){this._AM()},applyNumberMask:function(k,n,c,e){var l=c?0:k.length-1;var d=c?0:n.length-1;var b=c?1:-1;var g=c?k.length:-1;var j=c?n.length-1:0;var a="";for(var h=d;c?h<=j:h>=j;h=h+b){var f=n.charAt(h);if(f=="#"){do{if(l==g){f=e;break}f=k.charAt(l);l=l+b}while((f<"0")||(f>"9"))}if(c){a=a+f}else{a=f+a}}if(l!=g){for(var h=l;c?h<g:h>g;h=h+b){var f=k.charAt(h);if((f>="0")&&(f<="9")){if(c){a=a+f}else{a=f+a}}}}return a},setRegion:function(a){this.config.region=jTAC.checkAsStr(a);this._internal.rds=null},getRegionsData:function(){var a=this.config.regionsData;if(!a){a=this.config.regionsData=this._defaultRegionsData()}return a},setRegionsData:function(a){if(typeof(a)!="object"){this._error("RegionsData must be an object")}this.config.regionsData=a}};jTAC.define("TypeManagers.BaseRegionString",jTAC._internal.temp._TypeManagers_BaseRegionString);jTAC.setGlobalRegionName=function(a){jTAC._globalRegionName=a;jTAC._globalRegionNameCount++};jTAC._globalRegionName=null;jTAC._globalRegionNameCount=0;