jTAC._internal.temp._CalcItems_Element={extend:"CalcItems.Base",require:["CalcItems.Null","CalcItems.NaN","Connections.FormElement","TypeManagers.BaseNumber"],constructor:function(a){this.callParent([a])},config:{datatype:"",typeManager:null,connection:"Connections.FormElement",elementId:null,valueWhenNull:"CalcItems.Null",valueWhenInvalid:"CalcItems.NaN"},configrules:{typeManager:jTAC.checkAsTypeManagerOrNull,connection:jTAC.checkAsConnectionOrNull,valueWhenNull:jTAC.checkAsCalcItem,valueWhenInvalid:jTAC.checkAsCalcItem},canEvaluate:function(){var a=this.getConnection();if(!a||!a.getElement(true)){return false}return this.callParent()},evaluate:function(){try{this._pushContext();var c=this.getConnection();if(c){if(c.isNullValue()){var d=this.getValueWhenNull();if(!d||!d.canEvaluate()){return null}return d.evaluate()}var b=this.getTypeManager();if(!b){b=c.getTypeManager();if(!b){b=jTAC.create("TypeManagers.Float")}this.setTypeManager(b)}try{if(!c.isValidValue(b.storageTypeName())){throw new Error()}var g=b.toValueFromConnection(c);return b.toNumber(g)}catch(f){var a=this.getValueWhenInvalid();if(!a||!a.canEvaluate()){return NaN}return a.evaluate()}}else{return NaN}}finally{this._popContext()}},collectConnections:function(b){var a=this.getConnection();if(a){b.push(a)}},parse:function(d,f){try{this._pushContext();this._checkParser(f);var c,e,a,b;c=f.asId(d);if(c){return{obj:jTAC.create("CalcItems.Element",{elementId:c.id}),rem:c.rem}}c=f.asExact(d,"Element(",false,false,null);if(c){d=c.rem;c=f.asId(d,true);d=c.rem;var e=c.id;c=f.cParen(d,true);d=c.rem;return{obj:jTAC.create("CalcItems.Element",{elementId:e}),rem:d}}return null}finally{this._popContext()}},getDatatype:function(){return this.config.typeManager?this.config.typeManager.dataTypeName():null},setDatatype:function(a){this.setTypeManager(a)},getElementId:function(){var a=this.config.connection;return a&&a.getId?a.getId():null},setElementId:function(c){if(typeof c=="object"){this.setConnnection(c)}else{var b=jTAC.create("Connections.FormElement",{id:c,allowNone:true});var a=jTAC.connectionResolver.create(c,b);this.config.connection=a?a:b}}};jTAC.define("CalcItems.Element",jTAC._internal.temp._CalcItems_Element);if(jTAC.parser){jTAC.parser.register("CalcItems.Element")};