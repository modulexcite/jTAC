var jTAC=(function(){var definitions={};var aliases={};function define(fullClassName,members,replace){function member(name,typeName,missing,del){var val=members[name]||missing;if(val!=null){if(typeof val!=typeName){me.error(name+" parameter must be a "+typeName+".")}}delete members[name];return val}var me=jTAC;try{pushContext("jTAC.define('"+fullClassName+"')");if(!members||(typeof members!="object")){me.error("Members parameter must be an object.")}var nspath=fullClassName.split(".");var className=nspath.pop();var definition=definitions[fullClassName];if(definition&&!replace){me.error("["+fullClassName+"] is already defined.")}var parentName=member("extend","string",null);if(parentName){me.require(parentName)}var parentClass=parentName?me.getClass(parentName,true):null;var ctor=member("constructor","function",null);if(ctor&&ctor.toString().indexOf("function Object()")>-1){ctor=null}if(!ctor){ctor=function(propertyVals){if(parentClass){this.$parentClass.prototype.$ctor(propertyVals)}}}var newconfig=member("config","object");var newconfigrules=member("configrules","object");var abs=member("abstract","boolean",false);var require=members.require||null;if(require){if((typeof require!="string")&&!(require instanceof Array)){me.error("require property must be a string or array of strings")}jTAC.require(require)}delete members.require;var config=function(){};if(parentClass){config.prototype=new parentClass.prototype.config()}if(newconfig){me.extend(newconfig,config.prototype)}var configrules=function(){};if(parentClass){configrules.prototype=new parentClass.prototype.configrules()}if(newconfigrules){me.extend(newconfigrules,configrules.prototype)}_setupConfigRules(config.prototype,configrules);var newClass=function(){this.$className=className;this.$parentName=parentName||"";this.$parentClass=parentClass;this.$fullClassName=fullClassName;this.$require=require;this.$abstract=abs;this.$uniqueid=jTAC._internal.uniqueid++;this.config={};this._internal={};this._cache={};me.extend(config.prototype,this.config,true);this.configrules={};me.extend(configrules.prototype,this.configrules,true);if(config){this._defineProperties.call(this,config)}};_buildUserPath.call(me,nspath,className,newClass);if(parentClass){newClass.prototype=new parentClass()}else{me.extend(jTACClassBase,newClass.prototype)}me.extend(members,newClass.prototype);if(newconfig){newClass.prototype._autoGetSet.call(newClass,newconfig,configrules)}newClass.prototype.config=config;newClass.prototype.configrules=configrules;newClass.prototype.$ctor=ctor;_registerNewMethodNames(newClass,parentClass,fullClassName);definitions[fullClassName]={ctor:newClass,inst:new newClass()}}finally{popContext()}}function isDefined(fullClassName){return jTAC.getClass(fullClassName,false)!=null}function addMembers(fullClassName,members){try{pushContext("jTAC.addMembers('"+fullClassName+"')");var me=jTAC;if(typeof members=="object"){var def=jTAC.getDefinition(fullClassName);if(!def){me.error("className ["+fullClassName+"] not defined. Requires a case sensitive match.")}var proto=def.ctor.prototype;var config=null;for(var name in members){switch(name){case"config":config=members[name];me.extend(config,proto.config.prototype);break;case"configrule":me.extend(members[name],proto.configrules.prototype);break;default:proto[name]=members[name];if(typeof proto[name]=="function"){proto[name].$owner=def.inst.$parentClass;proto[name].$name=name;proto[name].$fullClassName=def.inst.$fullClassName}break}}if(config){_setupConfigRules(config,proto.configrules);proto._autoGetSet.call(def.ctor,config,proto.configrules)}}else{me.error("Illegal param")}}finally{popContext()}}function createByClassName(fullClassName,propertyVals,optional){try{pushContext("jTAC.createByClassName('"+fullClassName+"')");var me=jTAC;var classFnc=me.getClass(fullClassName,false);if(classFnc==null){if(optional){return null}_scriptFileMissing(fullClassName)}var obj=new classFnc();if(obj.$abstract){me.error("Cannot create ["+fullClassName+"]. It is marked abstract.")}obj.init.call(obj,propertyVals);return obj}finally{popContext()}}function _scriptFileMissing(fullClassName){jTAC.error("className ["+fullClassName+"] not defined. Check that the script file is loaded. The name is case sensitive.")}function require(fullClassNames){if(typeof(fullClassNames)=="string"){fullClassNames=[fullClassNames]}for(var i=0;i<fullClassNames.length;i++){var r=jTAC.getClass(fullClassNames[i],false);if(!r){_scriptFileMissing(fullClassNames[i])}}}function defineAlias(aliasName,fullClassName,propertyVals,replace,optional){var me=jTAC;if(aliases[aliasName]&&!replace){me.error("alias named ["+aliasName+"] is already defined.")}var cl=me.getClass(fullClassName,!optional);if(cl){if(propertyVals===undefined){propertyVals=null}aliases[aliasName]={className:fullClassName,propertyVals:propertyVals}}}function create(name,propertyVals,optional){try{pushContext("jTAC.create('"+name+"')");var me=jTAC;if(!name){if(!propertyVals){me.error("Must supply parameters")}name=propertyVals.jtacClass;if(!name){me.error("Must either pass a class name or assign the jtacClass property to a class name in the propertyVals object.")}}var alias=aliases[name];if(alias){var obj=me.create(alias.className,alias.propertyVals);if(propertyVals){if(typeof propertyVals=="function"){propertyVals.call(obj,obj,alias.className,name)}else{obj.setProperties.call(obj,propertyVals)}}return obj}return me.createByClassName(name,propertyVals,optional)}finally{popContext()}}function _buildUserPath(namespaces,className,ctor){var me=jTAC;var current=me;var nspath=namespaces;if(typeof namespaces=="string"){nspath=namespaces?namespaces.split("."):[]}for(var i=0;i<nspath.length;i++){var name=nspath[i];if(name=="jTAC"){continue}if(!name){me.error("Empty namespace is illegal")}var child=current[name];if(!child){current[name]=child={};child._parent=current}current=child}current[className]=ctor}function getClass(fullClassName,throwError){var def=getDefinition(fullClassName);if(!def){if(throwError){_scriptFileMissing(fullClassName)}return null}return def.ctor}function getDefinition(fullClassName){var me=jTAC;fullClassName=fullClassName.replace("jTAC.","");return definitions[fullClassName]}function inheritsFrom(fullClassName,anotherClassName){var def=getDefinition(fullClassName);if(!def){_scriptFileMissing(fullClassName)}return def.inst.instanceOf(anotherClassName)}function _setupConfigRules(config,configrules){for(var name in config){var obj=configrules.prototype[name];var fnc=null;if(obj){if(typeof obj=="function"){configrules.prototype[name]={valFnc:obj};continue}else{if(obj instanceof Array){configrules.prototype[name]={values:obj};continue}else{fnc=obj.valFnc}}}if(fnc){continue}if(obj&&obj.values){continue}var val=config[name];switch(typeof val){case"boolean":fnc=jTAC.checkAsBool;break;case"number":fnc=jTAC.checkAsInt;break;case"string":fnc=jTAC.checkAsStr;break;case"object":if(val instanceof RegExp){fnc=jTAC.checkAsRegExp}else{if(val instanceof Array){fnc=jTAC.checkAsArray}}break}if(fnc){if(!obj){configrules.prototype[name]=obj={}}obj.valFnc=fnc}}}function _registerNewMethodNames(newClass,parentClass,fullClassName){var skipnames=["config","$parentClass"];var proto=newClass.prototype;for(var name in proto){if(skipnames.indexOf(name)>-1){continue}if(proto.hasOwnProperty(name)){var val=proto[name];if(typeof val=="function"){val.$owner=parentClass;val.$name=name;val.$fullClassName=fullClassName}}}}function silentWarnings(bool){if(!arguments.length){return _silentWarnings}return _silentWarnings=bool}var _silentWarnings=false;var _errorActionStack=[];function pushContext(action,value){if(!action){var c=pushContext.caller;while(!action&&c&&c.$name){action=c.$name;if(["_pushContext"].indexOf(action)>-1){action="";c=c.caller}if(action){action=c.$fullClassName+"."+action+"()"}}}if(action&&(value!=null)){action+=" ["+value.toString()+"]"}_errorActionStack.push(action)}function popContext(){return _errorActionStack.pop()}function actionStack(){return _errorActionStack.join("> ")}function _logAndThrow(msg,inst,action,noThrow,caller,consolemode){if(window.console){if(inst&&inst.$className){msg="["+inst.$fullClassName+"]  Message: "+msg}var as=actionStack();while(!action&&caller&&caller.$name){action=caller.$name;if(["_error","_inputError","_AM","_DM","err"].indexOf(action)>-1){action="";caller=caller.caller}if(action){action=caller.$fullClassName+"."+action+"()"}}if(as){action=as+(action?"> "+action:"")}if(action){msg+="   Context: "+action+""}if(!consolemode||(consolemode=="error")){console.error(msg)}else{eval("console."+consolemode+"(msg);")}if(console.trace){console.trace()}}if(!noThrow){throw new Error(msg)}}var staticMethods={error:function(msg,inst,action,noThrow){_logAndThrow(msg,inst,action,noThrow,this.error.caller,"error")},inputError:function(msg,inst,action,noThrow){_logAndThrow(msg,inst,action,noThrow,this.inputError.caller,"log")},warn:function(msg,inst,action){_logAndThrow(msg,inst,action,true,this.error.caller,"warn")},trimStr:function(value){return(value+"").replace(/^\s+|\s+$/g,"")},escapeRE:function(text){return text.replace(/[-[\]{}()*+?.,\\^$|#\s:]/g,"\\$&")},delimitedRE:function(text,delim){if(delim==null){delim="\\s"}return new RegExp("(^|"+delim+")"+jTAC.escapeRE(text)+"("+delim+"|$)")},replaceAll:function(text,find,replace,escape){if(escape){find=jTAC.escapeRE(find)}var re=new RegExp(find,"ig");return text.replace(re,replace)},contains:function(text,find,escape){if(escape){find=jTAC.escapeRE(find)}var re=new RegExp(find,"ig");return re.test(text)},htmlEncode:function(text){return String(text).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},checkAsInt:function(value,defaultval){if(value==null){if(defaultval===undefined){jTAC.error("Null is not allowed. Must be an integer.")}else{return defaultval}}if(typeof(value)=="string"){value=parseFloat(value)}if((typeof(value)!="number")||isNaN(value)||(Math.floor(value)!=value)){jTAC.error("Illegal value. Must be an integer.")}return value},checkAsIntOrNull:function(value){if((value==null)||(value==="")){return null}return jTAC.checkAsInt(value)},checkAsNumber:function(value,defaultval){if(value==null){if(defaultval===undefined){jTAC.error("Null is not allowed. Must be an integer.")}else{return defaultval}}if(typeof(value)=="string"){value=parseFloat(value)}if((typeof(value)!="number")||isNaN(value)){jTAC.error("Illegal value. Must be a number.")}return value},checkAsNumberOrNull:function(value){if((value==null)||(value==="")){return null}return jTAC.checkAsNumber(value)},checkAsBool:function(value,defaultval){if(value==null){if(defaultval===undefined){jTAC.error("Null is not allowed. Must be an boolean.")}else{return defaultval}}switch(typeof(value)){case"boolean":break;case"string":if(value.toLowerCase()=="true"){value=true}else{if(value.toLowerCase()=="false"){value=false}else{value=undefined}}break;case"number":if(value==1){value=true}else{if(value==0){value=false}else{value=undefined}}break;default:value=undefined;break}if(value===undefined){jTAC.error("Illegal value. Must be an boolean.")}return value},checkAsBoolOrNull:function(value){if((value==null)||(value==="")){return null}return jTAC.checkAsBool(value)},checkAsStr:function(value,defaultval){if(value==null){if(defaultval===undefined){jTAC.error("Null is not allowed. Must be a string.")}else{return defaultval}}if(typeof(value)=="number"){value=value.toString()}else{if(typeof(value)!="string"){jTAC.error("Illegal value. Must be a string.")}}return value},checkAsStrOrNull:function(value){return jTAC.checkAsStr(value,null)},checkAsClass:function(val,existingObject,classCtor){if(((val==null)||(val==""))&&(existingObject!==undefined)){return existingObject||null}try{jTAC._internal.pushContext("jTAC.checkAsClass");if(val&&(typeof val=="object")&&!val.$className){if(val.jtacClass){val=jTAC.create(null,val)}else{if(existingObject){existingObject.setProperties(val);return existingObject}}}else{if(typeof(val)=="string"){val=jTAC.create(val,null,true)}}if(val instanceof classCtor){return val}var name=val?val.$fullClassName:(existingObject?existingObject.$fullClassName:"n/a");jTAC.error("Property does not support the class ["+name+"].")}finally{jTAC._internal.popContext()}},checkAsRegExp:function(val){if((val instanceof RegExp)||(val==null)){return val}if(typeof val=="string"){try{return new RegExp(val)}catch(e){jTAC.error("Invalid regular expression pattern. Error: "+e.message)}}jTAC.error("Invalid type in 'val' parameter.")},checkAsArray:function(value,defaultval){if(value==null){if(defaultval===undefined){jTAC.error("Null is not allowed. Must be an integer.")}else{return defaultval}}if(value instanceof Array){return value}jTAC.error("Illegal value. Must be an array.")},checkAsFunction:function(value,defaultval){if(value==null){if(defaultval===undefined){jTAC.error("Null is not allowed. Must be a function.")}else{return defaultval}}if(typeof(value)=="string"){value=window[value];if(!value){jTAC.error("Function ["+value+"] not defined on the window object.")}}if((typeof(value)!="function")){jTAC.error("Illegal value. Must be a function.")}return value},checkAsFunctionOrNull:function(value,defaultval){return jTAC.checkAsFunction(value,null)},extend:function(src,dest,deep){if((typeof src=="object")&&(typeof dest=="object")){for(var name in src){dest[name]=deep?jTAC.clone(src[name]):src[name]}}else{jTAC.error("Illegal param")}},clone:function(item){if(item==null){return null}if(typeof item=="object"){if(item instanceof Array){var a=[];for(var i=0;i<item.length;i++){a[i]=jTAC.clone(item[i])}return a}if(item instanceof Date){return new Date(item.getTime())}if(item.constructor===Object){var newObj={};for(name in item){newObj[name]=jTAC.clone(item[name])}return newObj}}return item}};var publics={define:define,defineAlias:defineAlias,addMembers:addMembers,isDefined:isDefined,createByClassName:createByClassName,create:create,require:require,getClass:getClass,getDefinition:getDefinition,silentWarnings:silentWarnings};staticMethods.extend(staticMethods,publics);publics._internal={definitions:definitions,aliases:aliases,pushContext:pushContext,popContext:popContext,actionStack:actionStack,uniqueid:0,temp:{}};return publics})();var jTACClassBase={$className:null,getName:function(){return $className},$parentName:null,$parentClass:null,$fullClassName:null,$abstract:false,$require:null,config:null,_internal:null,_cache:null,init:function(a){this._reviewDefaults.call(this);if(this.$ctor){this.$ctor.call(this,a)}if(a){if(typeof a=="function"){a.call(this,this,this.$className)}else{this.setProperties.call(this,a)}}},implement:function(a){jTAC.extend(a,this.prototype)},callParent:function(d){if(d&&(typeof d!="object")){this._error("Arguments must be enclosed in an array.")}if(this.$className===undefined){this._error("Only supports classes defined by jTAC.define().")}var c=this.callParent.caller;if(!c){this._error("No caller")}var a=c.$name;if(!a){this._error("Not registered correctly.")}if(!c.$owner){this._error("No parent class defined.")}var b=c.$owner.prototype[a];if(!b){this._error("Parent does not define the method ["+a+"].")}return b.apply(this,d||[])},instanceOf:function(a){var b=this;do{if(b.$fullClassName==a){return true}b=b.$parentClass}while(b!=null);return false},getProperty:function(b){try{this._pushContext(this.$fullClassName+".getProperty('"+b+"')");var c=this._propNameToUpper(b);var a=this["get"+c];if(a){return a.call(this)}return undefined}finally{this._popContext()}},setProperty:function(a,b){try{this._pushContext(this.$fullClassName+".setProperty('"+a+"')");var c=this._propNameToUpper(a);var d=this["set"+c];if(d){d.call(this,b);return true}return false}finally{this._popContext()}},setProperties:function(b){for(var a in b){if(a=="jtacClass"){continue}this.setProperty(a,b[a])}},_propNameToUpper:function(a){return a.charAt(0).toUpperCase()+a.substr(1)},_autoGetSet:function(b,c){function f(m){var l=c.prototype[m]||null;var j=!l||(l.autoGet!=false);var h=!l||(l.autoSet!=false);var k=proto._propNameToUpper(m);var g=proto["get"+k];var n=proto["set"+k];if(!g&&j){proto["get"+k]=function(){return this.config[m]}}if(!n&&h){proto["set"+k]=function(o){this._defaultSetter.call(this,m,o)}}}proto=this.prototype;for(var a in b){var d=b[a];if(d===undefined){continue}f(a)}},_defaultSetter:function(b,d){var c=this.configrules[b];if(c){var f=(typeof c=="function")?c:f=c.valFnc;if(f){d=f.call(this,d)}else{var a=c instanceof Array?c:c.values;if(a){if(a.indexOf(d)==-1){jTAC.error("Requires one of these values: "+a.join(", "))}}}if(c.clearCache){this._clearCache()}}this.config[b]=d},_defineProperties:function(b){for(var a in b.prototype){var c=b.prototype[a];if(c===undefined){continue}this._defineProperty(a)}},_defineProperty:function(b){if(Object.defineProperty){var d=this;var c=d._propNameToUpper(b);var a=d["get"+c];if(a&&(typeof a!="function")){return}var f=d["set"+c];if(f&&(typeof f!="function")){return}Object.defineProperty(d,b,{get:function(){if(a){try{d._pushContext(d.$fullClassName+"."+a.$name);return a.call(d)}finally{d._popContext()}}},set:function(g){if(f){try{d._pushContext(d.$fullClassName+"."+f.$name);f.call(d,g)}finally{d._popContext()}}}})}},_reviewDefaults:function(){var c=this;for(var a in c.config){var d=c.config[a];if(d==null){continue}var b=c._propNameToUpper(a);var f=c["set"+b];if(!f||(typeof f!="function")){continue}f.call(c,d)}},_clearCache:function(){this._cache={};var a=this._internal.children;if(a){for(var b in a){a[b]._clearCache()}}},_registerChild:function(b){var a=this._internal.children;if(!a){a=this._internal.children=[]}a.push(b)},_AM:function(){jTAC.error("Not supported. Abstract method.",this)},_DM:function(){jTAC.error("Not supported method.",this)},_pushContext:function(b,a){jTAC._internal.pushContext(b,a)},_popContext:function(){return jTAC._internal.popContext()},_error:function(b,a){jTAC.error(b,this,a)},_inputError:function(b,a){jTAC.inputError(b,this,a)},_warn:function(c,b,a){jTAC.warn(c,b,a)}};jTAC.translations={register:function(c,a){var b=jTAC.translations[c];if(b==null){jTAC.translations[c]=b={}}jTAC.extend(a,b,true);jTAC.translations.setLanguage(c)},setLanguage:function(a){if(jTAC.translations[a]==null){jTAC.error("Requested the language for ["+a+"]. It has not be registered with jTAC.translations.")}jTAC.translations.current=jTAC.translations[a]},lookup:function(d,g,h){if(!d){return g}var c=jTAC.translations;var b=c.current;if(b==null){return g}if(h&&(b==c[""])){return g}var f=b[d];if((f==null)&&!h){var a=c[""];if(a&&(a!==b)){f=tn[d]}}return f!=null?f:g}};var jTAC_Temp;if(!window.jTAC){throw new Error("window.jTAC not created.")}jTAC._internal.temp._Connections_Base={"abstract":true,constructor:function(a){},config:{defaultLabel:"Field",defaultLookupKey:null},configrules:{defaultLookupKey:jTAC.checkAsStrOrNull},getTextValue:function(){this.AM()},setTextValue:function(a){this.AM()},typeSupported:function(a){this.AM()},getTypedValue:function(a){this.AM()},setTypedValue:function(a){this.AM()},isNullValue:function(a){this.AM()},isValidValue:function(a){if(!this.typeSupported(a)){return true}if(this.isNullValue()){return true}try{var c=this.getTypedValue(a);if((c==null)||isNaN(c)){return false}}catch(b){return false}return true},textLength:function(){var a=this.getTextValue();return a?a.length:0},isEditable:function(){return true},getLabel:function(){return jTAC.translations.lookup(this.getDefaultLookupKey(),this.getDefaultLabel())},getTypeManager:function(){return null}};jTAC.define("Connections.Base",jTAC._internal.temp._Connections_Base);jTAC.checkAsConnection=function(b,a){return jTAC.checkAsClass(b,a,jTAC.Connections.Base)};jTAC.checkAsConnectionOrNull=function(a){return jTAC.checkAsConnection(a,null)};jTAC._internal.temp._Connections_BaseElement={extend:"Connections.Base","abstract":true,constructor:function(a){this.callParent([a])},config:{id:null,allowNone:false,trim:true,unassigned:null,unassignedCase:false},configrules:{id:jTAC.checkAsStrOrNull,unassigned:jTAC.checkAsStrOrNull},getElement:function(b){try{this._pushContext();if(this._internal.element!=null){return this._internal.element}var c=this.getId();if(!c){if(b==null){b=this.getAllowNone()}if(!b){this._error("Did not assign the id.")}return null}var a=document.getElementById(c);if(a){this._checkElement(a)}else{if(!a&&!this.getAllowNone()){this._error("HTML Element not found for "+c)}}return a}finally{this._popContext()}},setElement:function(a){this._internal.element=a},_checkElement:function(a){this.AM()},addEventListener:function(a,b,c){return false},addSupportEventListeners:function(a,b,c){},testElement:function(a){return false},testElementAndCreate:function(b){if(this.testElement(b)){var a=jTAC.createByClassName(this.$fullClassName);(typeof b=="string")?a.setId(b):a.setElement(b);return a}return null},getTypeManager:function(){var a,b=this.getElement(true);if(b){var a=this.getData("typemanager");if(a){return a}a=this._createTypeManager(b);if(a){if(a instanceof jTAC.TypeManagers.Base){this.setData("typemanager",a);return a}}}return null},_createTypeManager:function(el){try{this._pushContext();var tm=this.getData("typemanager");if(tm){return tm}tm=this.getData("jtac-typemanager");if(tm){if(typeof tm=="string"){try{tm=eval("("+tm+");")}catch(e){jTAC.error("JSon parsing error. "+e.message,this,null,true)}}if(tm.jtacClass){tm=jTAC.create(null,tm)}if(tm instanceof jTAC.TypeManagers.Base){this.setData("typemanager",tm);return tm}}var dt=this.getData("jtac-datatype");if(dt){tm=jTAC.create(dt,tm)}if(tm instanceof jTAC.TypeManagers.Base){this.setData("typemanager",tm);return tm}else{if(tm){this._error("data-jtac-typemanager or datatype could not convert into a TypeManager object.")}}return null}finally{this._popContext()}},getData:function(a){var c,b=this.getElement(true);if(b){var c=b["data-"+a];if(c===undefined){c=b.getAttribute("data-"+a);if(c!=null){b["data-"+a]=c}}}return c},setData:function(a,c){var b=this.getElement(true);if(b){b["data-"+a]=c}},isVisible:function(){return this._isDOMVisible(this.getElement(true))},_isDOMVisible:function(b){if(!b){return true}var a=1;while(a&&(b!=null)&&(b!=document.body)){a=!((b.style.visibility=="hidden")||(b.style.display=="none"));b=b.parentNode}return a},isEnabled:function(){return this._isDOMEnabled(this.getElement(true))},_isDOMEnabled:function(a){if(!a||a.disabled==null){return true}return !a.disabled},isEditable:function(){return this.isVisible()&&this.isEnabled()},getLabel:function(){var a=this._locateLabel(this.getElement(true));if(a==null){a=this.callParent()}return a},_locateLabel:function(b){if(!b){return null}var g=false;var a=b.getAttribute("data-msglabel");var f=b.getAttribute("data-msglabel-lookupid");if(f){a=jTAC.translations.lookup(f,a);g=true}if(a==null){var d=b.getAttribute("data-msglabel-from");if(d){var c=document.getElementById(d);if(c){a=c.innerHTML;g=true}}}if((a==null)&&window.jQuery){var c=$("label[for='"+b.id+"'][generated!='true']");if(c){a=c.html();g=true}}if(a&&g){a=this._cleanLabel(a);b.setAttribute("data-msglabel",a)}return a},_cleanLabel:function(a){var b=jTAC.replaceAll(a,"<(.|\n)+?>","");b=b.replace(/[^\dA-Za-z]+$/,"");b=b.replace(/^[^\dA-Za-z]+/,"");return b},getClass:function(){var a=this.getElement();if(a&&(a.className!=null)){return a.className}return""},setClass:function(a){var b=this.getElement();if(b&&(b.className!=null)){b.className=a}},addClass:function(b){if(!b){return false}var a=this.getClass();var c=jTAC.delimitedRE(b,"\\s");if(c.test(a)){return false}var d=jTAC.trimStr(a+" "+b);this.setClass(d);return true},removeClass:function(a){if(a){var c=this.getClass();var b=jTAC.delimitedRE(a,"\\s");c=jTAC.trimStr(c.replace(b," "));this.setClass(c)}},_cleanString:function(b){var a=this.getTrim()?jTAC.trimStr(b):b;return this._matchUnassigned(a)?"":a},_matchUnassigned:function(c){var b=this.getUnassigned();if(b){var a=this.getUnassignedCase();if((b==c)||(!a&&(b.toLowerCase()==c.toLowerCase()))){return true}}return false}};jTAC.define("Connections.BaseElement",jTAC._internal.temp._Connections_BaseElement);jTAC._internal.temp._Connections_FormElement={extend:"Connections.BaseElement",constructor:function(a){this.callParent([a])},config:{fixLength:true,buttons:null},getTextValue:function(){var a=this.getElement();if(a){return this._cleanString(this._getValueAttribute(a))}return null},setTextValue:function(b){var a=this.getElement();if(a){if(this._isCheckable(a)){a.checked=!!b}else{a.value=b}}},typeSupported:function(b){var c=this.getElement();if(c){if(c.tagName=="INPUT"){var a=c.valueAsDate!==undefined;var d=c.valueAsNumber!==undefined;switch(c.type){case"radio":return b=="boolean"||b=="index";case"checkbox":if(b=="boolean"){return true}else{if((b=="index")||(b=="indices")){return this.getButtons()!=null}else{return false}}case"date":case"month":return a&&(b=="date");case"datetime":case"datetime-local":return a&&((b=="date")||(b=="datetime")||(b=="time"));case"time":return a&&(b=="time");case"number":return d&&((b=="integer")||(b=="float"));case"range":return d&&(b=="integer")}}else{if(c.tagName=="SELECT"){return(b=="index")||(b=="indices")}}}return false},getTypedValue:function(d){var g=this.getElement();if(g){if(g.tagName=="INPUT"){switch(g.type){case"radio":case"checkbox":if(!d||(d=="boolean")){return g.checked}else{if(d=="index"){var h=this._createButtonsList(g);if(h){for(var f=0;f<h.length;f++){if(h[f].checked){return f}}return -1}}else{if((d=="indices")&&(g.type=="checkbox")){var h=this._createButtonsList(g);var c=new Array();if(h){for(var f=0;f<h.length;f++){if(h[f].checked){c.push(f)}}return c}}}}break;case"date":case"datetime":case"datetime-local":case"month":case"time":if(!d||(d=="date")){if(g.valueAsDate!==undefined){return g.valueAsDate}}break;case"number":case"range":if(!d||(d=="integer")||(d=="float")){if(g.valueAsNumber!==undefined){return !isNaN(g.valueAsNumber)?g.valueAsNumber:null}}break}}else{if(g.tagName=="SELECT"){if(!d||(d=="index")){return g.selectedIndex}else{if(d=="indices"){var b=new Array();for(var f=0;f<g.options.length;f++){if(g.options[f].selected){b.push(f)}}return b}}}}this._error("The HTML element "+this.getId()+" does not support the type "+d,"getTypedValue")}return null},setTypedValue:function(d){var b=this.getElement();if(b){if(b.tagName=="INPUT"){switch(b.type){case"radio":case"checkbox":if(typeof(d)=="boolean"){b.checked=d;return}else{if(typeof(d)=="number"){var c=this._createButtonsList(b);if(c){for(var a=0;a<c.length;a++){c[a].checked=a==d}return}}else{if((d instanceof Array)&&(b.type=="checkbox")){var c=this._createButtonsList(b);if(c){for(var a=0;a<c.length;a++){c[a].checked=d.indexOf(a)>-1}return}}}}break;case"date":case"datetime":case"datetime-local":case"month":case"time":if(d==null){b.value="";return}else{if(d instanceof Date){if(b.valueAsDate!==undefined){b.valueAsDate=d;return}}}break;case"number":case"range":if(d==null){b.value="";return}else{if(typeof(d)=="number"){if(b.valueAsNumber!==undefined){b.valueAsNumber=d;return}}}break}}else{if(b.tagName=="SELECT"){if(typeof(d)=="number"){b.selectedIndex=d;return}else{if(d instanceof Array){for(var a=0;a<b.options.length;a++){b.options[a].selected=d.indexOf(a)!=-1}return}}}}this._error("The HTML element "+this.getId()+" does not support the type of the value","setTypedValue")}},isNullValue:function(a){var b=this.getElement();if(b){if(!a&&this._isCheckable(b)){return false}return this._cleanString(this._getValueAttribute(b))==""}return true},textLength:function(){var f=this.getTextValue();if(!f){return 0}var b=f.length;if(this.getFixLength()){var d=this.getElement(true);if(d&&(d.tagName=="TEXTAREA")){var a;var c=this._internal.findEnterRE;if(!c){this._internal.findEnterRE=c=/([^\r](?=\n))|(\r$)|(^\n)/g}while((a=c.exec(f))!=null){b++}}}return b},_checkElement:function(a){if(a.value===undefined){this._error("HTML Element does not have a value attribute.")}},addEventListener:function(a,b,c){return this._addEvt(this.getElement(),a,b,c)},_addEvt:function(c,b,d,f){if(c){if(f){var a="data-formconnection-"+f;if(c.getAttribute(a)!=null){return true}c.setAttribute(a,true)}if((b=="onchange")&&this._isCheckable(c)){b="onclick"}if(c.addEventListener){c.addEventListener(b.substr(2),d,false);return true}else{if(c.attachEvent){c.attachEvent(b,d);return true}}}return false},addSupportEventListeners:function(a,f,g){var c=this.getElement(true);if(!c){return}var d=this._createButtonsList(c);if(d){for(var b=0;b<d.length;b++){if(c!=d[b]){this._addEvt(d[b],a,f,g)}}}},_createButtonsList:function(f){var c=this.getButtons();if(c){if(typeof(c)=="function"){c=c(f)}if(c instanceof Array){var a=[];for(var d=0;d<c.length;d++){if(typeof(c[d])=="string"){var g=document.getElementById(c[d]);if(g){a.push(g)}else{if(window.console){console.log("'"+c[d]+"' element not found on page. Check spelling and case. Specified in a Connections.FormElement using element id '"+f.id+"'.")}}}else{if(typeof(c[d])=="object"){a.push(c[d])}}}return a.length?a:null}}else{if(f.type=="radio"){c=document.getElementsByName(f.name);return c.length?c:null}}return null},testElement:function(b){if(typeof(b)=="string"){var a=document.getElementById(b);return a&&(a.form!=null)}else{return((typeof(b)=="object")&&(b.tagName!==undefined)&&(b.form!=null))}},_getValueAttribute:function(a){if(this._isCheckable(a)){if(!a.checked){return""}return a.value?a.value:"on"}return a.value},_isCheckable:function(a){return(a.tagName=="INPUT")&&/^(checkbox)|(radio)$/.test(a.type)},isVisible:function(){var d=this.getElement(true);if(!d){return true}var a=this._createButtonsList(d);if(a){for(var c=0;c<a.length;c++){if(this._isDOMVisible(a[c])){return true}}return false}else{return this._isDOMVisible(d)}},isEnabled:function(){var d=this.getElement(true);if(!d){return true}var a=this._createButtonsList(d);if(a){for(var c=0;c<a.length;c++){if(this._isDOMEnabled(a[c])){return true}}return false}else{return this._isDOMEnabled(d)}},_createTypeManager:function(b){var a=this.callParent([b]);if(a){return a}switch(b.type){case"checkbox":case"radio":return jTAC.createByClassName("TypeManagers.Boolean",null,true);break;case"date":return jTAC.createByClassName("TypeManagers.Date",null,true);break;case"datetime":case"datetime-local":return jTAC.createByClassName("TypeManagers.DateTime",null,true);break;case"month":return jTAC.createByClassName("TypeManagers.MonthYear",null,true);case"time":return jTAC.createByClassName("TypeManagers.TimeOfDay",null,true);break;case"number":return jTAC.createByClassName("TypeManagers.Float",null,true);break;case"range":return jTAC.createByClassName("TypeManagers.Integer",null,true);break}return null},setButtons:function(a){if(typeof(a)=="string"){a=window[a]}if((typeof(a)=="function")||(a instanceof Array)){this.config.buttons=a}else{this._error("Illegal value. See function's documentation.")}}};jTAC.define("Connections.FormElement",jTAC._internal.temp._Connections_FormElement);jTAC.defineAlias("FormElement","Connections.FormElement");jTAC.connectionResolver={_regCls:new Array(),_regFns:new Array(),_formElement:jTAC.create("Connections.FormElement"),register:function(a){try{jTAC._internal.pushContext("connectionResolver.register");for(var b=0;b<arguments.length;b++){var c=arguments[b];if(typeof(c)=="function"){this._regFns.push(c);continue}if(typeof c=="string"){c=jTAC.create(c,null,true)}if(c&&c.testElementAndCreate){this._regCls.push(c)}else{jTAC.error("Could not register an item.")}}}finally{jTAC._internal.popContext()}},create:function(g,a){try{jTAC._internal.pushContext("resolveConnection");var f=null;var d=typeof g=="string"?document.getElementById(g):g;if(d&&d.getAttribute){var b=d.getAttribute("data-jtac-connection");if(b){f=jTAC.create(b,null,true);if(f){if(!(f instanceof jTAC.Connections.Base)){jTAC.error("Unknown name in data-jtac-connection attribute of ["+d.id+"].",null,null,true);f=null}}}}if(!f){for(var c=0;c<this._regFns.length;c++){f=_regFns[c](g);if(f){break}}}if(!f){for(var c=0;c<this._regCls.length;c++){f=this._regCls[c].testElementAndCreate(g);if(f){break}}}if(a){if(f){f.allowNone=a.allowNone}else{if(a.testElement(g)){f=a}}}if(!f&&this._formElement.testElement(g)){f=jTAC.create("Connections.FormElement")}if(f){(typeof(g)=="string")?f.setId(g):f.setElement(g)}return f}finally{jTAC._internal.popContext()}}};if(!window.jTAC){throw new Error("window.jTAC not created.")}jTAC._internal.temp._TypeManagers_base={"abstract":true,constructor:function(a){},config:{friendlyName:null,friendlyLookupKey:null},configrule:{friendlyName:jTAC.checkAsStrOrNull,friendlyLookupKey:jTAC.checkAsStrOrNull},nativeTypeName:function(){this._AM()},dataTypeName:function(){this._AM()},storageTypeName:function(){this._AM()},toString:function(a){if(a===undefined){return this.$className}try{this._pushContext();if(typeof a=="string"){a=this.toValue(a)}a=this._reviewValue(a);return this._nativeToString(a)}finally{this._popContext()}},_nativeToString:function(a){this._AM()},toValue:function(b){try{this._pushContext("TypeManagers.Base ["+b+"]");if(typeof(b)==this.nativeTypeName()){return this._reviewValue(b)}if(typeof(b)!="string"){this._error("Must pass a string in the text parameter.")}if(this._isNull(b)){return null}var a=this._stringToNative(b);return this._reviewValue(a)}finally{this._popContext()}},toValueFromConnection:function(a){try{this._pushContext();if(!(a instanceof jTAC.Connections.Base)){this._error("Must pass a Connection class.")}if(a.typeSupported(this.storageTypeName())){return this._reviewValue(a.getTypedValue(this.storageTypeName()))}return this.toValue(a.getTextValue())}finally{this._popContext()}},_stringToNative:function(a){this._AM()},_isNull:function(a){return a==""||a==null},_reviewValue:function(a){if(typeof(a)!=this.nativeTypeName()){this._error("Type not supported")}return a},toValueNeutral:function(a){this._AM()},toStringNeutral:function(a){this._AM()},isValid:function(c,a){if(a==undefined){a=false}if(c==null){return a}if((typeof(c)=="string")&&(jTAC.trimStr(c)=="")){return a}try{return this.toValue(c)!=null}catch(b){return false}},compare:function(b,a){if(typeof(b)=="string"){b=this.toValue(b)}if(typeof(a)=="string"){a=this.toValue(a)}if((b==null)||(a==null)){this._error("Parameter value was null.")}if(b<a){return -1}else{if(b>a){return 1}}return 0},isValidChar:function(a){if((a==null)||(typeof(a)!="string")||(a.length!=1)){this._error("Parameter must be a single character.")}return true},toNumber:function(a){return null},getFriendlyName:function(){var a=this.config.friendlyName;var b=this.getFriendlyLookupKey();if(b){a=jTAC.translations.lookup(b,a)}if(a==null){a=this.dataTypeName()}return a},getFriendlyLookupKey:function(){if(this.config.friendlyLookupKey==null){return this.dataTypeName()}return this.config.friendlyLookupKey},round:function(h,j,c){if(c==-1){return h}if(jTAC.TypeManagers.Base.prototype.numDecPlaces(h)<=c){return h}var d=Math.pow(10,c);var a=h*d;switch(j){case 0:a=Math.abs(a);a=a.toFixed(1);a=parseFloat(a).toFixed(0);a=parseFloat(a);if(h<0){a=-a}return a/d;case 1:var b=Math.floor(a);var g=a-b;var b=(g==0.5)?((b%2==0)?b:b+1):Math.round(a);return b/d;case 2:a=Math.floor(Math.abs(a));if(h<0){a=-a}return a/d;case 3:a=Math.ceil(a);return a/d;case 4:a=Math.ceil(Math.abs(a));if(h<0){a=-a}return a/d;default:this._inputError("Too many decimal places.")}return 0},numDecPlaces:function(b){var c=jTAC.TypeManagers.Base.prototype.floatToString(b);var a=c.indexOf(".");if(a<0){return 0}return c.length-(a+1)},floatToString:function(c){var b=c.toString();if((b.indexOf("e-")>-1)&&c.toFixed){var a=b.match(/^.e\-(\d*)$/);var d=parseInt(a[1]);b=c.toFixed(d)}return b},asUTCDate:function(l,a,k,f,j,c){if((typeof l=="object")&&(l instanceof Date)){var b=l;l=b.getFullYear();a=b.getMonth();k=b.getDate();f=b.getHours();j=b.getMinutes();c=b.getSeconds()}if((l==null)||(a==null)||(k==null)){return null}if(f==null){f=0}if(j==null){j=0}if(c==null){c=0}var g=new Date(0);g.setUTCFullYear(l,a,k);g.setUTCHours(f,j,c,0);return g}};jTAC.define("TypeManagers.Base",jTAC._internal.temp._TypeManagers_base);jTAC.checkAsTypeManager=function(b,a){return jTAC.checkAsClass(b,a,jTAC.TypeManagers.Base)};jTAC.checkAsTypeManagerOrNull=function(a){return jTAC.checkAsTypeManager(a,null)};jTAC.addDataTypeAttributes=function(a,c,b){var d=jTAC.connectionResolver.create(a);d.setData("jtac-datatype",c);d.setData("jtac-typemanager",b)};jTAC.plugInParser=function(b,f){var c={config:{parserOptions:null,nativeParser:false},_parse:function(g){return this.getNativeParser()?this._nativeParse(g):this.getParserOptions().parse(g)},_valChars:function(){var g=this._nativeValChars();if(!this.getNativeParser()){var h=this.getParserOptions();if(h){g=h.valChars(g)}}return g},getParserOptions:function(){var g=this.config.parserOptions;if(!this.config.parserOptions){g=this.config.parserOptions=jTAC.create(b);g.owner=this;this._registerChild(g)}return g},setParserOptions:function(h){if((h==null)||(typeof h!="object")){this._error("Must pass an object whose properties match those on the parserOptions property.")}if(h.instanceOf&&h.instanceOf(b)){h.owner=this;this.config.parserOptions=h}else{var j=this.getParserOptions();for(var g in j.config){if(h[g]!==undefined){j.config[g]=h[g]}}}}};var a=jTAC.getClass(f);var d=a.prototype;if(d._parse===undefined){jTAC.error("Cannot use jTAC.plugInParser() with ["+f+"].")}d._nativeParse=d._parse;d._nativeValChars=d._valChars;jTAC.addMembers(f,c)};jTAC._internal.temp._TypeManagers_BaseCulture={extend:"TypeManagers.Base","abstract":true,constructor:function(a){this.callParent([a])},config:{cultureName:""},configrule:{cultureName:{valFnc:jTAC.checkAsStrOrNull,clearCache:true}},numberFormat:function(a){return jTAC.cultureInfo["num"+a]},currencyFormat:function(a){return jTAC.cultureInfo["cur"+a]},percentFormat:function(a){return jTAC.cultureInfo["pct"+a]},dateTimeFormat:function(a){return jTAC.cultureInfo["dt"+a]},isValidChar:function(c){if(!this.callParent([c])){return false}var a=this._cache;if(a.noREvalchar){return true}var b=a.valcharRE;if(!b){b=a.valcharRE=this._valCharRE();if(!b){a.noREvalchar=true;return true}}return b.test(c)},_valCharRE:function(){return null},setCultureName:function(a){this._defaultSetter("cultureName",a);this._clearCache()}};jTAC.define("TypeManagers.BaseCulture",jTAC._internal.temp._TypeManagers_BaseCulture);jTAC_Temp={config:{numNegPattern:"-n",numDecimals:2,numGroupSep:",",numDecimalSep:".",numGroupSizes:[3],numNegSymbol:"-",curNegPattern:"($n)",curPosPattern:"$n",curSymbol:"$",curDecimals:2,curGroupSep:",",curDecimalSep:".",curGroupSizes:[3],curNegSymbol:"-",pctNegPattern:"-n%",pctPosPattern:"n%",pctSymbol:"%",pctDecimals:2,pctGroupSep:",",pctDecimalSep:".",pctGroupSizes:[3],pctNegSymbol:"-",dtShortDateSep:"/",dtTimeSep:":",dtFirstDay:0,dtDays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dtDaysAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dtDaysShort:["Su","Mo","Tu","We","Th","Fr","Sa"],dtMonths:["January","February","March","April","May","June","July","August","September","October","November","December",""],dtMonthsAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],dtAM:"AM",dtPM:"PM",dtTwoDigitYearMax:2029,dtShortDatePattern:"M/d/yyyy",dtShortDatePatternMN:"MMM/d/yyyy",dtAbbrDatePattern:"MMM dd, yyyy",dtLongDatePattern:"MMMM dd, yyyy",dtShortTimePattern:"h:mm tt",dtLongTimePattern:"h:mm:ss tt",dtShortDurationPattern:"H:mm",dtLongDurationPattern:"H:mm:ss",dtShortDateShortTimePattern:"M/d/yyyy h:mm tt",dtShortDateLongTimePattern:"M/d/yyyy h:mm:ss tt",dtAbbrDateShortTimePattern:"MMM dd, yyyy h:mm tt",dtAbbrDateLongTimePattern:"MMM dd, yyyy h:mm:ss tt",dtLongDateShortTimePattern:"MMMM dd, yyyy h:mm tt",dtLongDateLongTimePattern:"MMMM dd, yyyy h:mm:ss tt",dtShortMonthDayPattern:"M/dd",dtShortMonthDayPatternMN:"MMM/dd",dtAbbrMonthDayPattern:"MMM dd",dtLongMonthDayPattern:"MMMM dd",dtShortMonthYearPattern:"M/yyyy",dtShortMonthYearPatternMN:"MMM/yyyy",dtAbbrMonthYearPattern:"MMM yyyy",dtLongMonthYearPattern:"MMMM yyyy"},configrules:{dtAM:jTAC.checkAsStrOrNull,dtPM:jTAC.checkAsStrOrNull}};jTAC.define("TypeManagers.CultureInfo",jTAC_Temp);jTAC.cultureInfo=jTAC.create("TypeManagers.CultureInfo");if(!window.jTAC){throw new Error("window.jTAC not created.")}jTAC._internal.temp._Connections_UserFunction={extend:"Connections.Base",constructor:function(a){this.callParent([a])},config:{fnc:null,connections:[],required:[],datatype:"",typeManager:null,typeName:""},configrules:{fnc:jTAC.checkAsFunctionOrNull,typeManager:jTAC.checkAsTypeManagerOrNull},userFunction:function(b,a){this._AM()},getTextValue:function(){this._prepare();if(!this.config.typeManager){var a=this._getConnValues();if(!a){return""}return this.config.fnc.call(this,this,a)}var b=this.getTypedValue(this.config.typeName);return b!=null?b.toString():""},typeSupported:function(a){this._prepare();return a==this.config.typeName},getTypedValue:function(a){this._prepare();if(!this.config.typeManager){this._error("Not supported.")}var b=this._getConnValues();if(b==null){return null}return this.config.fnc.call(this,this,b)},isNullValue:function(a){this._prepare();var b=this._getConnValues();if(b==null){return true}return this.config.fnc.call(this,this,b)==null},isEditable:function(){return false},getTypeManager:function(){this._prepare();return this.config.typeManager},_prepare:function(){var b=this.config;if(!this.config.fnc){this.config.fnc=this.userFunction}var a=b.connections;for(var c=0;c<a.length;c++){var d=a[c];if(!(d instanceof jTAC.Connections.Base)){if(typeof d=="string"){a[c]=jTAC.connectionResolver.create(d,null)}else{a[c]=jTAC.checkAsConnection(d)}}}if(!b.typeManager&&b.datatype){b.typeManager=jTAC.create(b.datatype)}b.typeName=b.typeManager?b.typeManager.storageTypeName():"string"},_getConnValues:function(){var d=this.config;var c=d.connections;var b=d.typeManager;var a=[];for(var f=0;f<c.length;f++){var g=c[f];var h=b?null:"";if(g.isValidValue(d.typeName)){if(g.isNullValue()){if(d.required[f]==true){return null}}h=b?b.toValueFromConnection(g):g.getTextValue()}a.push(h)}return a}};jTAC.define("Connections.UserFunction",jTAC._internal.temp._Connections_UserFunction);jTAC._internal.temp._TypeManagers_BaseNumber={extend:"TypeManagers.BaseCulture","abstract":true,constructor:function(a){this.callParent([a])},config:{allowNegatives:true,showGroupSep:true,allowGroupSep:true,strictSymbols:false},nativeTypeName:function(){return"number"},_reviewValue:function(a){if(a===null){return a}a=this.callParent([a]);if(isNaN(a)){this._error("Cannot pass NaN.")}this._checkAllowNegatives(a);return a},toNumber:function(a){return a},getMaxDecimalPlaces:function(){return 0},toStringNeutral:function(d){if(d==null){return""}var b=d.toString();if((b.indexOf("e")>-1)&&d.toFixed){var a=b.match(/^.+e[\-\+](\d*)$/);var c=parseInt(a[1],10);if(isNaN(c)){return""}b=d.toFixed(c)}return b},_nf:function(a){return this.numberFormat(a)},_checkNegSymbol:function(a){if((a.indexOf("(")>-1)&&!this._negPatHasParen()){this._error("Illegal negative symbol")}},_negPatHasParen:function(){var a=this._cache.nPAP;if(a==null){a=this._cache.nPAP=this._nf("NegPattern").indexOf("(")>-1}return a},_checkStrictSymbols:function(h){var g=this._nf("NegSymbol");var j=(h.indexOf(g)>-1)||h.indexOf("(")>-1;var d=this._nf(j?"NegPattern":"PosPattern")||"";if(!d){return}h=h.replace(g,"-");var c=this._nf("Symbol")||"";var b=d.indexOf("$")>-1?"$":(d.indexOf("%")>-1?"%":"");var a=h.indexOf(c)>-1;if(a){h=h.replace(c,b);d=jTAC.escapeRE(d);d=d.replace("\\ ","\\s?")}else{d=jTAC.replaceAll(d," ","");d=d.replace(b,"");d=jTAC.escapeRE(d)}d=d.replace("n","\\d+(\\.\\d*)?");d="^"+d+"$";var f=new RegExp(d);if(!f.test(h)){this._inputError("Symbols are not correctly positions.")}},_applyGroupSep:function(l){var c=this._nf("GroupSep");if(c==null){return l}var a="";var m=this._nf("DecimalSep");var j=l.indexOf(m);var g=l.length;if(j>-1){a=l.substring(j,g);g=j}var d=this._nf("GroupSizes");if(d==null){d=[3]}var b=0;var h=d[0];var k=0;for(var f=g-1;f>=0;f--){a=l.charAt(f)+a;if(f==0){break}k++;if(k==h){a=c+a;if(b<d.length-1){b++}if(d[b]==0){h=999}else{h=h+d[b]}}}return a},_checkAllowNegatives:function(a){if(!this.getAllowNegatives()&&(typeof a=="number")&&(a<0)){this._inputError("Negative values not allowed")}},_stripGroupSep:function(a){return jTAC.replaceAll(a,this._nf("GroupSep"),"",true)},_cleanTrailingZeros:function(f,g){if(g){var b=new RegExp(jTAC.escapeRE(this._nf("DecimalSep"))+"\\d*");var a=b.exec(f);if(a){var c=a[0];while(g<(c.length-1)){if(c.charAt(c.length-1)!="0"){break}c=c.substr(0,c.length-1)}var d=g-(c.length-1);if(d>0){c+="000000000000".substr(0,d)}f=f.replace(a[0],c)}}return f}};jTAC.define("TypeManagers.BaseNumber",jTAC._internal.temp._TypeManagers_BaseNumber);jTAC._internal.temp._TypeManagers_BaseFloat={extend:"TypeManagers.BaseNumber","abstract":true,constructor:function(a){this.callParent([a])},config:{maxDecimalPlaces:null,trailingZeroDecimalPlaces:1,roundMode:null,acceptPeriodAsDecSep:false},configrules:{maxDecimalPlaces:jTAC.checkAsIntOrNull,trailingZeroDecimalPlaces:jTAC.checkAsInt,roundMode:jTAC.checkAsIntOrNull},_nativeToString:function(d){if(d==null){return""}var b=this.floatToString(Math.abs(d));b=this._applyTrailingZeros(b);var c=this._nf("DecimalSep");if(c!="."){b=b.replace(".",c)}if(this.getShowGroupSep()){b=this._applyGroupSep(b)}var f=(d<0)?"NegPattern":"PosPattern";var a=this._nf(f);if(a){b=a.replace("n",b)}return b},_applyTrailingZeros:function(c){var d=this.getTrailingZeroDecimalPlaces();if((d==null)&&(c.indexOf(".")==-1)){c+=".0"}if(d>0){var b=c.indexOf(".");var a=d;if(b==-1){c+="."}else{a=d-(c.length-b-1)}if(a>0){c+=String("000000000000000000").substr(0,a)}}return c},_reviewValue:function(a){a=this.callParent([a]);if(a!=null){a=this._applyMaxDec(a)}return a},_stringToNative:function(b){this._checkNegSymbol(b);if(!this.getAllowGroupSep()){var a=this.numberFormat("GroupSep");if(a&&(b.indexOf(a)>-1)){this._inputError("Group separator not allowed.")}}var c=this._parse(b);if(isNaN(c)){this._inputError("Cannot convert ["+b+"] to "+this.dataTypeName()+".")}return c},_parse:function(g){var b=this._nf("Symbol");if(b){g=g.replace(b,"!!")}g=this._replaceDecSep(g);g=this._stripGroupSep(g);var j=this._nf("DecimalSep");if(j!="."){if(g.indexOf(".")>-1){this._inputError("Period character not supported in this culture.")}g=g.replace(j,".")}if(this.getStrictSymbols()){var h=b?g.replace("!!",b):g;this._checkStrictSymbols(h)}if(g.indexOf("!!")>-1){g=jTAC.trimStr(g.replace("!!",""))}var f=this._nf("NegSymbol");var d=(g.indexOf(f)>-1)||((g.indexOf("(")>-1)&&this._negPatHasParen());g=jTAC.trimStr(g);var k=this._cache.floatCharsRE;if(!k){var a=jTAC.escapeRE(f);this._cache.floatCharsRE=k=new RegExp("^(["+a+"\\(])?\\d+(\\.(\\d*))?(["+a+"\\)])?$")}if(!k.test(g)){this._inputError("Invalid characters found")}if(d){g=jTAC.trimStr(g.replace(f,"").replace("(","").replace(")",""))}var c=parseFloat(g);if(isNaN(c)){return c}if(d){c=-c}return c},_applyMaxDec:function(b){var a=this.getMaxDecimalPlaces();if(a){return this.round(b,this.getRoundMode(),a)}return b},toValueNeutral:function(a){if(a==null){return null}try{this._pushContext(null,a);if(typeof(a)=="number"){return this._reviewValue(a)}if(/^\-?\d+(\.\d+)?$/.test(a)){return parseFloat(a)}this._inputError("Required format: [-]digits[.digits]")}finally{this._popContext()}},toStringNeutral:function(b){if(b==null){return""}var a=this.callParent([b]);if(a.indexOf(".")==-1){a=a+".0"}return a},_valCharRE:function(){var a=this._nf("NegPattern")||"";var b="";if(this.getAllowNegatives()){b="-";if(a.indexOf("(")>-1){b+="()"}}var d=a.indexOf(" ")>-1?" ":"";var c=this.getMaxDecimalPlaces()!=0?this._nf("DecimalSep"):"";return new RegExp("[\\d"+jTAC.escapeRE(this._nf("GroupSep")+c+b+this._moreValidChars())+d+"]")},_moreValidChars:function(){return""},getMaxDecimalPlaces:function(){return this.config.maxDecimalPlaces},_replaceDecSep:function(g){if(!this.getAcceptPeriodAsDecSep()){return g}var d=this._nf("DecimalSep");if((d!=".")&&(g.indexOf(".")>-1)){if(g.indexOf(d)==-1){var a=false;var f=this._nf("GroupSep");if(f!="."){a=true}else{var c=g.indexOf(f);var b=g.lastIndexOf(f);if((c==-1)||(c==b)){a=true}}if(a){g=g.replace(".",d)}}}return g}};jTAC.define("TypeManagers.BaseFloat",jTAC._internal.temp._TypeManagers_BaseFloat);jTAC._internal.temp._TypeManagers_Integer={extend:"TypeManagers.BaseNumber",constructor:function(a){this.callParent([a])},config:{fillLeadZeros:0},configrules:{fillLeadZeros:jTAC.checkAsIntOrNull},dataTypeName:function(){return"integer"},storageTypeName:function(){return"integer"},_stringToNative:function(b){if(b==null){this._error("Cannot evaluate null value")}if(b.indexOf(this.numberFormat("DecimalSep"))>-1){this._error("Cannot evaluate a floating point number.")}var a=this.numberFormat("GroupSep");if(!this.getAllowGroupSep()&&a&&(b.indexOf(a)>-1)){this._inputError("Group separator not allowed.")}var c=this._parse(b);if(isNaN(c)){this._inputError("Cannot convert ["+b+"] to "+this.dataTypeName()+".")}return c},_parse:function(d){d=this._stripGroupSep(d);if(this.getStrictSymbols()){this._checkStrictSymbols(d)}var c=this._nf("NegSymbol");var g=d.indexOf(c)>-1;var b=this._cache.intCharsRE;if(!b){var a=jTAC.escapeRE(c);this._cache.intCharsRE=b=new RegExp("^("+a+")?\\d+("+a+")?$")}if(!b.test(d)){this._inputError("Illegal character found.")}if(g){d=d.replace(c,"")}var f=parseInt(d,10);if(!isNaN(f)&&(f!=null)&&((f>2147483647)||(f<-2147483648))){this._inputError("Exceeds 32 bit integer.")}if(g){f=-f}return f},_nativeToString:function(c){if(c==null){return""}var b=Math.abs(c).toString();if(this.getShowGroupSep()){b=this._applyGroupSep(b)}var a=this.getFillLeadZeros();if(a&&(b.length<a)){e="0000000000";b=e.substr(0,a-b.length)+b}if(c<0){b=this.numberFormat("NegPattern").replace("n",b)}return b},_reviewValue:function(a){if(Math.floor(a)!=a){this._inputError("Has decimal point.")}return this.callParent([a])},toValueNeutral:function(a){if(a==null){return null}try{this._pushContext();if(typeof(a)=="number"){return this._reviewValue(a)}if(/^\-?\d+$/.test(a)){return parseInt(a)}this._inputError("Required format: [-]digits")}finally{this._popContext()}},_valCharRE:function(){var b=this.getAllowGroupSep()?this.numberFormat("GroupSep"):"";var a=this.getAllowNegatives()?this.numberFormat("NegSymbol"):"";return new RegExp("[\\d"+jTAC.escapeRE(b+a)+"]")}};jTAC.define("TypeManagers.Integer",jTAC._internal.temp._TypeManagers_Integer);jTAC.defineAlias("Integer","TypeManagers.Integer");jTAC.defineAlias("Integer.Positive","TypeManagers.Integer",{allowNegatives:false});jTAC._internal.temp._TypeManagers_Float={extend:"TypeManagers.BaseFloat",constructor:function(a){this.callParent([a])},dataTypeName:function(){return"float"},storageTypeName:function(){return"float"}};jTAC.define("TypeManagers.Float",jTAC._internal.temp._TypeManagers_Float);jTAC.defineAlias("Float","TypeManagers.Float");jTAC.defineAlias("Float.Positive","TypeManagers.Float",{allowNegatives:false});jTAC._internal.temp._TypeManagers_Currency={extend:"TypeManagers.BaseFloat",constructor:function(a){this.callParent([a])},config:{trailingZeroDecimalPlaces:null,showCurrencySymbol:true,allowCurrencySymbol:true,useDecimalDigits:true,hideDecimalWhenZero:false},dataTypeName:function(){return"currency"},storageTypeName:function(){return"float"},_nativeToString:function(d){var c=this.callParent([d]);if(!this.getShowCurrencySymbol()){var b=/\s?\$\s?/;c=c.replace(b,"")}else{var a=this._nf("Symbol");c=c.replace("$",a)}if(this.getHideDecimalWhenZero()){var b=this._cache.checkDecRE;if(!b){this._cache.checkDecRE=b=new RegExp(jTAC.escapeRE(this._nf("DecimalSep"))+"0+(?![1-9])")}c=c.replace(b,"")}return c},_stringToNative:function(a){if(!this.getAllowCurrencySymbol()&&(a.indexOf(this._nf("Symbol"))>-1)){this._inputError("Currency symbol found but not allowed.")}return this.callParent([a])},_applyMaxDec:function(a){if(this.getUseDecimalDigits()){return this.callParent([a])}return a},_moreValidChars:function(){return this.getAllowCurrencySymbol()?this._nf("Symbol"):""},getMaxDecimalPlaces:function(){if(this.config.maxDecimalPlaces!=null){return this.config.maxDecimalPlaces}return this._nf("Decimals")},getTrailingZeroDecimalPlaces:function(){if(this.config.trailingZeroDecimalPlaces!=null){return this.config.trailingZeroDecimalPlaces}return this._nf("Decimals")},_nf:function(b){var a=this.currencyFormat(b);if(a===undefined){a=this.numberFormat(b)}return a}};jTAC.define("TypeManagers.Currency",jTAC._internal.temp._TypeManagers_Currency);jTAC.defineAlias("Currency","TypeManagers.Currency");jTAC.defineAlias("Currency.Positive","TypeManagers.Currency",{allowNegatives:false});jTAC._internal.temp._TypeManagers_Percent={extend:"TypeManagers.BaseFloat",constructor:function(a){this.callParent([a])},config:{trailingZeroDecimalPlaces:null,showPercentSymbol:true,allowPercentSymbol:true,oneEqualsOneHundred:true},dataTypeName:function(){return"percent"},storageTypeName:function(){return"float"},_stringToNative:function(a){if(!this.getAllowPercentSymbol()&&(a.indexOf(this._nf("Symbol"))>-1)){this._inputError("Percent symbol found but not allowed.")}var c=this.callParent([a]);if((c!=null)&&this.getOneEqualsOneHundred()&&(this.getMaxDecimalPlaces()!=0)){var b=this.numDecPlaces(c);c=c/100;b=b+2;c=this.round(c,2,b)}return c},_nativeToString:function(d){var c=this.getMaxDecimalPlaces();if(this.getOneEqualsOneHundred()&&(c!=0)){var f=this.numDecPlaces(d);d=100*d;f=f-2;if(f<0){f=0}d=this.round(d,2,f)}var b=this.callParent([d]);if(!this.getShowPercentSymbol()){var a=this._cache.stripSymbolRE;if(!a){a=this._cache.stripSymbolRE=new RegExp("\\s?%\\s?")}b=b.replace(a,"")}else{b=b.replace("%",this._nf("Symbol"))}return b},_moreValidChars:function(a){return this.getAllowPercentSymbol()?this._nf("Symbol"):""},getTrailingZeroDecimalPlaces:function(){if(this.getMaxDecimalPlaces()==0){return 0}if(this.config.trailingZeroDecimalPlaces!=null){return this.config.trailingZeroDecimalPlaces}return this._nf("Decimals")},_nf:function(b){var a=this.percentFormat(b);if(a===undefined){a=this.numberFormat(b)}return a}};jTAC.define("TypeManagers.Percent",jTAC._internal.temp._TypeManagers_Percent);jTAC.defineAlias("Percent","TypeManagers.Percent");jTAC.defineAlias("Percent.Positive","TypeManagers.Percent",{allowNegatives:false});jTAC.defineAlias("Percent.Integer","TypeManagers.Percent",{maxDecimalPlaces:0});jTAC.defineAlias("Percent.Integer.Positive","TypeManagers.Percent",{maxDecimalPlaces:0,allowNegatives:false});if(!window.jTAC){throw new Error("window.jTAC not created.")}jTAC._internal.temp._TypeManagers_BaseDatesAndTimes={extend:"TypeManagers.BaseCulture","abstract":true,config:{useUTC:false},nativeTypeName:function(){return"object"},supportsDates:function(){this.AM()},supportsTimes:function(){this.AM()},_stringToNative:function(b){var a=this._parse(b);if(a==null){this._inputError("Cannot convert ["+b+"] to "+this.dataTypeName()+".")}return this._fromNeutralToDate(a)},_parse:function(a){this.AM()},_nativeToString:function(b){if(b==null){return""}var a=this._fromDateToNeutral(b);return this._format(a)},_format:function(a){this.AM()},compare:function(b,a){if(typeof b=="string"){b=this.toValue(b)}b=this.toNumber(b);if(typeof a=="string"){a=this.toValue(a)}a=this.toNumber(a);return this.callParent([b,a])},isValidChar:function(b){if(!this.callParent([b])){return false}var a=this._cache.validChars;if(a==null){a=this._cache.validChars=this._valChars()}return a.indexOf(b)>-1},_valChars:function(){this.AM()},toValueNeutral:function(a){if(a==null){return null}try{this._pushContext();if(a instanceof Date){return this._reviewValue(a)}return this._getNeutralFormatTM().toValue(a)}finally{this._popContext()}},toStringNeutral:function(a){if(a==null){return""}return this._getNeutralFormatTM().toString(a)},_getNeutralFormatTM:function(){var a=this._internal.neutralTM;if(!a){a=this._internal.neutralTM=jTAC.create(this.$fullClassName);a._setNeutralFormat(this)}return a},_setNeutralFormat:function(a){this.setUseUTC(a.getUseUTC())},toNumber:function(a){if(a==null){return 0}if(a instanceof Date){return this._dateToNumber(a)}else{if(typeof a=="number"){return a}}return null},_dateToNumber:function(a){return Math.floor(a.valueOf()/1000)},_fromNeutralToDate:function(b){var a=new Date();if(b.y===undefined){b.y=a.getFullYear();b.M=a.getMonth();b.d=a.getDate()}if(b.h===undefined){b.h=b.m=b.s=0}if(this.getUseUTC()){a.setUTCFullYear(b.y,b.M-1,b.d);a.setUTCHours(b.h,b.m,b.s,0)}else{a.setFullYear(b.y,b.M-1,b.d);a.setHours(b.h,b.m,b.s,0)}return a},_fromDateToNeutral:function(a,d){var c={};var b=this.getUseUTC();if(d!=2){c.y=b?a.getUTCFullYear():a.getFullYear();c.M=b?a.getUTCMonth()+1:a.getMonth()+1;c.d=b?a.getUTCDate():a.getDate()}if(d!=1){c.h=b?a.getUTCHours():a.getHours();c.m=b?a.getUTCMinutes():a.getMinutes();c.s=b?a.getUTCSeconds():a.getSeconds()}return c},_patternOrder:function(d,b){var g=this._cache.order;if(!g){var a=d?this._datePattern():this._timePattern();g=[];var h=false;for(var c=0;c<a.length;c++){var f=a.charAt(c);if((b.indexOf(f)>-1)&&(g.indexOf(f)==-1)&&!h){g.push(f)}else{if(f=="'"){h=!h}}}this._cache.order=g}return g},_replacePart:function(f,h,g){var d=h.toString();var c=new RegExp("("+f+"+)");var a=c.exec(g);if(!a){return g}var b=a[0].length-d.length;if(b>0){d="000000".substr(0,b)+d}return g.replace(a[0],d)},_extractLiterals:function(c){var d=/(['"]([^'"]+)['"])/;var a,f,b=null;while(a=d.exec(c)){if((a[2].charAt(0)!="'")&&(a[2].charAt(0)!='"')){if(!b){b=[]}f=b.length;b.push(a[2]);c=c.replace(a[1],"{"+f+"}")}}return{pat:c,lit:b}},_restoreLiterals:function(c,a){if(a){for(var b=0;b<a.length;b++){c=c.replace("{"+b+"}",a[b])}}return c},_isNullYear:function(c){if(c instanceof Date){return c.getUTCFullYear()==1}var a=this._internal;var b=a.nullPat;if(b==null){b=a.nullPat=this._format({y:1,M:1,d:1,h:0,m:0,s:0})}return c===b}};jTAC.define("TypeManagers.BaseDatesAndTimes",jTAC._internal.temp._TypeManagers_BaseDatesAndTimes);jTAC._internal.temp._TypeManagers_BaseDate={extend:"TypeManagers.BaseDatesAndTimes","abstract":true,config:{dateFormat:0,twoDigitYear:true},configrules:{dateFormat:{values:[0,1,2,10,20,100],clearCache:true}},storageTypeName:function(){return"date"},supportsDates:function(){return true},supportsTimes:function(){return false},_parse:function(a){return this._parseDate(a)},_format:function(a){return this._formatDate(a)},_valChars:function(){var h="",j=new Array(),a="1234567890",n=this.dateTimeFormat("ShortDateSep"),g="(d{3,4})|(M{3,4})|('[^']+')|(\\s)|(\\,)|(/)",o=new RegExp(g,"g"),f,d,c,k=this._datePattern();if(k){h+=k;a+=n}while((f=o.exec(h))!=null){d=f[0];if(j.indexOf(d)==-1){c=null;var b=null;switch(d){case"ddd":b="DaysAbbr";break;case"dddd":b="Days";break;case"MMM":b="MonthsAbbr";break;case"MMMM":b="Months";break;case"/":break;default:a+=((d.indexOf("'")==0)?d.replace("'",""):d);break}if(b){c=this.dateTimeFormat(b)}if(c){var l=c.join("");a+=l.toLowerCase()+l.toUpperCase()}j.push(d)}}return a},_setNeutralFormat:function(a){this.callParent([a]);this.setDateFormat(100);this.setTwoDigitYear(false)},_dateToNumber:function(a){return Math.floor(a.valueOf()/86400000)},_skipDatePart:function(){return""},_timePattern:function(){return""},setDateFormat:function(a){this._defaultSetter("dateFormat",a);this._clearCache()},_parseDate:function(j){var f=this._createDatePatternRE();var h=f.exec(j);if(!h){return null}var g={y:1900,m:0,d:1},b,a=this._patternOrder(true,"Mdy");for(i=0;i<a.length;i++){g[a[i]]=b=parseInt(h[i+1],10);if(!isNaN(b)){switch(a[i]){case"d":if((b>31)||(b==0)){b=NaN}break;case"M":if((b>12)||(b==0)){b=NaN}break;case"y":if(b<100){if(this.getTwoDigitYear()){g.y+=(2000+b)<this.dateTimeFormat("TwoDigitYearMax")?2000:1900}else{this._inputError("Requires 4 digit year")}}else{if(b>9999){b=NaN}}break}}if(isNaN(b)){this._inputError("Invalid date part: "+a[i])}}var b=new Date(g.y,g.M-1,g.d,0,0,0,0),c=b.getFullYear(),d=b.getMonth();if((c!=g.y)||(d!=(g.M-1))){this._inputError("Day exceeds month range")}return g},_createDatePatternRE:function(){var b=this._cache.shortDateRE;if(!b){var a=this._datePattern();a=jTAC.replaceAll(a,"'","");a=a.replace(/d?d/,"(\\d{1,2})");a=a.replace(/M?M/,"(\\d{1,2})");a=a.replace(/y{2,4}/,this.getTwoDigitYear()?"(\\d{2,4})":"(\\d{4})");a=jTAC.replaceAll(a,"/",this.dateTimeFormat("ShortDateSep"),true);a="^"+a+"$";this._cache.shortDateRE=b=new RegExp(a)}return b},_formatDate:function(f,c){var d=c||this._datePattern();var a=this._extractLiterals(d);d=a.pat;d=jTAC.replaceAll(d,"/",this.dateTimeFormat("ShortDateSep"),true);d=this._replacePart("d",f.d,d);d=this._replacePart("yyyy",f.y,d);d=this._replacePart("yy",f.y,d);if(d.indexOf("MMMM")>-1){var b=this.dateTimeFormat("Months")[f.M-1];d=d.replace("MMMM",b)}else{if(d.indexOf("MMM")>-1){var b=this.dateTimeFormat("MonthsAbbr")[f.M-1];if(this.getDateFormat()==2){b=b.toUpperCase()}d=d.replace("MMM",b)}else{d=this._replacePart("M",f.M,d)}}return this._restoreLiterals(d,a.lit)},_datePattern:function(){var a;switch(this.getDateFormat()){case 0:a="ShortDatePattern";break;case 1:case 2:a="ShortDatePatternMN";break;case 10:a="AbbrDatePattern";break;case 20:a="LongDatePattern";break;case 100:return"yyyy'-'MM'-'dd";default:return""}return this.dateTimeFormat(a)}};jTAC.define("TypeManagers.BaseDate",jTAC._internal.temp._TypeManagers_BaseDate);jTAC._internal.temp._TypeManagers_Date={extend:"TypeManagers.BaseDate",constructor:function(a){this.callParent([a])},dataTypeName:function(){return"date"},_isNull:function(b){var a=this.callParent([b]);if(a){return true}return this._isNullYear(b)}};jTAC.define("TypeManagers.Date",jTAC._internal.temp._TypeManagers_Date);jTAC.defineAlias("Date","TypeManagers.Date");jTAC.defineAlias("Date.Short","TypeManagers.Date");jTAC.defineAlias("Date.Abbrev","TypeManagers.Date",{dateFormat:10});jTAC.defineAlias("Date.Long","TypeManagers.Date",{dateFormat:20});jTAC._internal.temp._TypeManagers_BaseTime={extend:"TypeManagers.BaseDatesAndTimes","abstract":true,constructor:function(a){this.callParent([a])},config:{timeFormat:0,timeOneEqualsSeconds:1,valueAsNumber:false,parseStrict:false,parseTimeRequires:"h"},configrules:{timeFormat:{values:[0,1,2,10,11,12,100,101],clearCache:true},parseTimeRequires:{values:["h","m","s"],clearCache:true}},nativeTypeName:function(){return this.getValueAsNumber()?"number":"object"},storageTypeName:function(){return this.getValueAsNumber()?"float":"time"},supportsDates:function(){return false},supportsTimes:function(){return true},_stringToNative:function(b){var a=this._parse(b);if(a==null){this._inputError("Cannot convert ["+b+"] to "+this.dataTypeName()+".")}if(this.getValueAsNumber()){return this._fromNeutralToNumber(a)}if(a.h>23){this._inputError("Hours exceeds 23")}return this._fromNeutralToDate(a)},_nativeToString:function(b){if(b==null){return""}var a=(b instanceof Date)?this._fromDateToNeutral(b):this._fromNumberToNeutral(b);return this._format(a)},_parse:function(a){return this._parseTime(a)},_format:function(a){return this._formatTime(a)},_valChars:function(){var k="",n=new Array(),a="1234567890",l=this.dateTimeFormat("TimeSep"),h="(tt)|('[^']+')|(\\s)|(\\:)",q=new RegExp(h,"g"),f,d,c,o=this._timePattern();if(o){k+=o;a+=l}while((f=q.exec(k))!=null){d=f[0];if(n.indexOf(d)==-1){c=null;var b=null;switch(d){case"tt":var j=this.dateTimeFormat("AM")||"";var g=this.dateTimeFormat("PM")||"";c=[j,g];break;case":":break;default:a+=((d.indexOf("'")==0)?d.replace("'",""):d);break}if(b){c=this.dateTimeFormat(b)}if(c){var p=c.join("");a+=p.toLowerCase()+p.toUpperCase()}n.push(d)}}return a},_setNeutralFormat:function(a){this.callParent([a]);this.setTimeFormat(100);this.setValueAsNumber(a.getValueAsNumber());this.setTimeOneEqualsSeconds(a.getTimeOneEqualsSeconds());this.setParseTimeRequires("s");this.setParseStrict(true)},_dateToNumber:function(a){return this._toTimeInSeconds(a,1)},_isTOD:function(){return true},setTimeFormat:function(a){this._defaultSetter("timeFormat",a);this._clearCache()},setTimeOneEqualsSeconds:function(a){this._defaultSetter("timeOneEqualsSeconds",a);this._clearCache()},_timePattern:function(){var a;switch(this.getTimeFormat()){case 0:case 2:a="LongTimePattern";break;case 1:a="ShortTimePattern";break;case 10:case 12:a="LongDurationPattern";break;case 11:a="ShortDurationPattern";break;case 100:return"HH:mm:ss";case 101:return"HH:mm";default:return""}return this.dateTimeFormat(a)},_parseTime:function(o){if(this.getParseStrict()){var q=this._strictTimePatternRE();var d=q.exec(o);if(!d){return null}}var l=[0,0,0],n=this.dateTimeFormat("TimeSep"),b=this._isTOD(),k=false,f=false;if(b){o=o.toLowerCase();var m=this.dateTimeFormat("AM")||"",g=this.dateTimeFormat("PM")||"";if(m){k=o.indexOf(m.toLowerCase())>-1}if(g){f=o.indexOf(g.toLowerCase())>-1}var j=f?g:m;o=o.replace(j.toLowerCase(),"");o=jTAC.trimStr(o)}var q=this._cache.parseTimeRE;if(!q){var p=jTAC.escapeRE(n);var h=this.getParseTimeRequires();var c="^(\\d{1,4})("+p+"(\\d{1,2}))"+((h=="h")?"?":"");if(this._timePattern().indexOf("s")>-1){c+="("+p+"(\\d{1,2}))"+((h!="s")?"?":"")}c+="$";this._cache.parseTimeRE=q=new RegExp(c)}var d=q.exec(o);if(d==null){return null}var a={h:parseInt(d[1],10),m:d[3]!=null?parseInt(d[3],10):0,s:d[5]!=null?parseInt(d[5],10):0};if(b){if(k||f){if(this.getParseStrict()){if((a.h>12)||(a.h==0)){this._inputError("Hours conflict with designator.")}}if(a.h<12&&f){a.h=a.h+12}else{if(k&&(a.h==12)){a.h=0}}}if(a.h>23){this._inputError("Hours exceeds 24.")}}if(a.m>59){this._inputError("Minutes exceeds 59.")}if(a.s>59){this._inputError("Seconds exceeds 59.")}return a},_strictTimePatternRE:function(){var f=this._cache.strictTimeRE;if(!f){var b=this._timePattern();b=jTAC.replaceAll(b,"'","");var g=this.getParseTimeRequires();if(g!="s"){b=b.replace(":ss","(:ss)?");if(g!="m"){if(b.indexOf("mm")>-1){b=b.replace(":mm","(:mm)?")}else{b=b.replace(":m","(:m)?")}}}b=b.replace(/h{1,4}/i,"(\\d{1,4})");b=b.replace(/m?m/,"(\\d{1,2})");b=b.replace(/s?s/,"(\\d{1,2})");b=jTAC.replaceAll(b,":",jTAC.escapeRE(this.dateTimeFormat("TimeSep")),true);b=b.replace(" ","\\s?");if(b.indexOf("t")>-1){var a=this.dateTimeFormat("AM");var d=this.dateTimeFormat("PM");var c=a?"((?:"+jTAC.escapeRE(a)+")|(?:"+jTAC.escapeRE(d)+"))":"";b=b.replace(/t?t/,c)}b="^"+b+"$";this._cache.strictTimeRE=f=new RegExp(b,"i")}return f},_formatTime:function(d,b){if(!b){b=this._timePattern()}if(!d.s&&(this.getTimeFormat()%10==2)){b=b.replace(":ss","").replace(":s","")}var c=b;c=jTAC.replaceAll(c,":",this.dateTimeFormat("TimeSep"),true);if(b.indexOf("h")>-1){var a=d.h%12;if(a==0){a=12}c=this._replacePart("h",a,c)}else{c=this._replacePart("H",d.h,c)}c=this._replacePart("m",d.m,c);c=this._replacePart("s",d.s,c);c=c.replace("tt",this.dateTimeFormat(d.h>11?"PM":"AM"));return c},_fromNeutralToNumber:function(c){var a=c.h*3600+c.m*60+c.s;var b=this.getTimeOneEqualsSeconds();return(b>1)?a/b:a},_fromNumberToNeutral:function(b){var a=this.getTimeOneEqualsSeconds();if(a>1){b=Math.floor(b*a)}return{y:0,M:1,d:1,h:Math.floor(b/3600),m:Math.floor((b%3600)/60),s:Math.floor(b%60)}},_toTimeInSeconds:function(a,c){var b=this.getUseUTC()?a.getUTCHours()*3600+a.getUTCMinutes()*60+a.getUTCSeconds():a.getHours()*3600+a.getMinutes()*60+a.getSeconds();if(c>1){return b/c}return b}};jTAC.define("TypeManagers.BaseTime",jTAC._internal.temp._TypeManagers_BaseTime);jTAC._internal.temp._TypeManagers_TimeOfDay={extend:"TypeManagers.BaseTime",constructor:function(a){this.callParent([a])},dataTypeName:function(){return"timeofday"},_reviewValue:function(b){b=this.callParent([b]);if(typeof(b)=="number"){var c=b;var a=this.getTimeOneEqualsSeconds();if(a>1){c=c*a}if(Math.floor(c/3600)>=24){this._inputError("Exceeds 24 hours")}}return b}};jTAC.define("TypeManagers.TimeOfDay",jTAC._internal.temp._TypeManagers_TimeOfDay);jTAC.defineAlias("TimeOfDay","TypeManagers.TimeOfDay");jTAC.defineAlias("TimeOfDay.NoSeconds","TypeManagers.TimeOfDay",{timeFormat:1});jTAC.defineAlias("TimeOfDay.NoZeroSeconds","TypeManagers.TimeOfDay",{timeFormat:2});jTAC.defineAlias("TimeOfDay.InSeconds","TypeManagers.TimeOfDay",{valueAsNumber:true});jTAC.defineAlias("TimeOfDay.InHours","TypeManagers.TimeOfDay",{valueAsNumber:true,timeOneEqualsSeconds:3600});jTAC.defineAlias("TimeOfDay.InSeconds.NoSeconds","TypeManagers.TimeOfDay",{valueAsNumber:true,timeFormat:1});jTAC.defineAlias("TimeOfDay.InHours.NoSeconds","TypeManagers.TimeOfDay",{valueAsNumber:true,timeOneEqualsSeconds:3600,timeFormat:1});jTAC.defineAlias("TimeOfDay.InSeconds.NoZeroSeconds","TypeManagers.TimeOfDay",{valueAsNumber:true,timeFormat:2});jTAC.defineAlias("TimeOfDay.InHours.NoZeroSeconds","TypeManagers.TimeOfDay",{valueAsNumber:true,timeOneEqualsSeconds:3600,timeFormat:2});jTAC._internal.temp._TypeManagers_DateTime={extend:"TypeManagers.BaseDatesAndTimes",require:["TypeManagers.Date","TypeManagers.TimeOfDay"],config:{dateOptions:null,timeOptions:null,timeRequired:true},dataTypeName:function(){return"datetime"},storageTypeName:function(){return"datetime"},supportsDates:function(){return true},supportsTimes:function(){return true},_parse:function(d){var a,c,b=this._dateTimeSplitter(d);a=this.getDateOptions()._parse(b.d);if(!a){return null}c=this.getTimeOptions()._parse(b.t);if(!c){if(this.getTimeRequired()){this._inputError("Time required.")}c={h:0,m:0,s:0}}a.h=c.h;a.m=c.m;a.s=c.s;return a},_dateTimeSplitter:function(l){var j=this.getDateOptions().getDateFormat();if((j<10)||(j==100)){var h=l.indexOf(" ");if(h==-1){return{d:l,t:null}}return{d:l.substr(0,h),t:l.substr(h+1)}}else{var n=this.getTimeOptions();var o=this._cache.timeFindRE;if(!o){var d=n.dateTimeFormat("LongTimePattern");var k=jTAC.escapeRE(n.dateTimeFormat("TimeSep"));var h=d.indexOf("t");var c="\\d?\\d"+k+"\\d?\\d("+k+"\\d?\\d)?";if(h>-1){var f=n.dateTimeFormat("AM")||"";var b=n.dateTimeFormat("PM")||"";if(f){var g="(("+f+")|("+b+"))";c=h<d.indexOf("h")?g+"\\s?"+c:c+"\\s?"+g}}o=this._cache.timeFindRE=new RegExp(c,"i")}var a=o.exec(l);if(!a){return{d:l,t:null}}return{d:l.replace(a[0],""),t:a[0]}}},_format:function(b){var a=this.getDateOptions()._format(b);var c=this.getTimeOptions()._format(b);if(a){if(c){return a+" "+c}else{return a}}else{return c}},_valChars:function(){return this.getDateOptions()._valChars()+this.getTimeOptions()._valChars()+" "},_setNeutralFormat:function(a){this.callParent([a]);this.getDateOptions()._setNeutralFormat(a.getDateOptions());this.getTimeOptions()._setNeutralFormat(a.getTimeOptions())},_isNull:function(b){var a=this.callParent([b]);if(a){return true}return this._isNullYear(b)},getDateOptions:function(){var a=this.config.dateOptions;if(!this.config.dateOptions){a=this.config.dateOptions=jTAC.create("TypeManagers.Date");this._registerChild(a)}return a},setDateOptions:function(b){if((b==null)||(typeof b!="object")){this._error("Must pass an object whose properties match those on the dateOptions property.")}if(b instanceof jTAC.TypeManagers.Date){this._registerChild(b);this.config.dateOptions=b}else{var c=this.getDateOptions();for(var a in c.config){if(b[a]!=undefined){c.config[a]=b[a]}}}},getTimeOptions:function(){var a=this.config.timeOptions;if(!this.config.timeOptions){a=this.config.timeOptions=jTAC.create("TypeManagers.TimeOfDay");this._registerChild(a)}return a},setTimeOptions:function(b){if((b==null)||(typeof b!="object")){this._error("Must pass an object whose properties match those on the timeOptions property.")}if(b instanceof jTAC.TypeManagers.TimeOfDay){this._registerChild(b);this.config.timeOptions=b}else{var c=this.getTimeOptions();for(var a in c.config){if(b[a]!=undefined){c.config[a]=b[a]}}}},setCultureName:function(a){this.callParent([a]);this.getDateOptions().setCultureName(a);this.getTimeOptions().setCultureName(a)}};jTAC.define("TypeManagers.DateTime",jTAC._internal.temp._TypeManagers_DateTime);jTAC.defineAlias("DateTime","TypeManagers.DateTime");jTAC.defineAlias("DateTime.Short","TypeManagers.DateTime");jTAC.defineAlias("DateTime.Short.NoSeconds","TypeManagers.DateTime",{timeOptions:{timeFormat:1}});jTAC.defineAlias("DateTime.Abbrev","TypeManagers.DateTime",{dateOptions:{dateFormat:10}});jTAC.defineAlias("DateTime.Long","TypeManagers.DateTime",{dateOptions:{dateFormat:20}});jTAC._internal.temp._TypeManagers_Duration={extend:"TypeManagers.BaseTime",constructor:function(a){this.callParent([a])},config:{timeFormat:10,maxHours:9999},configrules:{timeFormat:[10,11,12,100,101]},dataTypeName:function(){return"duration"},_reviewValue:function(b){if(b instanceof Date){if(b.getHours()>this.getMaxHours()){this._inputError("Exceeded the max hours limit.")}}else{if(typeof(b)=="number"){var c=b;var a=this.getTimeOneEqualsSeconds();if(a>1){c=c*a}if(Math.floor(c/3600)>this.getMaxHours()){this._inputError("Exceeded the max hours limit.")}}else{if(b!=null){this._error("Value's type is not supported")}}}return b},_isTOD:function(){return false},_timePattern:function(){switch(this.getTimeFormat()){case 100:return"HHHH:mm:ss";case 101:return"HHHH:mm";default:return this.callParent()}}};jTAC.define("TypeManagers.Duration",jTAC._internal.temp._TypeManagers_Duration);jTAC.defineAlias("Duration","TypeManagers.Duration");jTAC.defineAlias("Duration.NoSeconds","TypeManagers.Duration",{timeFormat:11});jTAC.defineAlias("Duration.NoZeroSeconds","TypeManagers.Duration",{timeFormat:12});jTAC.defineAlias("Duration.InSeconds","TypeManagers.Duration",{valueAsNumber:true});jTAC.defineAlias("Duration.InHours","TypeManagers.Duration",{valueAsNumber:true,timeOneEqualsSeconds:3600});jTAC.defineAlias("Duration.InSeconds.NoSeconds","TypeManagers.Duration",{valueAsNumber:true,timeFormat:11});jTAC.defineAlias("Duration.InHours.NoSeconds","TypeManagers.Duration",{valueAsNumber:true,timeOneEqualsSeconds:3600,timeFormat:11});jTAC.defineAlias("Duration.InSeconds.NoZeroSeconds","TypeManagers.Duration",{valueAsNumber:true,timeFormat:12});jTAC.defineAlias("Duration.InHours.NoZeroSeconds","TypeManagers.Duration",{valueAsNumber:true,timeOneEqualsSeconds:3600,timeFormat:12});jTAC._internal.temp._TypeManagers_MonthYear={extend:"TypeManagers.BaseDate",constructor:function(a){this.callParent([a])},dataTypeName:function(){return"monthyear"},_isNull:function(b){var a=this.callParent([b]);if(a){return true}return this._isNullYear(b)},_dateToNumber:function(a){return this.getUseUTC()?a.getUTCFullYear()*12+a.getUTCMonth():a.getFullYear()*12+a.getMonth()},_datePattern:function(){var a;switch(this.getDateFormat()){case 0:a="ShortMonthYearPattern";break;case 1:case 2:a="ShortMonthYearPatternMN";break;case 10:a="AbbrMonthYearPattern";break;case 20:a="LongMonthYearPattern";break;case 100:return"yyyy-MM";default:return""}return this.dateTimeFormat(a)},_skipDatePart:function(){return"d"}};jTAC.define("TypeManagers.MonthYear",jTAC._internal.temp._TypeManagers_MonthYear);jTAC.defineAlias("MonthYear","TypeManagers.MonthYear");jTAC.defineAlias("MonthYear.Short","TypeManagers.MonthYear");jTAC.defineAlias("MonthYear.Abbrev","TypeManagers.MonthYear",{dateFormat:10});jTAC.defineAlias("MonthYear.Long","TypeManagers.MonthYear",{dateFormat:20});jTAC._internal.temp._TypeManagers_DayMonth={extend:"TypeManagers.BaseDate",constructor:function(a){this.callParent([a])},config:{},configrules:{},dataTypeName:function(){return"daymonth"},_dateToNumber:function(a){var a=this.getUseUTC()?new Date(2012,a.getUTCMonth(),a.getUTCDate()):new Date(2012,a.getMonth(),a.getDate());return this.callParent([a])},_datePattern:function(){var a;switch(this.getDateFormat()){case 0:a="ShortMonthDayPattern";break;case 1:case 2:a="ShortMonthDayPatternMN";break;case 10:a="AbbrMonthDayPattern";break;case 20:a="LongMonthDayPattern";break;case 100:return"MM-dd";default:return""}return this.dateTimeFormat(a)},_skipDatePart:function(){return"y"}};jTAC.define("TypeManagers.DayMonth",jTAC._internal.temp._TypeManagers_DayMonth);jTAC.defineAlias("DayMonth","TypeManagers.DayMonth");jTAC.defineAlias("DayMonth.Short","TypeManagers.DayMonth");jTAC.defineAlias("DayMonth.Abbrev","TypeManagers.DayMonth",{dateFormat:10});jTAC.defineAlias("DayMonth.Long","TypeManagers.DayMonth",{dateFormat:20});jTAC._internal.temp._TypeManagers_BaseString={extend:"TypeManagers.Base","abstract":true,constructor:function(a){this.callParent([a])},nativeTypeName:function(){return"string"},storageTypeName:function(){return"string"},toValue:function(b){if(b==null){return""}if(typeof(b)!="string"){b=b.toString()}var a=this._stringToNative(b);return this._reviewValue(a)},toString:function(a){if(a==null){return""}if(typeof(a)!="string"){a=a.toString()}a=this._reviewValue(a);return this._nativeToString(a)},_nativeToString:function(a){if(a==null){return""}return a.toString()},_stringToNative:function(a){return a},_isNull:function(a){if(a==""){return true}return a==null},compare:function(b,a){b=this.toValue(b);a=this.toValue(a);if((b==null)||(a==null)){this._error("Parameter value was null.")}if(this._isCaseIns()){b=b.toLowerCase();a=a.toLowerCase()}if(b<a){return -1}else{if(b>a){return 1}}return 0},_isCaseIns:function(){return false},toValueNeutral:function(a){return a},toStringNeutral:function(a){return this.toString(a)},isValidChar:function(a){return true},toNumber:function(a){return null}};jTAC.define("TypeManagers.BaseString",jTAC._internal.temp._TypeManagers_BaseString);jTAC._internal.temp._TypeManagers_BaseStrongPatternString={extend:"TypeManagers.BaseString","abstract":true,constructor:function(a){this.callParent([a])},config:{altREPattern:""},configrules:{},_reviewValue:function(b){var c=this.callParent([b]);if(c==""){return c}var a;if(this.getAltREPattern()){a=new RegExp(this.getAltREPattern(),this._isCaseIns()?"i":"")}else{a=this._regExp()}if(!a||a.test(c)){return c}this._inputError("Invalid "+this.dataTypeName()+" ["+c+"]")},_regExp:function(){this._AM()}};jTAC.define("TypeManagers.BaseStrongPatternString",jTAC._internal.temp._TypeManagers_BaseStrongPatternString);jTAC._internal.temp._TypeManagers_BaseRegionString={extend:"TypeManagers.BaseString","abstract":true,constructor:function(a){this.callParent([a])},config:{region:"",regionsData:null},configrules:{},_nativeToString:function(b){if(b==null){return""}var c=b.toString();if(c==""){return""}var a=this._getRegionNode(c);if(!a){this._inputError("Invalid "+this.dataTypeName())}if(a.toFormat){c=a.toFormat(c)}return c},_reviewValue:function(b){b=this.callParent([b]);if(b==""){return b}var a=this._getRegionNode(b);if(!a){this._inputError("Invalid "+this.dataTypeName()+" ["+b+"]")}return b},isValidChar:function(d){if(!this.callParent([d])){return false}var a=this._selectRegionNodes();if(!a.length){return true}for(var b=0;b<a.length;b++){var f=a[b];if(!f.validChar){return true}if(typeof f.validChar=="string"){var c=this._cache.validCharRE;if(!c){c=this._cache=new RegExp(f.validChar)}return c.test(d)}if(f.validChar(d)){return true}}return false},toValueNeutral:function(b){if(!b){return""}try{this._pushContext();var a=this._getRegionNode(b);if(!a){this._inputError("Invalid "+this.dataTypeName()+" ["+b+"]")}if(a.toNeutral){b=a.toNeutral(b)}return b}finally{this._popContext()}},_selectRegionNodes:function(){function d(k){var j=k.split("|");var g=this.getRegionsData();for(var f=0;f<j.length;f++){var h=g[j[f]];if(!h){this._error("Region ["+j[f]+"] not defined in the regionsData object.")}if(typeof h=="string"){d.call(this,h);continue}if(typeof h=="object"){c.push(h)}else{this._error("Region ["+h+"] definition invalid.")}}}var a=this._internal.rds;if(!a||(this._internal.rdc!=jTAC._globalRegionNameCount)){var b=this.getRegion();if(b==""){b=this.getRegionsData().defaultName}if(b=="GLOBAL"){b=jTAC._globalRegionName}if(!b){this._error("Could not identify a region name from the region property.")}var c=[];d.call(this,b);a=this._internal.rds=c;this._internal.rdc=jTAC._globalRegionNameCount}return a},_getRegionNode:function(f){var d=this._selectRegionNodes();for(var b=0;b<d.length;b++){var a=d[b];if(!f){return a}if(typeof a.pattern=="function"){if(a.call(this,f)){return a}}else{var c=new RegExp(this._resolvePattern.call(this,a),a.caseIns?"i":"");if(c.test(f)){return a}}}return null},_resolvePattern:function(a){return a.pattern},_defaultRegionsData:function(){this._AM()},applyNumberMask:function(l,o,c,f){var n=c?0:l.length-1;var d=c?0:o.length-1;var b=c?1:-1;var h=c?l.length:-1;var k=c?o.length-1:0;var a="";for(var j=d;c?j<=k:j>=k;j=j+b){var g=o.charAt(j);if(g=="#"){do{if(n==h){g=f;break}g=l.charAt(n);n=n+b}while((g<"0")||(g>"9"))}if(c){a=a+g}else{a=g+a}}if(n!=h){for(var j=n;c?j<h:j>h;j=j+b){var g=l.charAt(j);if((g>="0")&&(g<="9")){if(c){a=a+g}else{a=g+a}}}}return a},setRegion:function(a){this.config.region=jTAC.checkAsStr(a);this._internal.rds=null},getRegionsData:function(){var a=this.config.regionsData;if(!a){a=this.config.regionsData=this._defaultRegionsData()}return a},setRegionsData:function(a){if(typeof(a)!="object"){this._error("RegionsData must be an object")}this.config.regionsData=a}};jTAC.define("TypeManagers.BaseRegionString",jTAC._internal.temp._TypeManagers_BaseRegionString);jTAC.setGlobalRegionName=function(a){jTAC._globalRegionName=a;jTAC._globalRegionNameCount++};jTAC._globalRegionName=null;jTAC._globalRegionNameCount=0;jTAC._internal.temp._TypeManagers_String={extend:"TypeManagers.BaseString",constructor:function(a){this.callParent([a])},config:{caseIns:false},dataTypeName:function(){return"string"},_isCaseIns:function(){return this.config.caseIns}};jTAC.define("TypeManagers.String",jTAC._internal.temp._TypeManagers_String);jTAC.defineAlias("String","TypeManagers.String");jTAC.defineAlias("String.caseins","TypeManagers.String",{caseIns:true});jTAC._internal.temp._TypeManagers_EmailAddress={extend:"TypeManagers.BaseStrongPatternString",constructor:function(a){this.callParent([a])},config:{multiple:false,delimiterRE:";[ ]?"},dataTypeName:function(){return"EmailAddress"},_regExp:function(){var a="^"+this._addressRE;if(this.getMultiple()){a+="("+this.getDelimiterRE()+this._addressRE+")*"}a+="$";return new RegExp(a,"i")},_addressRE:"([\\w\\.!#\\$%\\-+.'_]+@[A-Za-z0-9\\-]+(\\.[A-Za-z0-9\\-]{2,})+)"};jTAC.define("TypeManagers.EmailAddress",jTAC._internal.temp._TypeManagers_EmailAddress);jTAC.defineAlias("EmailAddress","TypeManagers.EmailAddress");jTAC.defineAlias("EmailAddress.Multiple","TypeManagers.EmailAddress",{multiple:true});jTAC._internal.temp._TypeManagers_PhoneNumber={extend:"TypeManagers.BaseRegionString",constructor:function(a){this.callParent([a])},config:{supportsExt:false},dataTypeName:function(){return"PhoneNumber"},_resolvePattern:function(a){var c=a.pattern;if(this.getSupportsExt()){var b=a.extensionRE||"(\\s?\\#\\d{1,10})?";c=jTAC.replaceAll(c,"\\$\\)",b+"$)",false)}return c},_defaultRegionsData:function(){return window.jTAC_PhoneNumberRegionsData}};jTAC.define("TypeManagers.PhoneNumber",jTAC._internal.temp._TypeManagers_PhoneNumber);jTAC.defineAlias("PhoneNumber","TypeManagers.PhoneNumber");jTAC.defineAlias("PhoneNumber.NorthAmerica","TypeManagers.PhoneNumber",{region:"NorthAmerica"});jTAC.defineAlias("PhoneNumber.NorthAmerica.CountryCode","TypeManagers.PhoneNumber",{region:"NorthAmerica|CountryCode"});jTAC.defineAlias("PhoneNumber.UnitedStates","TypeManagers.PhoneNumber",{region:"UnitedStates"});jTAC.defineAlias("PhoneNumber.UnitedKingdom","TypeManagers.PhoneNumber",{region:"UnitedKingdom"});jTAC.defineAlias("PhoneNumber.France","TypeManagers.PhoneNumber",{region:"France"});jTAC.defineAlias("PhoneNumber.Japan","TypeManagers.PhoneNumber",{region:"Japan"});jTAC.defineAlias("PhoneNumber.Germany","TypeManagers.PhoneNumber",{region:"Germany"});jTAC.defineAlias("PhoneNumber.China","TypeManagers.PhoneNumber",{region:"China"});jTAC.defineAlias("PhoneNumber.Canada","TypeManagers.PhoneNumber",{region:"Canada"});var jTAC_PhoneNumberRegionsData={defaultName:"Any",Any:{name:"Any",pattern:"(^\\+?\\d([\\-\\.]?\\d){6,19}$)",validChar:"[0-9\\+\\-\\.]"},CountryCode:{name:"CountryCode",pattern:"(^\\+(?:\\d ?){6,14}\\d$)",validChar:"[0-9\\+ ]"},NorthAmerica:{name:"NorthAmerica",pattern:"(^([1])?[ ]?((\\([2-9]\\d{2}\\))|([2-9]\\d{2}))?[ ]?\\d{3}[ \\-]?\\d{4}$)",validChar:"[0-9\\+\\- \\(\\)]",toNeutral:function(d){var c="";for(var a=0;a<d.length;a++){var b=d.charAt(a);if((b>="0")&&(b<="9")){c+=b}}return c},toFormat:function(c){var b=jTAC_PhoneNumberRegionsData.NorthAmerica;var a=b.toNeutral(c);return jTAC.TypeManagers.BaseRegionString.prototype.applyNumberMask(a,b.formatMask,false,"")},formatMask:"#(###) ###-####"},UnitedStates:"NorthAmerica",Canada:"NorthAmerica",France:{name:"France",pattern:"(^(0( \\d|\\d ))?\\d\\d \\d\\d(\\d \\d| \\d\\d )\\d\\d$)",validChar:"[0-9 ]"},Japan:{name:"Japan",pattern:"(^(0\\d{1,4}-|\\(0\\d{1,4}\\) ?)?\\d{1,4}-\\d{4}$)",validChar:"[0-9\\- \\(\\)]"},Germany:{name:"Germany",pattern:"(^((\\(0\\d\\d\\) |(\\(0\\d{3}\\) )?\\d )?\\d\\d \\d\\d \\d\\d|\\(0\\d{4}\\) \\d \\d\\d-\\d\\d?)$)",validChar:"[0-9\\- \\(\\)]"},China:{name:"China",pattern:"(^(\\(\\d{3}\\)|\\d{3}-)?\\d{8}$)",validChar:"[0-9\\- \\(\\)]"},UnitedKingdom:{name:"UnitedKingdom",pattern:"(^(((\\+44\\s?\\d{4}|\\(?0\\d{4}\\)?)\\s?\\d{3}\\s?\\d{3})|((\\+44\\s?\\d{3}|\\(?0\\d{3}\\)?)\\s?\\d{3}\\s?\\d{4})|((\\+44\\s?\\d{2}|\\(?0\\d{2}\\)?)\\s?\\d{4}\\s?\\d{4}))$)",validChar:"[0-9\\+ \\(\\)]"}};jTAC._internal.temp._TypeManagers_PostalCode={extend:"TypeManagers.BaseRegionString",constructor:function(a){this.callParent([a])},config:{supportsExt:false},dataTypeName:function(){return"PostalCode"},_defaultRegionsData:function(){return window.jTAC_PostalCodeRegionsData}};jTAC.define("TypeManagers.PostalCode",jTAC._internal.temp._TypeManagers_PostalCode);jTAC.defineAlias("PostalCode","TypeManagers.PostalCode");jTAC.defineAlias("PostalCode.NorthAmerica","TypeManagers.PostalCode",{region:"NorthAmerica"});jTAC.defineAlias("PostalCode.UnitedStates","TypeManagers.PostalCode",{region:"UnitedStates"});jTAC.defineAlias("PostalCode.UnitedKingdom","TypeManagers.PostalCode",{region:"UnitedKingdom"});jTAC.defineAlias("PostalCode.France","TypeManagers.PostalCode",{region:"France"});jTAC.defineAlias("PostalCode.Japan","TypeManagers.PostalCode",{region:"Japan"});jTAC.defineAlias("PostalCode.Germany","TypeManagers.PostalCode",{region:"Germany"});jTAC.defineAlias("PostalCode.China","TypeManagers.PostalCode",{region:"China"});jTAC.defineAlias("PostalCode.Canada","TypeManagers.PostalCode",{region:"Canada"});var jTAC_PostalCodeRegionsData={defaultName:"UnitedStates|Canada",UnitedStates:{name:"UnitedStates",pattern:"(^(\\d{5}-\\d{4}|\\d{5})$)",validChar:"[0-9\\-]"},Canada:{name:"Canada",pattern:"(^[ABCEGHJ-NPRSTVXY]\\d[ABCEGHJ-NPRSTV-Z][ ]?\\d[ABCEGHJ-NPRSTV-Z]\\d$)",caseIns:true,validChar:"[0-9A-Za-z ]"},NorthAmerica:"UnitedStates|Canada",UnitedKingdom:{name:"UnitedKingdom",pattern:"(^(GIR 0AA|[A-PR-UWYZ]([0-9][0-9A-HJKPS-UW]?|[A-HK-Y][0-9][0-9ABEHMNPRV-Y]?) [0-9][ABD-HJLNP-UW-Z]{2})$)",validChar:"[0-9A-Z ]"},France:{name:"France",pattern:"(^\\d{5}$)",validChar:"[0-9]"},Japan:{name:"Japan",pattern:"(^\\d{3}(-(\\d{4}|\\d{2}))?$)",validChar:"[0-9\\-]"},Germany:{name:"Germany",pattern:"(^\\d{5}$)",validChar:"[0-9\\-D]"},China:{name:"China",pattern:"(^\\d{6}$)",validChar:"[0-9]"}};jTAC._internal.temp._TypeManagers_CreditCardNumber={extend:"TypeManagers.BaseString",constructor:function(a){this.callParent([a])},config:{brands:[{len:16,prefix:"51|52|53|54|55"},{len:13,prefix:"4"},{len:16,prefix:"4"},{len:15,prefix:"34|37"},{len:14,prefix:"300|301|302|303|305|36|38"},{len:16,prefix:"6011"}],allowSeps:""},configrules:{},dataTypeName:function(){return"CreditCardNumber"},_reviewValue:function(k){if(k==""){return""}var c=this.getAllowSeps();if(c){k=jTAC.replaceAll(k,c,"",true)}var g=k.length;if(g<10){this._inputError("Not enough digits")}if(!/^(\d+)$/.test(k)){this._inputError("Illegal character")}var n=this.getBrands();if(n){var a=0;for(var f=0;f<n.length;f++){var b=n[f];if(b.len==g){var m=new RegExp("^("+b.prefix+")","i");if(m.test(k)){a=1;break}}}if(!a){this._inputError("Brand mismatch")}}var l=0;var h=true;for(var f=g-1;f>=0;f--){var j=parseInt(k.charAt(f),10);if(h){l+=j}else{j=j*2;if(j>9){l+=1+(j%10)}else{l+=j}}h=!h}if(l%10!=0){this._inputError("Failed Luhns")}return k},isValidChar:function(a){if(!this.callParent([a])){return false}if(this.getAllowSeps()==a){return true}return"1234567890".indexOf(a)>-1},setBrands:function(a){if((a instanceof Array)||(a==null)){this.config.brands=a}else{this._error("Parameter must be an array or null.")}},setAllowSeps:function(a){if((typeof a=="string")&&(a.length<=1)){this.config.allowSeps=a}else{this._error("Parameter must be a 1 character string.")}}};jTAC.define("TypeManagers.CreditCardNumber",jTAC._internal.temp._TypeManagers_CreditCardNumber);jTAC.defineAlias("CreditCardNumber","TypeManagers.CreditCardNumber");jTAC.defineAlias("CreditCardNumber.AllBrands","TypeManagers.CreditCardNumber",{brands:null});jTAC._internal.temp._TypeManagers_URL={extend:"TypeManagers.BaseStrongPatternString",constructor:function(a){this.callParent([a])},config:{uriScheme:"http|https",domainExt:"aero|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|travel|jobs|mobi|pro|co",supportsIP:false,supportsPort:false,supportsPath:true,requireUriScheme:true},configrules:{},dataTypeName:function(){return"Url"},_regExp:function(){var a="^((?:"+this.getUriScheme()+")\\://)";if(!this.getRequireUriScheme()){a+="?"}if(this.getSupportsIP()){a+="(("}a+=this._domainRE;var b=this.getDomainExt();if(!b){b=this._defDomainExt}a+=this._domainExtRE.replace("{DE}",b);if(this.getSupportsIP()){a+=")|("+this._IPAddressRE+"))"}if(this.getSupportsPort()){a=a+this._portRE}if(this.getSupportsPath()){a+="/?("+this._filePathRE+")?"}else{a+="/?"}a+="$";return new RegExp(a,"i")},_domainRE:"[a-zA-Z0-9\\-\\.]+",_IPAddressRE:"(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|0?[1-9]{1}[0-9]{1}|0{0,2}[1-9])\\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|0?[1-9]{1}[0-9]{1}|0{0,2}[1-9]|0)\\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|0?[1-9]{1}[0-9]{1}|0{0,2}[1-9]|0)\\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|0?[1-9]{1}[0-9]{1}|0{0,2}[0-9])",_domainExtRE:"(?:\\.[a-z]{2})?\\.(?:{DE})(?:\\.[a-z]{2})?",_defDomainExt:"[a-zA-Z]{2,3}",_portRE:"(?:\\:\\d+)?",_filePathRE:"(?:/[a-zA-Z0-9_/%\\$#~][a-zA-Z0-9\\-\\._\\'/\\+%\\$#~]+[A-Za-z0-9])*"};jTAC.define("TypeManagers.Url",jTAC._internal.temp._TypeManagers_URL);jTAC.defineAlias("Url","TypeManagers.Url");jTAC.defineAlias("Url.FTP","TypeManagers.Url",{uriScheme:"ftp"});jTAC._internal.temp._TypeManagers_Boolean={extend:"TypeManagers.Base",constructor:function(a){this.callParent([a])},config:{reFalse:/^((false)|(0))$/i,reTrue:/^((true)|(1))$/i,numFalse:[0],numTrue:[1],falseStr:"false",trueStr:"true",emptyStrFalse:true},configrules:{reFalse:jTAC.checkAsRegExp,reTrue:jTAC.checkAsRegExp},nativeTypeName:function(){return"boolean"},dataTypeName:function(){return"boolean"},storageTypeName:function(){return"boolean"},_nativeToString:function(a){return a?this.getTrueStr():this.getFalseStr()},toValue:function(a){if(typeof(a)=="number"){return this._numberToBoolean(a)}return this.callParent([a])},_stringToNative:function(b){if(b==""){if(this.getEmptyStrFalse()){return false}this._error("Empty string is not permitted when emptyStrFalse = false.")}else{var a=this.getReFalse();if(a&&a.test(b)){return false}a=this.getReTrue();if(a&&a.test(b)){return true}}this._inputError("Could not convert the string '"+b+"' to a boolean.")},_isNull:function(a){if(a==""){return !this.getEmptyStrFalse()}return a==null},_numberToBoolean:function(a){var c=this.getNumFalse();if(c&&(c.length>0)&&(c.indexOf(a)>-1)){return false}var b=this.getNumTrue();if(b){if(b===true){return true}if((b.length>0)&&(b.indexOf(a)>-1)){return true}}this._inputError("Could not convert the number "+a+" to a boolean.")},toValueNeutral:function(a){if(typeof(a)=="boolean"){return a}if(/^false$/i.test(a)){return false}if(/^true$/i.test(a)){return true}this._inputError("Required values: 'false' and 'true'")},toStringNeutral:function(a){if(a==null){return""}return a?"true":"false"},_reviewValue:function(a){return !!a},isValidChar:function(a){return true},toNumber:function(a){return a?1:0},setNumFalse:function(a){if(typeof(a)=="number"){a=[a]}this.config.numFalse=a},setNumTrue:function(a){if(typeof(a)=="number"){a=[a]}this.config.numTrue=a}};jTAC.define("TypeManagers.Boolean",jTAC._internal.temp._TypeManagers_Boolean);jTAC.defineAlias("Boolean","TypeManagers.Boolean");if(!window.jTAC){throw new Error("window.jTAC not created.")}jTAC._internal.temp._Conditions_Base={"abstract":true,constructor:function(a){this._createConnections(this.config.connections)},config:{enabled:true,lastEvaluateResult:null,trim:true,connections:new Array(),not:false,typeManager:null,datatype:null,autoDisable:true},configrules:{typeManager:jTAC.checkAsTypeManager,lastEvaluateResult:jTAC.checkAsIntOrNull,connections:{autoSet:false}},canEvaluate:function(){if(!this.getEnabled()){return false}if(this.getAutoDisable()&&!this._connsEditable()){return false}return true},evaluate:function(){try{this._pushContext();switch(this._evaluateRule()){case 1:return this.config.lastEvaluateResult=this.getNot()?0:1;case 0:return this.config.lastEvaluateResult=this.getNot()?1:0;default:this.config.lastEvaluateResult=-1;return -1}}finally{this._popContext()}},isValid:function(){return this.evaluate()!=0},_evaluateRule:function(){this.AM()},_createConnections:function(a){},_connsEditable:function(){var a=this.getConnections();if(a){for(var b=0;b<a.length;b++){if(!a[b].isEditable()){return false}}}return true},collectConnections:function(d){var a=this.getConnections();if(a){for(var b=0;b<a.length;b++){var c=a[b];d.push(c);if(c.collectConnections){c.collectConnections(d)}}}},_applyTrimToConns:function(a){var b=this.config.connections;for(var c=0;c<b.length;c++){var d=b[c];if(d.trim!==undefined){d.trim=a}}},_checkTypeManager:function(){if(!this.config.typeManager){jTAC.require("TypeManagers.Base");var b=this.config.connections;if(b&&b.length){var c=b[0];var a=c.getTypeManager();if(a){this.config.typeManager=a;return a}}this.config.typeManager=jTAC.create("TypeManagers.Integer")}return this.config.typeManager},setTrim:function(a){this.config.trim=jTAC.checkAsBool(a);this._applyTrimToConns(a)},setTypeManager:function(a){jTAC.require("TypeManagers.Base");this.config.typeManager=a?jTAC.checkAsTypeManager(a,this.config.typeManager):null},getDatatype:function(){return this.config.typeManager?this.config.typeManager.storageTypeName():null},setDatatype:function(a){this.setTypeManager(a)}};jTAC.define("Conditions.Base",jTAC._internal.temp._Conditions_Base);jTAC.checkAsCondition=function(b,a){return jTAC.checkAsClass(b,a,jTAC.Conditions.Base)};jTAC.checkAsConditionOrNull=function(a){if(!a){return null}return jTAC.checkAsCondition(a)};jTAC.evaluate=function(a){var b=jTAC.create(null,a);return b.evaluate()};jTAC.isValid=function(a){var b=jTAC.create(null,a);return b.isValid()};jTAC._internal.temp._Conditions_BaseOneConnection={extend:"Conditions.Base","abstract":true,require:["Connections.FormElement"],constructor:function(a){this.callParent([a])},config:{connection:null,elementId:null},_createConnections:function(a){a[0]=jTAC.create("Connections.FormElement")},getConnection:function(){return this.config.connections[0]},setConnection:function(a){this.config.connections[0]=jTAC.checkAsConnection(a,this.config.connections[0])},getElementId:function(){var a=this.config.connections[0];return a&&a.getId?a.getId():null},setElementId:function(c){var a=this.config.connections;var b=jTAC.connectionResolver.create(c,a[0]);if(b){a[0]=b}else{a[0].id=c}}};jTAC.define("Conditions.BaseOneConnection",jTAC._internal.temp._Conditions_BaseOneConnection);jTAC._internal.temp._Conditions_BaseTwoConnections={extend:"Conditions.BaseOneConnection","abstract":true,constructor:function(a){this.callParent([a])},config:{connection2:null,elementId2:null},_createConnections:function(a){this.callParent([a]);a[1]=jTAC.create("Connections.FormElement")},getConnection2:function(){return this.config.connections[1]},setConnection2:function(a){this.config.connections[1]=jTAC.checkAsConnection(a,this.config.connections[1])},getElementId2:function(){var a=this.config.connections[1];return a&&a.getId?a.getId():null},setElementId2:function(c){var a=this.config.connections;var b=jTAC.connectionResolver.create(c,a[1]);if(b){a[1]=b}else{a[1].id=c}}};jTAC.define("Conditions.BaseTwoConnections",jTAC._internal.temp._Conditions_BaseTwoConnections);jTAC._internal.temp._Conditions_BaseOneOrMoreConnections={extend:"Conditions.BaseOneConnection","abstract":true,constructor:function(a){this.callParent([a]);this._internal.allMustBeEditable=true},config:{moreConnections:[],ignoreNotEditable:true},_connsEditable:function(){if(this._internal.allMustBeEditable){return this.callParent()}var a=this.getConnections();if(a){for(var b=0;b<a.length;b++){if(a[b].isEditable()){return true}}}return false},getConnections:function(){var b=[];if(this.config.connections){b=this.config.connections.concat(b)}var a=this.getMoreConnections();for(var c=0;c<a.length;c++){b.push(a[c])}return b},_cleanupConnections:function(){var c=[];var a=this.getConnections();if(a){for(var b=0;b<a.length;b++){if(!this.getIgnoreNotEditable()||a[b].isEditable()){c.push(a[b])}}}return c},_resolveMoreConnections:function(){var a=this.config.moreConnections;for(var b=0;b<a.length;b++){var c=a[b];if(typeof c=="string"){var f=c;var d=jTAC.create("Connections.FormElement",{id:f});c=jTAC.connectionResolver.create(f,d);a[b]=c?c:d}else{if(!(c instanceof jTAC.Connections.Base)&&(typeof(c)=="object")){if(!c.jtacClass){this._error("Must define the Connection's class in the 'jtacClass' property of the object that describes a Connection.")}c=jTAC.create(null,c);a[b]=c}else{if(!(c instanceof jTAC.Connections.Base)){this._error("The moreConnections property must only contain Connection objects and JSon objects that generate Connection objects.")}}}}},getMoreConnections:function(){if(this.config.moreConnections){this._resolveMoreConnections()}return this.config.moreConnections}};jTAC.define("Conditions.BaseOneOrMoreConnections",jTAC._internal.temp._Conditions_BaseOneOrMoreConnections);jTAC._internal.temp._Conditions_BaseOperator={extend:"Conditions.BaseTwoConnections","abstract":true,constructor:function(a){this.callParent([a])},config:{operator:"="},configrules:{operator:["=","<>",">","<",">=","<="]},_compare:function(c,b){var a=this.getTypeManager().compare(c,b);switch(this.getOperator()){case"=":return a==0;case"<>":return a!=0;case">":return a==1;case"<":return a==-1;case">=":return a>-1;case"<=":return a<1}}};jTAC.define("Conditions.BaseOperator",jTAC._internal.temp._Conditions_BaseOperator);jTAC._internal.temp._Conditions_BaseCounter={extend:"Conditions.BaseOneOrMoreConnections","abstract":true,constructor:function(a){this.callParent([a])},config:{minimum:null,maximum:null},configrules:{minimum:jTAC.checkAsIntOrNull,maximum:jTAC.checkAsIntOrNull},canEvaluate:function(){if((this.getMinimum()==null)&&(this.getMaximum()==null)){return false}return this.callParent()},_evaluateRule:function(){var c=this._cleanupConnections();var b=c.length;if(!b){return -1}var g=0;for(var f=0;f<c.length;f++){g+=this._connCount(c[f])}this.count=g;var d=this.getMinimum();var a=this.getMaximum();if((d!=null)&&(g<d)){return 0}if((a!=null)&&(g>a)){return 0}return 1},_connCount:function(a){this._AM()}};jTAC.define("Conditions.BaseCounter",jTAC._internal.temp._Conditions_BaseCounter);jTAC._internal.temp._Conditions_Required={extend:"Conditions.BaseOneOrMoreConnections",constructor:function(a){this.callParent([a]);this._internal.allMustBeEditable=false},config:{mode:"OneOrMore",minimum:0,maximum:999},configrules:{mode:["All","OneOrMore","AllOrNone","One","Range"]},_evaluateRule:function(){var b=this.getMoreConnections();if(b.length==0){var g=this.getConnection();if(!g.isEditable()){return -1}return this.count=(g.isNullValue(true)?0:1)}var c=this._cleanupConnections();var a=c.length;if(!a){return -1}var f=0;for(var d=0;d<c.length;d++){if(!c[d].isNullValue(true)){f++}}this.count=f;switch(this.getMode()){case"All":return f==a?1:0;case"OneOrMore":return(f>0)?1:0;case"AllOrNone":return((f==0)||(f==a))?1:0;case"One":return(f==1)?1:0;case"Range":return((this.getMinimum()<=f)&&(f<=this.getMaximum()))?1:0;default:this._error("Unknown mode name.")}}};jTAC.define("Conditions.Required",jTAC._internal.temp._Conditions_Required);jTAC.defineAlias("Required","Conditions.Required");jTAC._internal.temp._Conditions_DataTypeCheck={extend:"Conditions.BaseOneConnection",constructor:function(a){this.callParent([a])},_evaluateRule:function(){var b=this.getConnection();if(b.isNullValue()){return -1}try{var a=this.getTypeManager().toValueFromConnection(b);return a!=null?1:-1}catch(c){return 0}},getTypeManager:function(){return this._checkTypeManager()}};jTAC.define("Conditions.DataTypeCheck",jTAC._internal.temp._Conditions_DataTypeCheck);jTAC.defineAlias("DataTypeCheck","Conditions.DataTypeCheck");jTAC._internal.temp._Conditions_Range={extend:"Conditions.BaseOneConnection",constructor:function(a){this.callParent([a])},config:{minimum:null,maximum:null,lessThanMax:false},canEvaluate:function(){return this.callParent()&&((this.config.minimum!=null)||(this.config.maximum!=null))},_evaluateRule:function(){var d=this.getConnection();if(d.isNullValue()){return -1}var b=this.getTypeManager();var c,a;var h="minimum";try{c=b.toValueNeutral(this.getMinimum());if((c==null)&&b.getMinValue){c=b.getMinValue}h="maximum";a=b.toValueNeutral(this.getMaximum());if((a==null)&&b.getMaxValue){a=b.getMaxValue}}catch(g){var j=h+" property must be in the culture neutral format for "+b.storageTypeName()+" on element id "+d.getId()+". "+g.message;this._error(j)}try{var f=b.toValueFromConnection(d);if(f==null){return -1}}catch(g){return -1}if(c!=null){if(b.compare(f,c)<0){return 0}}if(a!=null){if(this.getLessThanMax()){if(b.compare(f,a)>=0){return 0}}else{if(b.compare(f,a)>0){return 0}}}return 1},getTypeManager:function(){return this._checkTypeManager()}};jTAC.define("Conditions.Range",jTAC._internal.temp._Conditions_Range);jTAC.defineAlias("Range","Conditions.Range");jTAC._internal.temp._Conditions_CompareToValue={extend:"Conditions.BaseOperator",constructor:function(a){this.callParent([a])},config:{valueToCompare:null},_createConnections:function(a){this.callParent([a]);a[1].setAllowNone(true)},canEvaluate:function(){return this.callParent()&&(this.config.valueToCompare!=null)},_evaluateRule:function(){var d=this.getConnection();if(d.isNullValue()||(this.getValueToCompare()==null)){return -1}var b=this.getTypeManager();var a=null;try{a=b.toValueNeutral(this.getValueToCompare())}catch(f){var g="valueToCompare property must be in the culture neutral format for "+b.storageTypeName()+" on element id "+d.getId()+". "+f.message;this._error(g)}try{var c=b.toValueFromConnection(d);if((c==null)||(a==null)){return -1}return this._compare(c,a)?1:0}catch(f){return -1}},getTypeManager:function(){return this._checkTypeManager()}};jTAC.define("Conditions.CompareToValue",jTAC._internal.temp._Conditions_CompareToValue);jTAC.defineAlias("CompareToValue","Conditions.CompareToValue");jTAC._internal.temp._Conditions_CompareTwoElements={extend:"Conditions.BaseOperator",constructor:function(a){this.callParent([a])},_evaluateRule:function(){var f=this.getConnection();var c=this.getConnection2();if(f.isNullValue()||c.isNullValue()){return -1}try{var b=this.getTypeManager();var d=b.toValueFromConnection(f);var a=b.toValueFromConnection(c);if((d==null)||(a==null)){return -1}return this._compare(d,a)?1:0}catch(g){return -1}},getTypeManager:function(){return this._checkTypeManager()}};jTAC.define("Conditions.CompareTwoElements",jTAC._internal.temp._Conditions_CompareTwoElements);jTAC.defineAlias("CompareTwoElements","Conditions.CompareTwoElements");jTAC._internal.temp._Conditions_BaseRegExp={extend:"Conditions.BaseOneConnection","abstract":true,constructor:function(a){this.callParent([a])},config:{ignoreBlankText:true},canEvaluate:function(){if(!this.getExpression()){return false}return this.callParent()},_evaluateRule:function(){var b=this._internal.regex;if(!b){var d=this._getExpression();if(!d){return -1}var c="";if(this._getCaseIns()){c+="i"}if(this._getGlobal()){c+="g"}if(this._getMultiline()){c+="m"}b=this._internal.regex=new RegExp(d,c)}var a=this.connection.getTextValue();if(!a){return this.getIgnoreBlankText()?-1:0}return b.test(a)?1:0},_getExpression:function(){this._AM()},_getCaseIns:function(){return false},_getGlobal:function(){return false},_getMultiline:function(){return false}};jTAC.define("Conditions.BaseRegExp",jTAC._internal.temp._Conditions_BaseRegExp);jTAC._internal.temp._Conditions_RegExp={extend:"Conditions.BaseRegExp",constructor:function(a){this.callParent([a])},config:{expression:"",caseIns:true,global:false,multiline:false},_getExpression:function(){return this.getExpression()},_getCaseIns:function(){return this.getCaseIns()},_getGlobal:function(){return this.getGlobal()},_getMultiline:function(){return this.getMultiline()}};jTAC.define("Conditions.RegExp",jTAC._internal.temp._Conditions_RegExp);jTAC.defineAlias("RegExp","Conditions.RegExp");jTAC._internal.temp._Conditions_Difference={extend:"Conditions.BaseOperator",constructor:function(a){this.callParent([a])},config:{differenceValue:1},configrules:{differenceValue:function(a){if(typeof a=="number"){return a}jTAC.error("Requires a number")}},_evaluateRule:function(){var d=this.getConnection();if(d.isNullValue()){return -1}try{var b=this.getTypeManager();var c=b.toValueFromConnection(d);var a=b.toValueFromConnection(this.getConnection2());if((c==null)||(a==null)){return -1}c=b.toNumber(c);a=b.toNumber(a);if((c==null)||(a==null)){return -1}return this._compare(Math.abs(c-a),this.getDifferenceValue())?1:0}catch(f){return -1}},getTypeManager:function(){return this._checkTypeManager()}};jTAC.define("Conditions.Difference",jTAC._internal.temp._Conditions_Difference);jTAC.defineAlias("Difference","Conditions.Difference");jTAC._internal.temp._Conditions_RequiredIndex={extend:"Conditions.BaseOneConnection",constructor:function(a){this.callParent([a])},config:{unassignedIndex:0},_evaluateRule:function(){var a=this.getConnection();if(a.typeSupported("index")){var b=a.getTypedValue("index");return(b!=this.getUnassignedIndex())?1:0}else{this._error("The element ["+this.getElementId()+"] does not support list lookup functions.")}}};jTAC.define("Conditions.RequiredIndex",jTAC._internal.temp._Conditions_RequiredIndex);jTAC.defineAlias("RequiredIndex","Conditions.RequiredIndex");jTAC._internal.temp._Conditions_SelectedIndex={extend:"Conditions.BaseOneConnection",constructor:function(a){this.callParent([a])},config:{index:null},canEvaluate:function(){if(this.getIndex()==null){return false}return this.callParent()},_evaluateRule:function(){function b(k,g){for(var h=0;h<g.length;h++){var j=g[h];if(j instanceof Array){if(j.length!=2){this._error("Invalid range. Must be array of 2 integers.")}if((j[0]<=k)&&(k<=j[1])){return true}}else{if(k==j){return true}}}return false}var a=this.getIndex();var d=this.getConnection();if(d.typeSupported("indices")){var f=d.getTypedValue("indices");if(typeof a=="number"){if(a==-1){return f.length==0?1:0}a=[a]}for(var c=0;c<f.length;c++){if(b(f[c],a)){return 1}}return 0}else{if(d.typeSupported("index")){var f=d.getTypedValue("index");if(a instanceof Array){return b(f,a)?1:0}return(f==a)?1:0}else{this._error("The element ["+this.getElementId()+"] does not support list lookup functions.")}}},setIndex:function(a){if(a instanceof Array){this.config.index=a}else{this.config.index=jTAC.checkAsIntOrNull(a)}}};jTAC.define("Conditions.SelectedIndex",jTAC._internal.temp._Conditions_SelectedIndex);jTAC.defineAlias("SelectedIndex","Conditions.SelectedIndex");jTAC._internal.temp._Conditions_BooleanLogic={extend:"Conditions.Base",constructor:function(a){this.callParent([a])},config:{operator:"OR",conditions:[]},configrules:{operator:["OR","AND"]},canEvaluate:function(){if(!this.getConditions().length){return false}return this.callParent()},_evaluateRule:function(){var g;this._cleanupConditions();var b=this.getConditions();var f=this.getOperator()=="AND";for(var a=0;a<b.length;a++){var c=b[a];if(c.canEvaluate()){var d=c.evaluate();if(d!=-1){g=true;if(d){if(!f){return 1}}else{if(f){return 0}}}}}if(!g){return -1}return f?1:0},_cleanupConditions:function(){try{this._pushContext();var b=this.getConditions();for(var a=0;a<b.length;a++){var c=b[a];if(!(c instanceof jTAC.Conditions.Base)&&(typeof(c)=="object")){if(!c.jtacClass){this._error("Must define the Condition's class in the 'jtacClass' property of the object that describes a condition.")}c=jTAC.create(null,c);b[a]=c}else{if(!(c instanceof jTAC.Conditions.Base)){this._error("The conditions property must only contain Condition objects and JSon objects that generate Condition objects.")}}}}finally{this._popContext()}},collectConnections:function(c){this.callParent([c]);this._cleanupConditions();var b=this.getConditions();if(b){for(var a=0;a<b.length;a++){b[a].collectConnections(c)}}}};jTAC.define("Conditions.BooleanLogic",jTAC._internal.temp._Conditions_BooleanLogic);jTAC.defineAlias("BooleanLogic","Conditions.BooleanLogic");jTAC._internal.temp._Conditions_DuplicateEntry={extend:"Conditions.BaseOneOrMoreConnections",constructor:function(a){this.callParent([a])},config:{caseIns:true,ignoreUnassigned:true},_evaluateRule:function(){this._errconn1=null;this._errconn2=null;var b=this._cleanupConnections();var a=b.length;if(!a){return -1}var g=[];for(var c=0;c<b.length;c++){var f=b[c].getTextValue();if((f.length==0)&&this.getIgnoreUnassigned()){continue}if(this.getCaseIns()){f=f.toUpperCase()}var d=g[f];if(d!=null){this._errconn1=d;this._errconn2=b[c];return 0}g[f]=b[c]}return 1},};jTAC.define("Conditions.DuplicateEntry",jTAC._internal.temp._Conditions_DuplicateEntry);jTAC.defineAlias("DuplicateEntry","Conditions.DuplicateEntry");jTAC._internal.temp._Conditions_CharacterCount={extend:"Conditions.BaseCounter",constructor:function(a){this.callParent([a])},_connCount:function(a){return a.textLength()}};jTAC.define("Conditions.CharacterCount",jTAC._internal.temp._Conditions_CharacterCount);jTAC.defineAlias("CharacterCount","Conditions.CharacterCount");jTAC._internal.temp._Conditions_WordCount={extend:"Conditions.BaseCounter",constructor:function(a){this.callParent([a])},_connCount:function(d){var c=d.getTextValue();if(c.length==0){return 0}c=c.replace(new RegExp("'","gi"),"");var b=new RegExp(this._wordREPattern,"ig");var a=0;while(b.exec(c)!=null){a++}return a},_wordREPattern:"(\\b|^)(\\w+?)(\\b|$)"};jTAC.define("Conditions.WordCount",jTAC._internal.temp._Conditions_WordCount);jTAC.defineAlias("WordCount","Conditions.WordCount");jTAC._internal.temp._Conditions_CountSelections={extend:"Conditions.BaseCounter",constructor:function(a){this.callParent([a])},_connCount:function(a){if(a.typeSupported("indices")){return a.getTypedValue("indices").length}else{this._error("Connection does not specify a multiple selection list.")}}};jTAC.define("Conditions.CountSelections",jTAC._internal.temp._Conditions_CountSelections);jTAC.defineAlias("CountSelections","Conditions.CountSelections");jTAC._internal.temp._Connections_Value={extend:"Connections.Base",constructor:function(a){this.callParent([a])},config:{value:null,nullValue:null,supportedTypeName:null},getTextValue:function(){var c=this.getValue();if(c==null){c=""}else{var a=this.getTypeManager();try{c=a?a.toString(c):c.toString()}catch(b){c=c.toString()}}return c},setTextValue:function(a){this.setValue(a)},typeSupported:function(a){return a==this.getSupportedTypeName()},getTypedValue:function(a){if((a!=null)&&!this.typeSupported(a)){this._error("Type not supported")}return this.getValue()},setTypedValue:function(a){this.setValue(a)},isNullValue:function(a){if(!a&&(typeof(this._value)=="boolean")){return false}return this.getValue()==this.getNullValue()},getTypeManager:function(){switch(this.getSupportedTypeName()){case"boolean":return jTAC.create("TypeManagers.Boolean",null,true);break;case"integer":return jTAC.create("TypeManagers.Integer",null,true);break;case"float":return jTAC.create("TypeManagers.Float",null,true);break;case"date":return jTAC.create("TypeManagers.Date",null,true);break}return null},_updateTypeName:function(a){if(a!=null){var b=this.getSupportedTypeName();if(typeof(a)=="number"){if(b!="float"){b="integer"}}else{if(typeof(a)=="boolean"){b="boolean"}else{if(typeof(a)=="object"){if(a instanceof Date){b="date"}}}}this.setSupportedTypeName(b)}},setValue:function(a){this.config.value=a;this._updateTypeName(a)}};jTAC.define("Connections.Value",jTAC._internal.temp._Connections_Value);(function(b){if(b.validator.replaceTokens){return}var a={formatAndAdd:function(f,h){var g=this.defaultMessage(f,h.method),d=/\$?\{(\d+)\}/g;if(typeof g==="function"){g=g.call(this,h.parameters,f)}var c=b.validator.replaceTokens[h.method];if(!c){c=b.validator.defaultTokenReplacer}g=c.call(b.validator,g,f,h.parameters,b(f).val());this.errorList.push({message:g,element:f});this.errorMap[f.name]=g;this.submitted[f.name]=g},defaultTokenReplacer:function(f,c,j,h){var d=/\$?\{(\d+)\}/g;if(d.test(f)){f=b.validator.format(f.replace(d,"{$1}"),j)}if(h==null){h=""}f=this.tokenReplacer(f,"VALUE",h.toString());var g=this.elementLabel(c)||"*** Add the data-msglabel attribute to id "+c.id+". ***";f=this.tokenReplacer(f,"LABEL",g);return f},tokenReplacer:function(g,d,c){var f=new RegExp("\\{"+d+"\\}","ig");return g.replace(f,c.toString())},minMaxReplacer:function(g,d,c,f){if(d!=null){g=this.tokenReplacer(g,"MIN",d)}if(c!=null){g=this.tokenReplacer(g,"MAX",c)}if(f!=null){g=this.tokenReplacer(g,"LENGTH",f);if(typeof d!=="number"){d=0}if(typeof c!=="number"){c=99999999}var h=Math.max(f-c,d-f);g=this.tokenReplacer(g,"DIFF",h)}return g},elementLabel:function(d){if(!d){return null}var c=d.getAttribute("data-msglabel");if(c==null){var f=b("label[for='"+d.id+"'][generated!='true']");if(f){c=f.html();if(c){c=c.replace(/\<(.|\n)+?\>/ig,"");c=c.replace(/[^\dA-Za-z]+$/,"");c=c.replace(/^[^\dA-Za-z]+/,"");d.setAttribute("data-msglabel",c)}}}return c},replaceTokens:{minlength:function(d,c,g,f){d=b.validator.minMaxReplacer(d,g,null,f.length);return b.validator.defaultTokenReplacer(d,c,g,f)},maxlength:function(d,c,g,f){d=b.validator.minMaxReplacer(d,null,g,f.length);return b.validator.defaultTokenReplacer(d,c,g,f)},rangelength:function(d,c,g,f){d=b.validator.minMaxReplacer(d,g[0],g[1],f.length);return b.validator.defaultTokenReplacer(d,c,g,f)},min:function(d,c,g,f){d=b.validator.minMaxReplacer(d,g,null,null);return b.validator.defaultTokenReplacer(d,c,g,f)},max:function(d,c,g,f){d=b.validator.minMaxReplacer(d,null,g,null);return b.validator.defaultTokenReplacer(d,c,g,f)},range:function(d,c,g,f){d=b.validator.minMaxReplacer(d,g[0],g[1],null);return b.validator.defaultTokenReplacer(d,c,g,f)}}};b.extend(b.validator.prototype,a);b.extend(b.validator,a)}(jQuery));if(!window.jTAC){throw new Error("window.jTAC not created.")}jTAC.require("Conditions.Base");jTAC_Temp={config:{depends:null,lookupKey:null},configrule:{lookupKey:jTAC.checkAsStrOrNull},replaceTokens:function(d,c){var b=d;switch(c.context){case"alert":b=jTAC.replaceAll(b,"{NEWLINE}","\n",true);case"tooltip":b=jTAC.replaceAll(b,"{NEWLINE}","\r",true);b=jTAC.replaceAll(b,"<(.|\n)+?>","");break;default:b=jTAC.replaceAll(b,"{NEWLINE}","<br />",true);break}if(jTAC.contains(b,"{ERRORLABEL}",true)){var a=c.messagelabel;b=jTAC.replaceAll(b,"{ERRORLABEL}",a!=null?a:"messagelabel")}return b},_replaceToken:function(c,b,a){if(jTAC.contains(c,b,true)){c=jTAC.replaceAll(c,b,a.toString(),true)}return c},_spReplaceToken:function(f,c,b){var d=new RegExp("\\{"+b+":([^:}]*):([^:}]*)\\}");var a=d.exec(f);if((a!=null)&&(a.length==3)){var g=new RegExp("{"+b+":"+a[1]+":"+a[2]+"}","gi");if(c==1){return f.replace(g,a[1])}else{return f.replace(g,a[2])}}return f},_tmReplaceToken:function(j,g,f,d){if(jTAC.contains(f)){var b=g;var c=this.getTypeManager();if(c){var a=jTAC.silentWarnings();jTAC.silentWarnings(true);try{try{if(typeof(b)=="string"){b=c.toValueNeutral(b)}b=c.toString(b);if(d.context=="html"){b=jTAC.htmlEncode(b)}}catch(h){b=g}}finally{jTAC.silentWarnings(a)}}j=jTAC.replaceAll(j,f,b,true)}return j},defaultErrorMessage:function(){return""},setDepends:function(a){if(typeof a=="function"){this.config.depends=a}else{if((typeof a=="string")&&(a.indexOf("{")!=0)){this.config.depends=a}else{this.config.depends=jTAC.checkAsConditionOrNull(a)}}},canEvaluate:function(){if(!this.getEnabled()){return false}if(this.getAutoDisable()&&!this._connsEditable()){return false}var b=this.getDepends();if(b){if(typeof b=="function"){var a=null;if(b.getConnection){a=b.getConnection().getElement()}return b.call(this,a)}else{if((typeof b=="object")&&b.canEvaluate()&&(b.evaluate()==0)){return false}}if(typeof b=="string"){return $(b).length>0}}return true},ruleName:function(){return this.$className.toLowerCase()}};jTAC.addMembers("Conditions.Base",jTAC_Temp);if(jTAC.isDefined("Conditions.BaseOneConnection")){jTAC_Temp={replaceTokens:function(d,b){var a=this.callParent([d,b]);var c=this.getConnection();a=this._tmReplaceToken(a,c.getTextValue(),"{VALUE}",b);if(jTAC.contains(a,"{LABEL}",true)){a=jTAC.replaceAll(a,"{LABEL}",c.getLabel()||"<strong>Warning: No label defined for "+c.getId()+". Use &lt;Label for=&gt; or data-msglabel='label' in the element.</strong>",true)}return a}};jTAC.addMembers("Conditions.BaseOneConnection",jTAC_Temp)}if(jTAC.isDefined("Conditions.BaseTwoConnections")){jTAC_Temp={replaceTokens:function(d,b){var a=this.callParent([d,b]);var c=this.getConnection2();a=this._tmReplaceToken(a,c.getTextValue(),"{VALUE2}",b);if(jTAC.contains(a,"{LABEL2}",true)){a=jTAC.replaceAll(a,"{LABEL2}",c.getLabel()||"<strong>Warning: No label defined for "+c.getId()+". Use &lt;Label for=&gt; or data-msglabel='label' in the element.</strong>",true)}return a}};jTAC.addMembers("Conditions.BaseTwoConnections",jTAC_Temp)}if(jTAC.isDefined("Conditions.DataTypeCheck")){jTAC_Temp={replaceTokens:function(d,c){var b=this.callParent([d,c]);if(jTAC.contains(b,"{DATATYPE}",true)){var a=this.getTypeManager().getFriendlyName();b=jTAC.replaceAll(b,"{DATATYPE}",a,true)}return b},defaultErrorMessage:function(){return"<span class='{ERRORLABEL}'>{LABEL}</span> must be a valid {DATATYPE}."}};jTAC.addMembers("Conditions.DataTypeCheck",jTAC_Temp)}if(jTAC.isDefined("Conditions.Range")){jTAC_Temp={ruleName:function(){return"advrange"},replaceTokens:function(c,b){var a=this.callParent([c,b]);a=this._tmReplaceToken(a,this.getMinimum(),"{MINIMUM}",b);a=this._tmReplaceToken(a,this.getMaximum(),"{MAXIMUM}",b);return a},defaultErrorMessage:function(){return"<span class='{ERRORLABEL}'>{LABEL}</span> must be between {MINIMUM} and {MAXIMUM}."}};jTAC.addMembers("Conditions.Range",jTAC_Temp)}if(jTAC.isDefined("Conditions.BaseOperator")){jTAC_Temp={replaceTokens:function(d,c){var b=this.callParent([d,c]);var a=this.getOperator();a=jTAC.translations.lookup(a,a);if(c.context=="html"){a=jTAC.htmlEncode(a)}b=jTAC.replaceAll(b,"{OPERATOR}",a,true);return b}};jTAC.addMembers("Conditions.BaseOperator",jTAC_Temp)}if(jTAC.isDefined("Conditions.CompareToValue")){jTAC_Temp={replaceTokens:function(c,b){var a=this.callParent([c,b]);a=this._tmReplaceToken(a,this.getValueToCompare(),"{VALUETOCOMPARE}",b);return a},defaultErrorMessage:function(){return"<span class='{ERRORLABEL}'>{LABEL}</span> must be {OPERATOR} {VALUETOCOMPARE}."}};jTAC.addMembers("Conditions.CompareToValue",jTAC_Temp)}if(jTAC.isDefined("Conditions.CompareTwoElements")){jTAC_Temp={defaultErrorMessage:function(){return"<span class='{ERRORLABEL}'>{LABEL}</span> must be {OPERATOR} <span class='{ERRORLABEL}'>{LABEL2}</span>."}};jTAC.addMembers("Conditions.CompareTwoElements",jTAC_Temp)}if(jTAC.isDefined("Conditions.Difference")){jTAC_Temp={replaceTokens:function(f,d){var c=this.callParent([f,d]);if(jTAC.contains(c,"{DIFFVALUE}",true)){var a=this.getDifferenceValue();if(typeof(a)!="string"){var b=jTAC.create("TypeManagers.Float");b.setTrailingZeroDecimalPlaces(0);b.setMaxDecimalPlaces(3);a=b.toString(a)}if(d.context=="html"){a=jTAC.htmlEncode(a)}c=jTAC.replaceAll(c,"{DIFFVALUE}",a,true)}return c},defaultErrorMessage:function(){return"Difference between <span class='{ERRORLABEL}'>{LABEL}</span> and <span class='{ERRORLABEL}'>{LABEL2}</span> must be {OPERATOR} {DIFFVALUE}."}};jTAC.addMembers("Conditions.Difference",jTAC_Temp)}if(jTAC.isDefined("Conditions.Required")){jTAC_Temp={ruleName:function(){return"advrequired"},replaceTokens:function(d,c){var b=this.callParent([d,c]);var a=this.count;if(a==null){a=0}b=jTAC.replaceAll(b,"{COUNT}",a.toString(),true);b=jTAC.replaceAll(b,"{MINIMUM}",this.getMinimum().toString(),true);return jTAC.replaceAll(b,"{MAXIMUM}",this.getMaximum().toString(),true)},defaultErrorMessage:function(){return"<span class='{ERRORLABEL}'>{LABEL}</span> requires an entry."}};jTAC.addMembers("Conditions.Required",jTAC_Temp)}if(jTAC.isDefined("Conditions.RequiredIndex")){jTAC_Temp={defaultErrorMessage:function(){return"<span class='{ERRORLABEL}'>{LABEL}</span> requires a selection."}};jTAC.addMembers("Conditions.RequiredIndex",jTAC_Temp)}if(jTAC.isDefined("Conditions.SelectedIndex")){jTAC_Temp={defaultErrorMessage:function(){return"<span class='{ERRORLABEL}'>{LABEL}</span> has an invalid selection. Choose another."}};jTAC.addMembers("Conditions.SelectedIndex",jTAC_Temp)}if(jTAC.isDefined("Conditions.BaseCounter")){jTAC_Temp={replaceTokens:function(h,g){var f=this.callParent([h,g]);var d=this.count;if(d==null){d=0}f=jTAC.replaceAll(f,"{COUNT}",d.toString(),true);f=this._spReplaceToken(f,d,"COUNT");var c=this.getMinimum();if(c==null){c=0}f=jTAC.replaceAll(f,"{MINIMUM}",c.toString(),true);var b=this.getMaximum();if(b==null){b=9999999}f=jTAC.replaceAll(f,"{MAXIMUM}",b.toString(),true);var a=Math.max(c-d,d-b);f=jTAC.replaceAll(f,"{DIFF}",a.toString(),true);f=this._spReplaceToken(f,a,"DIFF");return f}};jTAC.addMembers("Conditions.BaseCounter",jTAC_Temp)}if(jTAC.isDefined("Conditions.CharacterCount")){jTAC_Temp={defaultErrorMessage:function(){return"<span class='{ERRORLABEL}'>{LABEL}</span> must have between {MINIMUM} and {MAXIMUM} characters."}};jTAC.addMembers("Conditions.CharacterCount",jTAC_Temp)}if(jTAC.isDefined("Conditions.WordCount")){jTAC_Temp={defaultErrorMessage:function(){return"<span class='{ERRORLABEL}'>{LABEL}</span> must have between {MINIMUM} and {MAXIMUM} words."}};jTAC.addMembers("Conditions.WordCount",jTAC_Temp)}if(jTAC.isDefined("Conditions.CountSelections")){jTAC_Temp={defaultErrorMessage:function(){return"<span class='{ERRORLABEL}'>{LABEL}</span> must have between {MINIMUM} and {MAXIMUM} selections."}};jTAC.addMembers("Conditions.CountSelections",jTAC_Temp)}if(jTAC.isDefined("Conditions.RegExp")){jTAC_Temp={config:{patternLabel:"format",patternLookupKey:null},configrule:{patternLookupKey:jTAC.checkAsStrOrNull},replaceTokens:function(d,c){var b=this.callParent([d,c]);var a=jTAC.translations.lookup(this.getPatternLookupKey(),this.getPatternLabel());if(c.context=="html"){a=jTAC.htmlEncode(a)}return jTAC.replaceAll(b,"{PATTERN}",a,true)},defaultErrorMessage:function(){return"<span class='{ERRORLABEL}'>{LABEL}</span> must be a valid {PATTERN}."}};jTAC.addMembers("Conditions.RegExp",jTAC_Temp)}if(jTAC.isDefined("Conditions.DuplicateEntry")){jTAC_Temp={replaceTokens:function(d,c){var b=this.callParent([d,c]);if(jTAC.contains(b,"{LABEL",true)){var a="field 1";if(this._errconn1){a=this._errconn1.getLabel()}b=jTAC.replaceAll(b,"{LABEL1}",a,true);a="field 2";if(this._errconn2){a=this._errconn2.getLabel()}b=jTAC.replaceAll(b,"{LABEL2}",a,true)}return b},defaultErrorMessage:function(){return"<span class='{ERRORLABEL}'>{LABEL1}</span> must be different from <span class='{ERRORLABEL}'>{LABEL2}</span>."}};jTAC.addMembers("Conditions.DuplicateEntry",jTAC_Temp)}if(jTAC.isDefined("Conditions.BooleanLogic")){jTAC_Temp={defaultErrorMessage:function(){return"*** EXPLICITY ASSIGN THIS MESSAGE ***"}};jTAC.addMembers("Conditions.BooleanLogic",jTAC_Temp)}if(!window.jTAC){throw new Error("window.jTAC not created.")}if(!window.jQuery||!$.validator){jTAC.error("Must load jquery and jquery-validate script files first.")}if($.validator.replaceTokens===undefined){jTAC.error("Must load /jTAC/jquery-validate/ReplaceTokens PlugIn.js script file before Rules.js.")}jTAC.require(["Connections.FormElement","TypeManagers.Base","Conditions.Base"]);jTAC.jqueryValidate=(function(){var unobtrusive=$.validator?$.validator.unobtrusive:null;function createCondition(element,condname,param){try{jTAC._internal.pushContext("jqueryValidate.createCondition()",condname);delete param.Condition;var cond;if(typeof(param)=="function"){cond=param()}else{if(typeof(param)=="object"){cond=jTAC.create(condname,param)}else{if((param===true)||(param==null)){cond=jTAC.create(condname,null)}else{jTAC.error("Value for a condition function must be an object.")}}}if(element&&(cond.connection instanceof jTAC.Connections.BaseElement)){cond.connection=jTAC.connectionResolver.create(element,cond.connection)}return cond}finally{jTAC._internal.popContext()}}function evaluate(element,condname,params){try{jTAC._internal.pushContext("jqueryValidate.evaluate()",condname);if(params==null){jTAC.error("Params must be assigned.")}if(!condname&&params.jtacClass){condname=params.jtacClass}delete params.jtacClass;var cond=params.Condition;if(!cond){cond=createCondition(element,condname,params);params.Condition=cond}if(!cond.canEvaluate.call(cond)){return"dependency-mismatch"}var r=cond.evaluate.call(cond);if(r==-1){return"dependency-mismatch"}return !!r}finally{jTAC._internal.popContext()}}function validate(validator,id){try{jTAC._internal.pushContext("jqueryValidate.validate('"+id+"')");var el=$("#"+id);if(el.valid()){validator.defaultShowErrors()}}finally{jTAC._internal.popContext()}}function defaultOptions(){var orig=$.prototype.validate;$.prototype.validate=function(options){if(this.length&&options){if(options.messagelabel===undefined){options.messagelabel="message-label"}if(options.labelErrorClass===undefined){options.labelErrorClass="label-validation-error"}if(options.containerErrorClass===undefined){options.containerErrorClass="container-validation-error"}if(options.messageErrorClass===undefined){options.messageErrorClass="message-validation-error"}if(options.messageValidClass===undefined){options.messageValidClass="message-validation-valid"}if(options.inputErrorClass===undefined){options.inputErrorClass=options.errorClass?options.errorClass:"input-validation-error"}options.errorClass=options.messageErrorClass;if(options.inputValidClass===undefined){options.inputValidClass=options.validClass?options.validClass:"input-validation-valid"}options.validClass=options.messageValidClass;if(unobtrusive||(options.errorPlacement===undefined)){if(!unobtrusive&&options.errorPlacement&&!options.errorPlacementFallback){options.errorPlacementFallback=options.errorPlacement}options.errorPlacement=$.proxy(onError,this[0])}if(unobtrusive||(options.success===undefined)){if(!unobtrusive&&options.success&&!options.successFallback){options.successFallback=options.success}options.success=$.proxy(onSuccess,this[0])}}return orig.call(this,options)}}defaultOptions();function mergeOptions(formElement,newOptions){var funcProps=["submitHandler","invalidHandler","invalidHandlerFallback","showErrors","errorPlacement","errorPlacementFallback","success","successFallback","highlight","unhighlight","highlight1","unhighlight1"];var validator=$.data(formElement[0],"validator");var options;if(validator&&validator.settings){options=validator.settings}else{validator=formElement.validate({});options=validator.settings}var val=newOptions.success||newOptions.successFallback;if(val){if(window[val]===undefined){funcProps.splice(funcProps.indexOf("success"),1)}}for(var propName in newOptions){if(!propName){continue}var val=newOptions[propName];if((funcProps.indexOf(propName)>-1)&&(typeof val=="string")){options[propName]=window[val];if((options[propName]==null)&&window.console){jTAC.warn("Validator options include the property ["+propName+" = '"+val+"']. This value must match a globally declared function.",null,"jqueryValidate.MergeOptions")}}else{options[propName]=val}}return options}function attachMultiConnections(formselector){try{jTAC._internal.pushContext("jqueryValidate.attachMultiConnections()");var form=$(formselector);if(!form||!form.length){return}var validator=$.data(form[0],"validator");var rules=validator.settings.rules;$.each(rules,function(key,value){if(!key){return}var el=document.getElementById(key);if(!el){el=document.getElementsByName(key);if(!el||!el.length){return}el=el[0]}$.each(value,function(childkey,paramcont){if(childkey=="messages"){return}var condname=ruleNameMap[childkey];if(condname==null){return}var srcId=el.id;var func=function(e){validate(validator,srcId)};try{var cond=createCondition(el,condname,paramcont.param?paramcont.param:paramcont);if(paramcont.param){paramcont.param.Condition=cond}var conns=[];cond.collectConnections(conns);for(var j=0;j<conns.length;j++){if(conns[j] instanceof jTAC.Connections.BaseElement){if(j>0){conns[j].addEventListener("onchange",func,"qvc"+el.id)}conns[j].addSupportEventListeners("onchange",func,"qvc"+el.id)}}}catch(e){jTAC.warn("Exception occurred when checking element "+srcId+", check the '"+condname+"' method. Exception message: "+e.message)}})})}finally{jTAC._internal.popContext()}}function installUnobtrusive(){if(runInstall){return}runInstall=true;try{jTAC._internal.pushContext("jqueryValidate.installUnobtrusive()");var forms=$("form");$.each(forms,function(key,form){form=$(form);var newOptions=form.data("val-options");if(newOptions){try{if(typeof newOptions=="string"){newOptions=window.eval("("+newOptions+");")}mergeOptions(form,newOptions)}catch(e){jTAC.error("Could not parse the data-val-options attribute of form id ["+form.get()[0].id+"] Error info:"+e.toString())}}attachMultiConnections(form)})}finally{jTAC._internal.popContext()}}var runInstall=false;if(unobtrusive){var postInit=[];unobtrusive.nativeParse=unobtrusive.parse;unobtrusive.parse=function(selector){unobtrusive.nativeParse(selector);installUnobtrusive();for(var i=0;i<postInit.length;i++){postInit[i]()}}}function registerConditionsAsRules(){try{jTAC._internal.pushContext("jqueryValidate.registerConditionsAsRules()");var defs=jTAC._internal.definitions;for(var fullClassName in defs){var def=jTAC.getDefinition(fullClassName);if(def.inst instanceof jTAC.Conditions.Base){if(!def.inst.$abstract){useConditionAsRule(def.inst.ruleName(),fullClassName)}}}}finally{jTAC._internal.popContext()}}var defaultMessages={};var ruleNameMap=[];function useConditionAsRule(ruleName,fullClassName){ruleNameMap[ruleName]=fullClassName;var ruleFnc=function(value,element,params){return evaluate.call(this,element,fullClassName,params)};var emFnc=function(ruleparms,element){return retrieveErrorMessage(ruleName,ruleparms)};$.validator.addMethod(ruleName,ruleFnc,emFnc);if($.validator.replaceTokens){$.validator.replaceTokens[ruleName]=replaceTokens}if($.validator.unobtrusive){$.validator.unobtrusive.adapters.add(ruleName,["json"],function(options){try{var obj=options.params.json?eval("("+options.params.json+")"):{};options.rules[ruleName]={param:obj}}catch(e){jTAC.error("Syntax error in data-val-"+ruleName+"-json attribute of the HTML element "+options.element.id+". Error reported: "+e+" Attribute value: "+options.params.json.toString())}if(options.message){options.messages[ruleName]=options.message}})}}function retrieveErrorMessage(ruleName,param){var cond=param.Condition;var defmsg=defaultMessages[ruleName];if(!defmsg){defmsg=defaultMessages[ruleName]=jTAC.translations.lookup(ruleName+"EM",cond.defaultErrorMessage())}if(cond&&cond.getLookupKey){var key=cond.getLookupKey();if(key){defmsg=jTAC.translations.lookup(key,defmsg)}}return defmsg}function replaceTokens(message,element,param,value){try{var cond=param.Condition;if(cond&&cond.replaceTokens){var validator=$.data(element.form,"validator");message=cond.replaceTokens.call(cond,message,{element:element,value:value,validator:validator,context:"html",messagelabel:validator.settings.messagelabel})}}catch(e){jTAC.warn('Exception occurred replacing tokens in message "'+message+'" of element '+(element?element.id:"[unknown]")+" Exception: "+e.message,null,"jqueryValidate.replaceTokens()")}return message}registerConditionsAsRules();function onError(error,inputElement){var validator=$.data(this,"validator");var options=validator.settings;var name=inputElement[0].name||inputElement[0].id;var container=$(this).find("[data-valmsg-for='"+name+"']");if(!container||!container.length){error.removeClass(options.messageValidClass).addClass(options.messageErrorClass);if(options.errorPlacementFallback){options.errorPlacementFallback.call(validator,error,inputElement)}else{error.insertAfter(inputElement)}return}container.removeClass("field-validation-valid").addClass("field-validation-error");error.data("unobtrusiveContainer",container);var ec=$(container).data("jtac-errorclass");if(ec==null){ec=options.messageErrorClass}var vc=$(container).data("jtac-validclass");if(vc==null){vc=options.messageValidClass}error.removeClass(vc).addClass(ec);var replace=$.parseJSON(container.attr("data-valmsg-replace"))!==false;if(replace){container.empty();error.appendTo(container)}else{error.hide()}}function onSuccess(error){var validator=$.data(this,"validator");var options=validator.settings;var container=error.data("unobtrusiveContainer");if(!container||!container.length){error.removeClass(options.messageErrorClass).addClass(options.messageValidClass);var fb=options.successFallback;if(fb!=null){if(typeof fb=="string"){label.addClass(fb)}else{fb.call(validator,error)}}return}if(container){var ec=$(container).data("jtac-errorclass");if(ec==null){ec=options.messageErrorClass}var vc=$(container).data("jtac-validclass");if(vc==null){vc=options.messageValidClass}container.removeClass("field-validation-error").addClass("field-validation-valid");error.removeData("unobtrusiveContainer");error.removeClass(ec).addClass(vc);var replace=$.parseJSON(container.attr("data-valmsg-replace"));if(replace){container.empty()}}}function defaultShowErrors(){function captureH(el,ec,vc){if(!el||!el.id){return}if(elementsFound[el.id]==undefined){elementsFound[el.id]={valid:false,element:el}}}function captureU(el,ec,vc){if(!el||!el.id){return}if((elementsFound[el.id]==undefined)||elementsFound[el.id]){elementsFound[el.id]={valid:true,element:el}}}try{jTAC._internal.pushContext("jqueryValidate.defaultShowErrors()");var elementsFound={};var options=this.settings;var svH=options.highlight;var svUH=options.unhighlight;try{options.highlight=captureH;options.unhighlight=captureU;origDefaultShowErrors.call(this)}finally{options.highlight=svH;options.unhighlight=svUH}if(svH||svUH||options.labelErrorClass||options.containerErrorClass){gatherElements(this,elementsFound);if(svH||svUH){hilightInputs(this,elementsFound)}hilightNearby(this,elementsFound)}}finally{jTAC._internal.popContext()}}var origDefaultShowErrors=$.validator.prototype.defaultShowErrors;$.validator.prototype.defaultShowErrors=defaultShowErrors;function gatherElements(validator,elementsFound){var rules=validator.settings.rules;$.each(rules,function(key,value){if(!key){return}$.each(value,function(childkey,paramcont){if(childkey=="messages"){return}var holder=paramcont.param||paramcont.params||paramcont;var cond=holder.Condition;if(!cond){return}var last=cond.getLastEvaluateResult();if((last==-1)||(last==null)){return}try{var conns=[];cond.collectConnections(conns);for(var j=0;j<conns.length;j++){var conn=conns[j];if(conn instanceof jTAC.Connections.BaseElement){var el=conn.getElement();if(!el||!el.id){continue}if((elementsFound[el.id]===undefined)||elementsFound[el.id].valid){elementsFound[el.id]={valid:last==1,element:el}}}}}catch(e){jTAC.warn("Exception occurred when checking elements for the "+key+"' rule. Exception: "+e.message,null,"jqueryValidate.gatherElements()")}})})}function hilightInputs(validator,elementsFound){var options=validator.settings;for(var propName in elementsFound){var r=elementsFound[propName];var fnc=r.valid?options.unhighlight:options.highlight;if(fnc){var ec=$(r.element).data("jtac-errorclass");if(ec==null){ec=options.inputErrorClass}var vc=$(r.element).data("jtac-validclass");if(vc==null){vc=options.inputValidClass}fnc.call(validator,r.element,ec,vc)}}}function hilightNearby(validator,elementsFound){var options=validator.settings;if(options.labelErrorClass===undefined){options.labelErrorClass="label-validation-error"}if(options.containerErrorClass===undefined){options.containerErrorClass="container-validation-error"}if(!options.labelErrorClass&&!options.containerErrorClass){return}if(!options.cssNearby){options.cssNearby=defaultCssNearby}var labels=$("Label");$.each(labels,function(key,value){var id=value.htmlFor;if(id&&elementsFound[id]&&!value.getAttribute("generated")){options.cssNearby.call(this,value,options.labelErrorClass,elementsFound[id].valid)}});var containers=$("[data-jtac-valinputs]");$.each(containers,function(key,value){var ids=$(value).data("jtac-valinputs");if(ids==null){return}if(ids==""){for(var propName in elementsFound){var r=elementsFound[propName];var p=r.element.parentNode;while(p&&(p.tagName!="FORM")){if(p==value){options.cssNearby.call(this,value,options.containerErrorClass,r.valid);break}p=p.parentNode}}}else{ids=ids.split("|");for(var i=0;i<ids.length;i++){var id=ids[i];if(id&&elementsFound[id]){options.cssNearby.call(this,value,options.containerErrorClass,elementsFound[id].valid)}}}})}function defaultCssNearby(elToUpdate,css,isValid){var elToUpdate=$(elToUpdate);var local=elToUpdate.data("jtac-errorclass");if(local){css=local}if(css==null){return}if(isValid){elToUpdate.removeClass(css)}else{elToUpdate.addClass(css)}}var publics={createCondition:createCondition,evaluate:evaluate,validate:validate,attachMultiConnections:attachMultiConnections,installUnobtrusive:installUnobtrusive,mergeOptions:mergeOptions,postInit:postInit};publics._internal={useConditionAsRule:useConditionAsRule};return publics}());jTAC._internal.temp._Connections_BaseJQUIElement={extend:"Connections.BaseElement","abstract":true,constructor:function(a){this.callParent([a])},getElement:function(){try{this._pushContext();if(this._internal.element!=null){return this._internal.element}var b=this.getId();if(!b){this._error("Did not assign the id.")}var a=$("#"+b);if(a){this._checkElement(a)}else{if(!a&&!this.getAllowNone()){this._error("HTML Element not found for "+b)}}return a}finally{this._popContext()}},setElement:function(a){if(typeof(a.jquery)!="string"){a=$(a)}this._internal.element=a},_checkElement:function(a){if(typeof(a.jquery)=="string"){return true}this._error("Element must be a jQuery instance.")},getTextValue:function(){var a=this.getElement();if(a){return this._cleanString(a.val())}return null},setTextValue:function(a){var b=this.getElement();if(b){b.val(a)}},addEventListener:function(b,c,d){var f=this.getElement();if(f){if(d){var a="data-jqueryconnection-"+d;if(f.data(a)!=null){return true}f.data(a,true)}f.bind(b.substr(2),c)}return false},getData:function(a){var b=this.getElement(true);if(b){return b.data(a)}return null},setData:function(a,c){var b=this.getElement(true);if(b){b.data(a,c)}},isVisible:function(){var a=this.getElement(true);if(!a){return true}return this._isDOMVisible(a.get(0))},isEnabled:function(){var a=this.getElement(true);if(!a){return true}return this._isDOMEnabled(a.get(0))},getLabel:function(){var a=this.getElement(true);if(a){a=a.get(0)}return this._locateLabel(a,this.getDefaultLabel())},getClass:function(){var a=this.getElement();if(a){return a.css()}return""},setClass:function(a){var b=this.getElement();if(b){b.css(a)}},addClass:function(a){var b=this.getElement();if(b){b.addClass(a)}},removeClass:function(a){var b=this.getElement();if(b){b.removeClass(a)}}};jTAC.define("Connections.BaseJQUIElement",jTAC._internal.temp._Connections_BaseJQUIElement);jTAC._internal.temp._Connections_JQUIDatePicker={extend:"Connections.BaseJQUIElement",constructor:function(a){this.callParent([a])},typeSupported:function(a){return a=="date"},getTypedValue:function(b){var h=this.getElement();if(h){if(b&&(b!="date")){this._error("The jquery element "+this.getId()+" does not support the type "+b,"getTypedValue")}var j=$.datepicker;var f=j._getInst(h[0]);var a=j._get(f,"dateFormat");var g=h.val();var c=j._getFormatConfig(f);try{return j.parseDate(a,g,c)}catch(d){j.log(d);throw d}}return null},setTypedValue:function(a){var b=this.getElement();if(b){if(a instanceof Date){b.datepicker("setDate",a)}else{this._error("The HTML element "+this.getId()+" does not support the type of the value","setTypedValue")}}},isNullValue:function(a){return this.getTextValue()==""},_checkElement:function(a){this.callParent([a]);if(!this.testElement(a)){this._error("Element must have a datepicker object.")}},testElement:function(b){if(window.$&&$.datepicker){var a=(typeof b=="string")?document.getElementById(b):b;if(a){if(a.jquery){a=a[0]}return $.data(a,"datepicker")!=null}}return false},_createTypeManager:function(b){if(!jTAC.isDefined("TypeManagers.Base")){this._error("Must load TypeManager scripts.")}var a=this.callParent();if(!a){return jTAC.create(this._defaultTypeManager)}return a},_defaultTypeManager:"TypeManagers.Date"};jTAC.define("Connections.JQUIDatePicker",jTAC._internal.temp._Connections_JQUIDatePicker);jTAC.connectionResolver.register("Connections.JQUIDatePicker");if(!window.jTAC){throw new Error("window.jTAC not created.")}jTAC.parser={_registered:new Array(),register:function(b){var a=jTAC.create(b,null,false);this._registered.push(a)},next:function(d){var b=this._registered;for(var a=0;a<b.length;a++){var c=b[a].parse(d,this);if(c){return c}}return null},err:function(f,a,d,b){var c="Could not parse the expression starting here: "+f;if(a){c="Error: "+a+" "+c}jTAC.error(c,d,b?b:(d?null:"Parser"))},asExact:function(j,b,g,h,f){var d=this._peREs;if(!d){this._peREs=d=[]}var k=d[b];if(!k){var c="^\\s*"+jTAC.escapeRE(b);if(f){c+="(?="+f+"|$)"}d[b]=k=new RegExp(c,h?"i":"")}var a=k.exec(j);if(a){return{rem:j.substr(a[0].length)}}if(g){this.err(j,b+" expected.",null,"Parser.asExact")}return null},asNumber:function(c,b){if(!this._numRE){this._numRE=new RegExp("^\\s*(\\-?\\d+(\\.\\d+)?)(?![\\.\\dA-Za-z])")}var a=this._numRE.exec(c);if(a){var d=parseFloat(a[1]);return{number:d,rem:c.substr(a[0].length)}}if(b){this.err(c,"Number expected.",null,"Parser.asNumber")}return null},asInt:function(c,b){if(!this._numRE){this._numRE=new RegExp("^\\s*(\\-?\\d+)(?!\\.A-Za-z)")}var a=this._numRE.exec(c);if(a){var d=parseInt(a[1],10);return{number:d,rem:c.substr(a[0].length)}}if(b){this.err(c,"Integer expected.",null,"Parser.asInt")}return null},asBool:function(c,b){var a=this.asExact(c,"true",false,false,"\\W");if(a){a.bool=true;return a}a=this.asExact(c,"false",false,false,"\\W");if(a){a.bool=false;return a}if(b){this.err(c,"true or false expected.",null,"Parser.asBool")}return null},asParmDelim:function(c,b){if(!this._sepRE){this._sepRE=new RegExp("^\\s*(\\,|\\)|\\})")}var a=this._sepRE.exec(c);if(a){return{delim:a[1],rem:c.substr(a[0].length)}}if(b){this.err(c,"Comma or ) character expected.",null,"Parser.asParmDelim")}return null},oParen:function(b,a){return this.asExact(b,"(",a,false,null)},cParen:function(b,a){return this.asExact(b,")",a,false,null)},asJSon:function(text,req){var m,obj,re;if(!/^\s*\{/.test(text)){return null}m=/^\s*/.exec(text);if(m){text=text.substr(m[0].length)}var nest=0;re=new RegExp("([\\{\\}])","g");while(m=re.exec(text)){if(m[1]=="{"){nest++}else{if(nest){nest--;if(!nest){try{obj=eval("("+text.substr(0,m.index+1)+");")}catch(e){this.err(text,"JSon parsing error. "+e.message,null,"Parser.asJSon")}return{JSon:obj,rem:text.substr(m.index+1)}}}}}this.err(text,"JSon parsing error. Missing closing }.",null,"Parser.asJSon")},asNull:function(b,a){return this.asExact(b,"null",a,false,"\\W")},asNaN:function(b,a){return this.asExact(b,"NaN",a,false,"\\W")},asId:function(d,c){if(!this._idRE){this._idRE=new RegExp("^\\s*((\"([A-Za-z_][\\w]*)\")(?=\\W|$))|^\\s*(('([A-Za-z_][\\w]*)')(?=\\W|$))","i")}var a=this._idRE.exec(d);if(a){var b=a[0];if(b){return{id:a[3]||a[6],rem:d.substr(b.length)}}}if(c){this.err(d,"Id required",null,"Parser.asId")}return null},asClass:function(h,a,b,d){var g;var c=this.asId(h,false);if(c){try{g=jTAC.create(c.id)}catch(f){this.err(h,f.message)}}else{c=this.asJSon(h,false);if(c){try{g=jTAC.create(null,c.JSon)}catch(f){this.err(h,f.message)}}else{if(a){c=this.asNull(h,false);if(c){return{obj:null,rem:c.rem}}}}}if(g){if(b&&!b(g)){this.err(h,"Unexpected class",null,"Parser.asClass")}return{obj:g,rem:c.rem}}if(d){this.err(h,"Class name expected.",null,"Parser.asClass")}return null}};if(!window.jTAC){throw new Error("window.jTAC not created.")}jTAC._internal.temp._CalcItems_Base={"abstract":true,constructor:function(a){},config:{enabled:true,operator:"+",stopProcessing:false},configrules:{operator:["+","-","*","/"]},canEvaluate:function(){if(!this.getEnabled()){return false}return true},evaluate:function(){this.AM()},collectConnections:function(a){},_cleanupCalcItemInput:jTAC_CleanupCalcItemInput,calcexpr:function(f,j,d){try{jTAC._internal.pushContext();var c=jTAC.CalcItems.Base.prototype;c._checkParser(j);var b,h=null,g="+";if(!c._opRE){c._opRE=new RegExp("^\\s*([\\+\\-\\*/])")}while(b=j.next(f)){f=b.rem;b.obj.operator=g;var a=c._opRE.exec(f);if(a){if(!h){h=jTAC.create("CalcItems.Group")}g=a[1];f=f.substr(a[0].length)}if(h){h.addItem(b.obj)}if(!a){return{ci:h?h:b.obj,rem:f}}}j.err(f,"Invalid calculation expression.",d||this)}finally{jTAC._internal.popContext()}},_checkParser:function(a){if(!a){this._error("Parser script has not been loaded.")}}};jTAC.define("CalcItems.Base",jTAC._internal.temp._CalcItems_Base);function jTAC_CleanupCalcItemInput(b){try{jTAC._internal.pushContext("convert data into CalcItem");if(b==null){return jTAC.create("CalcItems.Null")}if(b instanceof Array){var d=jTAC.create("CalcItems.Group");for(var c=0;c<b.length;c++){d.items.push(b[c])}return d}if(typeof(b)=="number"){return isNaN(b)?jTAC.create("CalcItems.NaN"):jTAC.create("CalcItems.Number",{number:b})}if(b instanceof jTAC.CalcItems.Base){return b}if(typeof(b)=="object"){if(!b.jtacClass){jTAC.error("Must define the CalcItem's class in the 'jtacClass' property of the object that describes a CalcItem.")}return jTAC.create(null,b)}if(typeof(b)=="string"){var a=jTAC.createByClassName(b,null,true);if(a&&a instanceof jTAC.CalcItems.Base){return a}if(b.indexOf("CalcItems.")>-1){jTAC.error("Must load scripts for the class ["+b+"]")}return jTAC.create("CalcItems.Element",{elementId:b})}jTAC.error("Must supply a CalcItem object or an array of CalcItem objects.")}finally{jTAC._internal.popContext()}}jTAC.checkAsCalcItem=function(a){return jTAC_CleanupCalcItemInput(a)};jTAC.checkAsCalcItemOrNull=function(a){if(!a){return null}return jTAC.checkAsCalcItem(a)};jTAC._internal.temp._CalcItems_Null={extend:"CalcItems.Base",constructor:function(a){this.callParent([a])},evaluate:function(){return null},parse:function(b,c){this._checkParser(c);var a=c.asNull(b,false);if(a){return{obj:jTAC.create("CalcItems.Null"),rem:a.rem}}return null}};jTAC.define("CalcItems.Null",jTAC._internal.temp._CalcItems_Null);if(jTAC.parser){jTAC.parser.register("CalcItems.Null")}jTAC._internal.temp._CalcItems_NaN={extend:"CalcItems.Base",constructor:function(a){this.callParent([a])},evaluate:function(){return NaN},parse:function(b,c){this._checkParser(c);var a=c.asNaN(b,false);if(a){return{obj:jTAC.create("CalcItems.NaN"),rem:a.rem}}return null}};jTAC.define("CalcItems.NaN",jTAC._internal.temp._CalcItems_NaN);if(jTAC.parser){jTAC.parser.register("CalcItems.NaN")}jTAC._internal.temp._CalcItems_Number={extend:"CalcItems.Base",constructor:function(a){this.callParent([a])},config:{number:0},configrules:{number:jTAC.checkAsNumber},evaluate:function(){return this.getNumber()},parse:function(b,c){try{this._pushContext();var a=c.asNumber(b,false);if(a){return{obj:jTAC.create("CalcItems.Number",{number:a.number}),rem:a.rem}}return null}finally{this._popContext()}}};jTAC.define("CalcItems.Number",jTAC._internal.temp._CalcItems_Number);if(jTAC.parser){jTAC.parser.register("CalcItems.Number")}jTAC._internal.temp._CalcItems_Element={extend:"CalcItems.Base",require:["CalcItems.Null","CalcItems.NaN","Connections.FormElement","TypeManagers.BaseNumber"],constructor:function(a){this.callParent([a])},config:{datatype:"",typeManager:null,connection:"Connections.FormElement",elementId:null,valueWhenNull:"CalcItems.Null",valueWhenInvalid:"CalcItems.NaN"},configrules:{typeManager:jTAC.checkAsTypeManagerOrNull,connection:jTAC.checkAsConnectionOrNull,valueWhenNull:jTAC.checkAsCalcItem,valueWhenInvalid:jTAC.checkAsCalcItem},canEvaluate:function(){var a=this.getConnection();if(!a||!a.getElement(true)){return false}return this.callParent()},evaluate:function(){try{this._pushContext();var c=this.getConnection();if(c){if(c.isNullValue()){var d=this.getValueWhenNull();if(!d||!d.canEvaluate()){return null}return d.evaluate()}var b=this.getTypeManager();if(!b){b=c.getTypeManager();if(!b){b=jTAC.create("TypeManagers.Float")}this.setTypeManager(b)}try{if(!c.isValidValue(b.storageTypeName())){throw new Error()}var g=b.toValueFromConnection(c);return b.toNumber(g)}catch(f){var a=this.getValueWhenInvalid();if(!a||!a.canEvaluate()){return NaN}return a.evaluate()}}else{return NaN}}finally{this._popContext()}},collectConnections:function(b){var a=this.getConnection();if(a){b.push(a)}},parse:function(d,g){try{this._pushContext();this._checkParser(g);var c,f,a,b;c=g.asId(d);if(c){return{obj:jTAC.create("CalcItems.Element",{elementId:c.id}),rem:c.rem}}c=g.asExact(d,"Element(",false,false,null);if(c){d=c.rem;c=g.asId(d,true);d=c.rem;var f=c.id;c=g.cParen(d,true);d=c.rem;return{obj:jTAC.create("CalcItems.Element",{elementId:f}),rem:d}}return null}finally{this._popContext()}},getDatatype:function(){return this.config.typeManager?this.config.typeManager.dataTypeName():null},setDatatype:function(a){this.setTypeManager(a)},getElementId:function(){var a=this.config.connection;return a&&a.getId?a.getId():null},setElementId:function(c){if(typeof c=="object"){this.setConnnection(c)}else{var b=jTAC.create("Connections.FormElement",{id:c,allowNone:true});var a=jTAC.connectionResolver.create(c,b);this.config.connection=a?a:b}}};jTAC.define("CalcItems.Element",jTAC._internal.temp._CalcItems_Element);if(jTAC.parser){jTAC.parser.register("CalcItems.Element")}jTAC._internal.temp._CalcItems_Group={extend:"CalcItems.Base",require:["CalcItems.NaN","CalcItems.Number","TypeManagers.Float"],constructor:function(a){this.callParent([a])},config:{items:[],valueWhenEmpty:"CalcItems.Number",valueWhenInvalid:"CalcItems.NaN",valueWhenNull:"CalcItems.Number"},configrules:{valueWhenEmpty:jTAC.checkAsCalcItem,valueWhenInvalid:jTAC.checkAsCalcItem,valueWhenNull:jTAC.checkAsCalcItem},canEvaluate:function(){if(!this.getItems().length){return false}return this.callParent()},evaluate:function(){try{this._pushContext();this._cleanupItems();var j=this.getItems();var b=0;var a=jTAC.create("TypeManagers.Float");var g=true;for(var d=0;d<j.length;d++){if(j[d].canEvaluate()){g=false;var c=j[d].evaluate();if(isNaN(c)){var k=this.getValueWhenInvalid();if(!k||!k.canEvaluate()){return NaN}c=k.evaluate();if(isNaN(c)||(c==null)||k.getStopProcessing()){return c}}else{if(c==null){var l=this.getValueWhenNull();if(!l||!l.canEvaluate()){return null}c=l.evaluate();if(isNaN(c)||(c==null)||l.getStopProcessing()){return c}}}if(!d){b=c;continue}var f=1;var m=a.numDecPlaces(c);var h=a.numDecPlaces(b);switch(j[d].getOperator()){case"+":m=Math.max(m,h);b+=c;break;case"-":m=Math.max(m,h);b-=c;break;case"*":m=m+h;b*=c;break;case"/":if(c!=0){b=b/c}else{return NaN}f=0;break}if(f){b=a.round(b,0,m)}}}if(g){var l=this.getValueWhenEmpty();if(!l||!l.canEvaluate()){return null}return l.evaluate()}return b}finally{this._popContext()}},_cleanupItems:function(){var a=this.getItems();var c=null;for(var b=0;b<a.length;b++){var d=a[b];if((typeof d=="string")&&("+-*/".indexOf(d)>-1)){c=d;a.splice(b,1);if(b>=a.length){continue}d=a[b]}d=this._cleanupCalcItemInput(d);a[b]=d;if(c){d.operator=c;c=null}}},addItem:function(b,a){this._cleanupItems();b=this._cleanupCalcItemInput(b);if(a){b.operator=a}this.getItems().push(b)},collectConnections:function(c){this._cleanupItems();var a=this.getItems();for(var b=0;b<a.length;b++){a[b].collectConnections(c)}},parse:function(c,d){try{this._pushContext();this._checkParser(d);var b=d.oParen(c),a;if(b){c=b.rem;b=this.calcexpr(c,d);if(b){c=b.rem;a=b.ci;b=d.cParen(c);if(b){return{obj:a,rem:b.rem}}else{d.err(c,"Missing closing paren.",this)}}}return null}finally{this._popContext()}}};jTAC.define("CalcItems.Group",jTAC._internal.temp._CalcItems_Group);if(jTAC.parser){jTAC.parser.register("CalcItems.Group")}if(jTAC.isDefined("Conditions.Base")){jTAC._internal.temp._CalcItems_Conditional={extend:"CalcItems.Base",require:["CalcItems.Group","Conditions.Base"],constructor:function(a){this.callParent([a]);jTAC.require("Conditions.Base")},config:{condition:null,success:"CalcItems.Group",failed:"CalcItems.Group",cannotEvalMode:"error"},configrules:{condition:jTAC.checkAsCondition,success:jTAC.checkAsCalcItem,failed:jTAC.checkAsCalcItem,cannotEvalMode:["error","zero","success","failed"]},canEvaluate:function(){var a=this.getCondition();if(!a||!a.canEvaluate()){return false}return this.callParent()},evaluate:function(){try{this._pushContext();var a=this.getCondition();if(!a||!a.canEvaluate()){return -1}var c=a.evaluate();if(c==-1){switch(this.getCannotEvalMode()){case"error":return NaN;case"zero":return 0;case"success":c=1;break;case"failed":c=0;break}}var b=c?this.getSuccess():this.getFailed();if(!b||!b.canEvaluate()){return null}return b.evaluate()}finally{this._popContext()}},parse:function(g,b){try{this._pushContext();this._checkParser(b);var a=b.asExact(g,"Condition(",false,false,null),f,k,c,h,d;if(a){g=a.rem;a=b.asJSon(g,true);f=jTAC.create(null,a.JSon);if(!(f instanceof jTAC.Conditions.Base)){b.err(g,"JSon for condition must specify a Condition class",this)}g=a.rem;a=b.asParmDelim(g,true);g=a.rem;a=b.asNull(g);if(!a){a=this.calcexpr(g,b);if(a){k=a.ci}else{b.err(g,"Missing success parameter",this)}}g=a.rem;a=b.asParmDelim(g,false);if(!a||(a.delim=="}")){b.err("Illegal delimiter",this)}g=a.rem;if(a.delim==","){a=b.asNull(g);if(!a){a=this.calcexpr(g,b);if(a){c=a.ci}}if(a){g=a.rem;a=b.asParmDelim(g,false);if(!a||(a.delim=="}")){b.err("Illegal delimiter",this)}g=a.rem;if(a.delim==","){a=b.asId(g,false);if(a){d=a.id}else{a=b.asJSon(g,true);h=a.JSon}g=a.rem;a=b.cParen(g,true);g=a.rem}}}var j=jTAC.create("CalcItems.Conditional");j.condition=f;j.success=k;j.failed=c;if(d!=null){j.cannotEvalMode=d}if(h){j.setProperties(h)}return{obj:j,rem:g}}return null}finally{this._popContext()}}};jTAC.define("CalcItems.Conditional",jTAC._internal.temp._CalcItems_Conditional);if(jTAC.parser){jTAC.parser.register("CalcItems.Conditional")}}jTAC._internal.temp._CalcItems_BaseFunction={extend:"CalcItems.Base","abstract":true,require:["CalcItems.Number","CalcItems.NaN"],constructor:function(a){this.callParent([a])},config:{parms:[],valueWhenInvalid:"CalcItems.NaN",valueWhenNull:"CalcItems.Number"},configrules:{valueWhenInvalid:jTAC.checkAsCalcItem,valueWhenNull:jTAC.checkAsCalcItem},evaluate:function(){try{this._pushContext();this._cleanupParms();var g=this._numParms();var f=[];var d=this.getParms();for(var b=0;b<d.length;b++){if(g&&b>g){break}var j=d[b];var h=null;if(j.canEvaluate()){h=j.evaluate();if(isNaN(h)){var a=this.getValueWhenInvalid();if(!a||!a.canEvaluate()){return NaN}h=a.evaluate();if(isNaN(h)||(h==null)||a.getStopProcessing()){return h}}else{if(h==null){var c=this.getValueWhenNull();if(!c||!c.canEvaluate()){return null}h=c.evaluate();if(isNaN(h)||(h==null)||c.getStopProcessing()){return h}}}f.push(h)}}if(g&&f.length<g){return NaN}if(g==1){f=f[0]}return this._func(f)}finally{this._popContext()}},_func:function(a){this._AM()},_numParms:function(){return 0},_cleanupParms:function(){var b=this.getParms();for(var a=0;a<b.length;a++){b[a]=this._cleanupCalcItemInput(b[a])}},addParm:function(a){this._cleanupParms();a=this._cleanupCalcItemInput(a);this.getParms().push(a)},collectConnections:function(c){this._cleanupParms();var b=this.getParms();for(var a=0;a<b.length;a++){b[a].collectConnections(c)}},parse:function(c,d){try{this._pushContext();this._checkParser(d);var a=d.asExact(c,this._getParseName()+"(",false,false,null);if(!a){var b=this._getParseName2();if(b){a=d.asExact(c,b+"(",false,false,null)}if(!a){return null}}c=a.rem;a=this._getParseParms(c,d);return{obj:this._convertParseParms(a.parms),rem:a.rem}}finally{this._popContext()}},_getParseName:function(){return this.$className},_getParseName2:function(){return null},_numParserParms:function(){return this._numParms()},_getParseParms:function(f,g){var c,b=[],d=this._numParserParms(),a=0;while(true){c=this.calcexpr(f,g);if(!c){g.err(f,"Missing parameter",this)}f=c.rem;b.push(c.ci);c=g.asParmDelim(f,false);if(!c||c.delim=="}"){g.err(f,"parameter missing terminating delimiter",this)}f=c.rem;if(c.delim==")"){return{parms:b,rem:f}}a++;if(d&&(a>=d)){g.err(f,"too many calc expressions",this)}}},_convertParseParms:function(b){var a=jTAC.create(this.$fullClassName);a.setParms(b);return a},setParms:function(a){if(a instanceof Array){this.config.parms=a}else{this.config.parms=[this._cleanupCalcItemInput(a)]}}};jTAC.define("CalcItems.BaseFunction",jTAC._internal.temp._CalcItems_BaseFunction);jTAC._internal.temp._CalcItems_Abs={extend:"CalcItems.BaseFunction",constructor:function(a){this.callParent([a])},_func:function(a){return Math.abs.apply(window,[a])},_numParms:function(){return 1},_getParseName2:function(){return"Math.abs"}};jTAC.define("CalcItems.Abs",jTAC._internal.temp._CalcItems_Abs);if(jTAC.parser){jTAC.parser.register("CalcItems.Abs")}jTAC._internal.temp._CalcItems_Avg={extend:"CalcItems.BaseFunction",constructor:function(a){this.callParent([a])},_func:function(d){var a=d.length;if(!a){return NaN}var c=0;for(var b=0;b<a;b++){c+=d[b]}return c/a}};jTAC.define("CalcItems.Avg",jTAC._internal.temp._CalcItems_Avg);if(jTAC.parser){jTAC.parser.register("CalcItems.Avg")}jTAC._internal.temp._CalcItems_Fix={extend:"CalcItems.BaseFunction",constructor:function(a){this.callParent([a])},_func:function(a){return a},_numParms:function(){return 1},_getParseName:function(){return"Fix"},_numParserParms:function(){return 3},_convertParseParms:function(d){var b,a,c;b=d[0];a=d[1]||null;c=d[2]||null;var f=jTAC.create("CalcItems.Fix");f.setParms([b]);if(a){f.valueWhenNull=a}if(c){f.valueWhenInvalid=c}return f}};jTAC.define("CalcItems.Fix",jTAC._internal.temp._CalcItems_Fix);if(jTAC.parser){jTAC.parser.register("CalcItems.Fix")}jTAC._internal.temp._CalcItems_Max={extend:"CalcItems.BaseFunction",constructor:function(a){this.callParent([a])},_func:function(a){return Math.max.apply(window,a)},_getParseName2:function(){return"Math.max"}};jTAC.define("CalcItems.Max",jTAC._internal.temp._CalcItems_Max);if(jTAC.parser){jTAC.parser.register("CalcItems.Max")}jTAC._internal.temp._CalcItems_Min={extend:"CalcItems.BaseFunction",constructor:function(a){this.callParent([a])},_func:function(a){return Math.min.apply(window,a)},_getParseName2:function(){return"Math.min"}};jTAC.define("CalcItems.Min",jTAC._internal.temp._CalcItems_Min);if(jTAC.parser){jTAC.parser.register("CalcItems.Min")}jTAC._internal.temp._CalcItems_Round={extend:"CalcItems.BaseFunction",require:"TypeManagers.Base",constructor:function(a){this.callParent([a])},config:{roundMode:2,maxDecimalPlaces:3},_func:function(a){try{return jTAC.TypeManagers.Base.prototype.round(a,this.getRoundMode(),this.getMaxDecimalPlaces())}catch(b){return NaN}},_numParms:function(){return 1},parse:function(d,f){this._checkParser(f);var b=f.asExact(d,"Round(");if(b){d=b.rem;return this._parseRound(d,f)}var a,c=0;b=f.asExact(d,"Math.round(");if(b){c=0}else{b=f.asExact(d,"Math.floor(");if(b){c=2}else{b=f.asExact(d,"Math.ceil(");if(b){c=3}else{return null}}}d=b.rem;b=this._getParseParms(d,f);a=jTAC.create("CalcItems.Round");a.setParms(b.parms);a.setRoundMode(c);a.setMaxDecimalPlaces(0);return{obj:a,rem:b.rem}},_parseRound:function(h,c){var k,b=3,f=0,a=this.calcexpr(h,c);if(!a){c.err(h,"Must be an expression.",this)}h=a.rem;k=a.ci;a=c.asParmDelim(h,false);if(!a||a.delim=="}"){c.err(h,"parameter missing terminating delimiter",this)}h=a.rem;if(a.delim==","){var j=/^\s*([01234])/;var d=j.exec(h);if(!d){a=c.asId(h);if(a){h=a.rem;switch(a.id){case"point5":case"round":f=0;break;case"currency":f=1;break;case"truncate":case"floor":f=2;break;case"ceiling":case"ceil":f=3;break;case"nextwhole":f=4;break;default:c.err(h,"Valid values: point5, truncate, currency, ceiling, nextwhole",this)}}else{a=c.asNull(h,true)}h=a.rem}else{f=parseInt(d[1],10);h=h.substr(d[0].length)}a=c.asParmDelim(h,false);if(!a||a.delim=="}"){c.err(h,"parameter missing terminating delimiter",this)}h=a.rem;if(a.delim==","){a=c.asInt(h,false);if(a){b=a.number}else{a=c.asNull(h,true)}h=a.rem;a=c.asParmDelim(h,false);if(!a||a.delim!=")"){c.err(h,"parameter missing terminating delimiter",this)}h=a.rem}}var g=jTAC.create("CalcItems.Round");g.setParms(k);g.setRoundMode(f);g.setMaxDecimalPlaces(b);return{obj:g,rem:h}}};jTAC.define("CalcItems.Round",jTAC._internal.temp._CalcItems_Round);if(jTAC.parser){jTAC.parser.register("CalcItems.Round")}jTAC._internal.temp._CalcItems_UserFunction={extend:"CalcItems.BaseFunction",constructor:function(a){this.callParent([a])},config:{func:null},configrules:{func:jTAC.checkAsFunctionOrNull},canEvaluate:function(){var a=this.getFunc();if(!a){return false}return this.callParent()},_func:function(a){var b=this.getFunc();if(!b){return NaN}return b.call(this,a)},_getParseName:function(){return"Function"},_getParseParms:function(c,d){var b,a=[];b=d.asId();if(!b){d.err(c,"First parameter must be a function name.",this)}a.push(b.id);c=b.rem;b=this.callParent([c]);if(b){a=a.concat(b.parms);c=b.rem}return a},_convertParseParms:function(c){var a=c.shift();var b=this.callParent([c]);b.setFunc(a);return b}};jTAC.define("CalcItems.UserFunction",jTAC._internal.temp._CalcItems_UserFunction);if(jTAC.parser){jTAC.parser.register("CalcItems.UserFunction")}if(!window.jTAC){throw new Error("window.jTAC not created.")}jTAC._internal.temp._Calculations_Widget={require:["Connections.FormElement","TypeManagers.Integer","CalcItems.Null","CalcItems.NaN","CalcItems.Number","CalcItems.Group"],constructor:function(propertyVals){this._internal={events:null,readied:false,eval:false,lastValue:null,lastDisplayTxt:null}},config:{elementId:null,calcItem:"CalcItems.Group",expression:null,displayConnection:null,displayElementId:null,displayTypeManager:null,displayDatatype:null,displayErrorClass:"calcwidget-error",displayNullClass:"calcwidget-null",displayErrorText:"***",displayNullText:"",calcOnInit:true,useChangeEvt:true,useKeyEvt:false},configrules:{elementId:jTAC.checkAsStr,calcItem:jTAC.checkAsCalcItemOrNull,expression:jTAC.checkAsStrOrNull,displayConnection:jTAC.checkAsConnectionOrNull,displayTypeManager:jTAC.checkAsTypeManager},ready:function(){if(this._internal.readied){return}this._internal.readied=true;if(this.getCalcOnInit()){if(this.canEvaluate()){this.evaluate()}}if(this._needsEvts()){var a=[];this.getCalcItem().collectConnections(a);for(var b=0;b<a.length;b++){this._attachEvents(a[b])}}},canEvaluate:function(){return this.getCalcItem().canEvaluate()},evaluate:function(){try{this._pushContext();var intnl=this._internal;if(this._fireEvent("preCalc",null)==false){return null}if(intnl.eval){return null}intnl.eval=true;try{var val=this.getCalcItem().evaluate();this._storeValue(val);this._displayValue(val)}finally{intnl.eval=false}if(val!=intnl.lastValue){this._fireEvent("change",[val])}intnl.lastValue=val;this._fireEvent("postCalc",[val]);return val}finally{this._popContext()}},_storeValue:function(b){var a=this._getHiddenFld();if(b==null){b=""}a.value=isNaN(b)?"NaN":b.toString()},_displayValue:function(c){var b=this.getDisplayConnection();if(!b){return}b.removeClass(this.getDisplayNullClass());b.removeClass(this.getDisplayErrorClass());if(typeof c=="number"){if(isNaN(c)){this._displayError(b)}else{var a=this.getDisplayTypeManager();this._displayNumber(c,b,a)}}else{this._displayNull(b)}},_displayError:function(a){a.setTextValue(this.getDisplayErrorText());a.addClass(this.getDisplayErrorClass())},_displayNull:function(a){a.setTextValue(this.getDisplayNullText());a.addClass(this.getDisplayNullClass())},_displayNumber:function(c,b,a){b.setTextValue(a.toString(c))},_getHiddenFld:function(){try{this._pushContext();var b=this.getElementId();if(!b){this._error("Must assign the elementId property.")}var a=document.getElementById(b);if(!a){a=document.createElement("input");a.id=b;a.name=b;a.type="hidden";if(!document.forms.length){this._error("Must have a <form> tag.")}document.forms[0].appendChild(a)}if(!a.calcWidget){a.calcWidget=this}return a}finally{this._popContext()}},attachEvent:function(b,d){var c=this._internal.events;if(!c){c={};this._internal.events=c}var a=c[b];if(!a){a=[];c[b]=a}a.push(d)},detachEvent:function(b,f){var d=this._internal.events;if(!d){return}var a=d[b];if(a){if(!f){delete d[b]}else{var c=a.indexOf(f);if(c>-1){a.splice(c,1)}}}},_fireEvent:function(c,b){try{this._pushContext();if(!this._internal.events){return}if(typeof b!="object"){b=[b]}var a=this._internal.events[c];if(a){for(var d=0;d<a.length;d++){var f=a[d].apply(this,b);if(f!==undefined){return f}}}}finally{this._popContext()}},_changeEvt:function(a,b){if(this.canEvaluate()){this.evaluate()}},_keyUpEvt:function(a,b){if(!b||(this._internal.lastDisplayTxt==null)){return}if((this._internal.lastDisplayTxt!=b.getTextValue())&&this.canEvaluate()){this.evaluate()}},_keyDnEvt:function(a,b){this._internal.lastDisplayTxt=b?b.getTextValue():null},_needsEvts:function(){return this.getUseChangeEvt()||this.getUseKeyEvt()},_attachEvents:function(b){var a=this;if(this.getUseChangeEvt()){b.addEventListener("onchange",function(c){a._changeEvt.call(a,c,b)})}if(this.getUseKeyEvt()){b.addEventListener("onkeydown",function(c){a._keyDnEvt.call(a,c,b)});b.addEventListener("onkeyup",function(c){a._keyUpEvt.call(a,c,b)})}},setElementId:function(a){this.config.elementId=jTAC.checkAsStr(a);if(a){this._getHiddenFld()}},setExpression:function(b){try{this._pushContext(null,b!=null?b.toString():"");var c=jTAC.parser;if(!c){this._error("Must load Parser.js")}var a=jTAC.CalcItems.Base.prototype.calcexpr(jTAC.checkAsStr(b),c,this);if(!a){c.err(b,"syntax error",this)}this.setCalcItem(a.ci);this.config.expression=b}finally{this._popContext()}},getDisplayElementId:function(){var a=this.getDisplayConnection();return a&&a.getId?a.getId():null},setDisplayElementId:function(c){var b=jTAC.create("Connections.FormElement",{id:c,allowNone:true});var a=jTAC.connectionResolver.create(c,b);this.config.displayConnection=a?a:b},getDisplayTypeManager:function(){try{this._pushContext();if(!this.config.displayTypeManager){var a;var b=this.getDisplayConnection();if(b){a=b.getTypeManager()}if(!a){a=jTAC.create("TypeManagers.Float")}this.config.displayTypeManager=a}return this.config.displayTypeManager}finally{this._popContext()}},getDisplayDatatype:function(){return this.config.displayTypeManager?this.config.displayTypeManager.dataTypeName():null},setDisplayDatatype:function(a){this.setDisplayTypeManager(a)}};jTAC.define("Calculations.Widget",jTAC._internal.temp._Calculations_Widget);jTAC._internal.temp._CalcItems_WidgetConnection={extend:"Connections.BaseElement",require:["Calculations.Widget"],constructor:function(a){this.callParent([a])},_getCalcWidget:function(){var a=this.getElement(true);if(this._checkElement(a)){return a.calcWidget}return null},getTextValue:function(){var a=this._getCalcWidget();if(a&&a.canEvaluate()){var b=a.evaluate();if((b!=null)&&!isNaN(b)){return a.getDisplayTypeManager().toString(b)}}},setTextValue:function(a){},typeSupported:function(a){return(a=="integer")||(a=="float")},getTypedValue:function(b){if(!b||this.typeSupported(b)){var a=this._getCalcWidget();if(a&&a.canEvaluate()){var c=a.evaluate();if((b=="integer")&&(Math.floor(c)!=c)){return null}return c}}return null},setTypedValue:function(a){},isNullValue:function(b){var a=this._getCalcWidget();if(a&&a.canEvaluate()){var c=a.evaluate();return c==null}return false},isEditable:function(){return false},testElement:function(a){if(typeof(a)=="string"){a=document.getElementById(a)}return this._checkElement(a)},_checkElement:function(a){if(a&&a.calcWidget){return true}return false},isEnabled:function(){return true},isVisible:function(){var a=this._getCalcWidget();if(a&&a.getDisplayConnection()){return a.getDisplayConnection().isVisible()}return false},isEditable:function(){return true},collectConnections:function(b){var a=this._getCalcWidget();if(a){a.getCalcItem().collectConnections(b)}},addEventListener:function(b,c,d){if(b=="onchange"){var a=this._getCalcWidget();if(a){a.attachEvent("change",c);return true}}return false},getClass:function(){var a=this._getCalcWidget();if(a){var b=a.getDisplayConnection();if(b){return b.getClass()}}return""},setClass:function(b){var a=this._getCalcWidget();if(a){var c=a.getDisplayConnection();if(c){c.setClass(b)}}}};jTAC.define("CalcItems.WidgetConnection",jTAC._internal.temp._CalcItems_WidgetConnection);jTAC.connectionResolver.register("CalcItems.WidgetConnection");jTAC._internal.temp._Connections_InnerHtml={extend:"Connections.BaseElement",constructor:function(a){this.callParent([a])},getTextValue:function(){var a=this.getElement();if(this._checkElement(a)){return a.innerHTML}return""},setTextValue:function(b){var a=this.getElement();if(this._checkElement(a)){a.innerHTML=b}},typeSupported:function(a){return false},isNullValue:function(a){return false},isEditable:function(){return false},testElement:function(a){if(typeof(a)=="string"){a=document.getElementById(a)}return this._checkElement(a)},_checkElement:function(a){if(a&&(typeof(a)=="object")&&(a.tagName!==undefined)&&(a.innerHTML!==undefined)&&(a.form===undefined)){if(typeof a.innerHTML=="string"){return true}}return false},isEnabled:function(){return true},isEditable:function(){return false}};jTAC.define("Connections.InnerHtml",jTAC._internal.temp._Connections_InnerHtml);if(jTAC.connectionResolver){jTAC.connectionResolver.register("Connections.InnerHtml")}(function(b){var a={_calcWidget:null,options:new jTAC_CalculatorOptions(),_create:function(){if(!window.jTAC){throw new Error("window.jTAC not created.")}jTAC.require(["CalcItems.Base","Calculations.Widget","TypeManagers.Float"]);var d=this;var c=jTAC.create("Calculations.Widget");d._calcWidget=c;c.elementId=d.element.get()[0].id;c.attachEvent("preCalc",function(){return d._trigger("preCalc",null,{})});c.attachEvent("postCalc",function(f){return d._trigger("postCalc",null,{value:f})});c.attachEvent("change",function(f){d._trigger("change",null,{value:f})})},_init:function(){try{jTAC._internal.pushContext("calculator._init()");var f=this;var h=this.options;this._convertEvent("preCalc");this._convertEvent("postCalc");this._convertEvent("change");var c=this._calcWidget;for(var d in h){var g=h[d];if((g!=null)&&(c[d]!==undefined)&&(typeof(g)!="function")){c[d]=g}}c.ready()}finally{jTAC._internal.popContext()}},_convertEvent:function(d){var c=this.options[d];if(c){if(typeof c=="string"){c=window[c];if(!c){jTAC.warn("Calculator ["+this.element.get()[0].id+"] options include ["+d+"]. This must be a globally defined function name to be used.");c=null}this.options[d]=c}}},_setOption:function(d,f){b.Widget.prototype._setOption.apply(this,arguments);var c=this._calcWidget;switch(d){case"calcItem":c.calcItem=f;if(c.calcOnInit&&c.canEvaluate()){c.evaluate()}break;case"calcOnInit":if(f){if(c.canEvaluate()){c.evaluate()}}break;case"displayErrorClass":c.displayErrorClass=f;break;case"displayNullClass":c.displayNullClass=f;break;case"displayErrorText":c.displayErrorText=f;break;case"displayNullText":c.displayNullText=f;break;case"preCalc":case"postCalc":case"change":this._convertEvent(d);break;default:}}};b.widget("ui.calculator",a)})(jQuery);function jTAC_CalculatorOptions(){}jTAC_CalculatorOptions.prototype={calcItem:null,expression:null,calcOnInit:null,useChangeEvt:null,useKeyEvt:null,displayConnection:null,displayElementId:null,displayTypeManager:null,displayDatatype:null,displayErrorClass:null,displayNullClass:null,displayErrorText:null,displayNullText:null,preCalc:null,postCalc:null,change:null};(function($){function applyOne(idx,element){element=$(element);var options=element.data("jtac-calculator");if(options){element.data("calculator",null);try{if(typeof options=="string"){options=window.eval("("+options+");")}element.calculator(options)}catch(e){jTAC.error("Could not parse the data-jtac-calculator attribute of id ["+element.get()[0].id+"] Error info:"+e.toString())}}}function apply(){try{jTAC._internal.pushContext("calculator-unobtrusive.apply()");var elements=$("input[type=hidden]");elements.each(applyOne)}finally{jTAC._internal.popContext()}}if(!window.jTAC_CalculatorOptions){jTAC.error("Requires the calculator scripts.")}$(document).ready(apply)})(jQuery);(function($){var datatypeeditor={options:new jTAC_DataTypeEditorOptions(),_create:function(){if(!window.jTAC){throw new Error("window.jTAC not created.")}jTAC.require(["Connections.FormElement","TypeManagers.Base"])},_init:function(){try{jTAC._internal.pushContext("datatypeeditor._init()");var tm=this._resolveTypeManager();if(!tm){return}this._tm=tm;var nElement=$("#"+this.element[0].id+"_neutral");if(nElement.length){this._nElement=nElement;this._initValue(tm,nElement,this.element)}var o=this.options;this._prepCommandKeys(o,tm);this._prepDefaultKeyResult(o);var passThruKey=false;var that=this;this.element.keypress(function(evt){if(passThruKey||(evt.which==0)){return true}var chr=String.fromCharCode(evt.which);var val=tm.isValidChar(chr);if(!val){if(that._cmdKeys.length){if(that._invokeCommand(evt)){if(o.keyResult){o.keyResult(that.element,evt,"command",o)}evt.preventDefault();evt.stopPropagation();return false}}if(o.filterkeys||(o.filterkeys===undefined)){var kc=evt.which||evt.keyCode;if(that._validKeyCodes.indexOf(kc)==-1){if(o.keyResult){o.keyResult(that.element,evt,"invalid",o)}evt.preventDefault();evt.stopPropagation();return false}}}if(o.keyResult){o.keyResult(that.element,evt,"valid",o)}return true});this._validKeyCodes=[13,27,9,8];if(this._cmdKeys.length){this.element.keydown(function(evt){passThruKey=false;if(that._invokeCommand(evt)){if(o.keyResult){o.keyResult(that.element,evt,"command",o)}evt.preventDefault();evt.stopPropagation();passThruKey=true;return false}else{return true}})}this.element.change(function(evt){if(o.reformat||(o.reformat===undefined)){that._reformat(tm)}});if(o.checkPastes||(o.checkPastes==undefined)){this._installonpaste(tm)}}finally{jTAC._internal.popContext()}},_resolveTypeManager:function(){try{jTAC._internal.pushContext("datatypeeditor._resolveTypeManager()");var o=this.options;var tm=o.typeManager||this.element.data("jtac-typemanager");if(tm){if(typeof tm=="string"){try{tm=eval("("+tm+");")}catch(e){jTAC.warn("JSon parsing error. "+e.message)}}if(tm.jtacClass){tm=jTAC.create(null,tm)}if(tm instanceof jTAC.TypeManagers.Base){return tm}}var dt=o.datatype||this.element.data("jtac-datatype");if(dt){if(o.datatype){this.element.data("jtac-datatype",o.datatype)}tm=jTAC.create(dt,tm);if(tm instanceof jTAC.TypeManagers.Base){return tm}}jTAC.warn("Specify the TypeManager. Use data-jtac-datatype='[name]' in the input field id=["+this.element[0].id+"].");return null}finally{jTAC._internal.popContext()}},_reformat:function(tm){try{jTAC._internal.pushContext("datatypeeditor._reformat()");try{var val=tm.toValue(this.element.val());this.element.val(tm.toString(val));if(this._nElement!=null){this._nElement.val(tm.toStringNeutral(val))}}catch(e){}}finally{jTAC._internal.popContext()}},_initValue:function(tm,neutralElement,visibleElement){var visVal=visibleElement.val();var neuVal=neutralElement.val();var initFromNeutral=this.options.initFromNeutral;if((visVal=="")||initFromNeutral||(initFromNeutral===undefined)){try{var n=tm.toValueNeutral(neuVal);if(n!=null){visibleElement.val(tm.toString(n))}}catch(e){jTAC.warn("Converting neutral value in "+visibleElement.id+" error: "+e.message)}}},_installonpaste:function(tm){function notify(){jTAC.warn("Paste was blocked.")}var el=this.element[0];if(!el||(el.onpaste===undefined)){return}el.onpaste=function(e){var text=undefined;if(window.clipboardData&&window.clipboardData.getData){text=window.clipboardData.getData("Text");if(text==null){notify();return false}}else{if(e.clipboardData&&e.clipboardData.getData){text=e.clipboardData.getData("text/plain");if(text==null){notify();return false}}}if(text){for(var i=0;i<text.length;i++){if(!tm.isValidChar(text.charAt(i))){notify();return false}}}return true}},_prepCommandKeys:function(opt,tm){this._cmdKeys=[];if(tm.invoke){if(tm.getCommandKeys){this._cmdKeys=tm.getCommandKeys()}if(opt.commandKeys){for(var i=0;i<opt.commandKeys.length;i++){var ck=opt.commandKeys[i];switch(ck.action){case"clear":this._cmdKeys=[];break;case"remove":for(var j=0;j<this._cmdKeys.length;j++){var old=this._cmdKeys[j];if(old.commandName==ck.commandName){if((ck.keyCode=="*")||((old.keyCode===ck.keyCode)&&(old.ctrl==ck.ctrl)&&(old.shift==old.shift))){this._cmdKeys.splice(j,1);break}}}break;default:this._cmdKeys.push(ck);break}}}}},_invokeCommand:function(evt){try{jTAC._internal.pushContext("datatypeeditor._invokeCommand()");var cmdName=null;var fnc=this.options.getCommandName;if(fnc){if(typeof fnc=="string"){if(window[fnc]==undefined){jTAC.warn("Could not find the function ["+fnc+"] globally defined.")}fnc=this.options.getCommandName=window[fnc]}cmdName=fnc.call(this,evt,this._cmdKeys,this._tm)}if(cmdName==""){return false}if(!cmdName){cmdName=this._getCommandName(this._cmdKeys,evt)}if(cmdName){var conn=this._conn;if(!conn){this._conn=conn=jTAC.connectionResolver.create(evt.currentTarget.id)}var args={commandName:cmdName,connection:conn};this._tm.invoke(args);return true}return false}finally{jTAC._internal.popContext()}},_getCommandName:function(cmdMap,evt){var keyCode=evt.keyCode,ctrl=evt.ctrlKey,shift=evt.shiftKey;if((keyCode==16)||(keyCode==17)){return false}for(var i=0;i<cmdMap.length;i++){var info=cmdMap[i];if((info.keyCode==keyCode)&&(!!info.ctrl==ctrl)&&(!!info.shift==shift)){return info.commandName}}if((evt.type!="keydown")||(keyCode<33)||((keyCode<91)&&(keyCode>47))){var keyChar=String.fromCharCode(keyCode);var keyCharUC=keyChar.toUpperCase();var useShift=false;if((keyCode<65)||(keyCode>90)){useShift=true}for(var i=0;i<cmdMap.length;i++){var info=cmdMap[i];if(typeof(info.keyCode)=="number"){continue}if(useShift&&(!!info.shift!=shift)){continue}if(!!info.ctrl!=ctrl){continue}if((info.keyCode==keyChar)||(info.keyCode.toUpperCase()==keyCharUC)){return info.commandName}}}return false},_prepDefaultKeyResult:function(options){if(options.keyResult===undefined){options.keyResult=jTAC_DefaultKeyResult}else{if(typeof options.keyResult=="string"){if(window[options.keyResult]){options.keyResult=window[options.keyResult]}else{jTAC.warn("Could not find the function ["+options.keyResult+"] globally defined.")}}}if(options.keyErrorClass===undefined){options.keyErrorClass="key-error"}if(options.keyErrorTime==undefined){options.keyErrorTime=200}},_setOption:function(key,value){$.Widget.prototype._setOption.apply(this,arguments)}};$.widget("ui.dataTypeEditor",datatypeeditor)})(jQuery);function jTAC_DefaultKeyResult(d,b,a,c){function f(){if(c.keyErrorIntervalID){d.removeClass(c.keyErrorClass);window.clearInterval(c.keyErrorIntervalID);c.keyErrorIntervalID=null}}if(!c.keyErrorClass){return}f();if(a=="invalid"){d.addClass(c.keyErrorClass);c.keyErrorIntervalID=window.setTimeout(f,c.keyErrorTime)}}function jTAC_DataTypeEditorOptions(){}jTAC_DataTypeEditorOptions.prototype={datatype:null,typeManager:null,reformat:true,initFromNeutral:true,filterkeys:true,checkPastes:true,commandKeys:null,getCommandName:null,keyResult:jTAC_DefaultKeyResult,keyErrorClass:"key-error",keyErrorTime:200};function jTAC_StdDateCmds(b,a){if(a){b.push({commandName:"Today",keyCode:"t"},{commandName:"Today",keyCode:"t",ctrl:true})}b.push({commandName:"NextDay",keyCode:38},{commandName:"PrevDay",keyCode:40},{commandName:"NextMonth",keyCode:33},{commandName:"PrevMonth",keyCode:34},{commandName:"NextMonth",keyCode:38,ctrl:true},{commandName:"PrevMonth",keyCode:40,ctrl:true},{commandName:"NextYear",keyCode:36},{commandName:"PrevYear",keyCode:35});return b}function jTAC_StdTimeCmds(b,a){if(a){b.push({commandName:"Now",keyCode:"N",ctrl:true})}b.push({commandName:"NextMinutes",keyCode:38},{commandName:"PrevMinutes",keyCode:40},{commandName:"NextHours",keyCode:33},{commandName:"PrevHours",keyCode:34},{commandName:"NextHours",keyCode:38,ctrl:true},{commandName:"PrevHours",keyCode:40,ctrl:true});return b}if(jTAC.isDefined("TypeManagers.BaseDate")){jTAC_Temp={getCommandKeys:function(){return jTAC_StdDateCmds([],true)}};jTAC.addMembers("TypeManagers.BaseDate",jTAC_Temp)}if(jTAC.isDefined("TypeManagers.TimeOfDay")){jTAC_Temp={getCommandKeys:function(){return jTAC_StdTimeCmds([],true)}};jTAC.addMembers("TypeManagers.TimeOfDay",jTAC_Temp)}if(jTAC.isDefined("TypeManagers.Duration")){jTAC_Temp={getCommandKeys:function(){return jTAC_StdTimeCmds([],false)}};jTAC.addMembers("TypeManagers.Duration",jTAC_Temp)}if(jTAC.isDefined("TypeManagers.DateTime")){jTAC_Temp={getCommandKeys:function(){var a=[{commandName:"Now",keyCode:"N",ctrl:true}];return jTAC_StdDateCmds(a,true)}};jTAC.addMembers("TypeManagers.DateTime",jTAC_Temp)}function jTAC_StdNumberCmds(b,a){b.push({commandName:"NextBy1",keyCode:38},{commandName:"PrevBy1",keyCode:40});if(a){b.push({commandName:"NextByPt1",keyCode:38,ctrl:true},{commandName:"PrevByPt1",keyCode:40,ctrl:true})}return b}if(jTAC.isDefined("TypeManagers.BaseFloat")){jTAC_Temp={getCommandKeys:function(){return jTAC_StdNumberCmds([],true)}};jTAC.addMembers("TypeManagers.BaseFloat",jTAC_Temp)}if(jTAC.isDefined("TypeManagers.Integer")){jTAC_Temp={getCommandKeys:function(){return jTAC_StdNumberCmds([],false)}};jTAC.addMembers("TypeManagers.Integer",jTAC_Temp)}(function(b){var a={options:new jTAC_DataTypeEditorOptions(),_create:function(){if(!window.jTAC){throw new Error("window.jTAC not created.")}jTAC.require("Connections.FormElement","TypeManagers.Date");if(!window.jTAC_DataTypeEditorOptions){jTAC.error("Requires the datatypeeditor scripts.")}},_init:function(){try{jTAC._internal.pushContext("datetextbox._init()");var h=this;var d=this.element[0];if(!this.options.datatype&&!this.element.data("jtac-datatype")){this.options.datatype="TypeManagers.Date"}if(!b.data(d,"jtac-datatype")){d.setAttribute("data-jtac-datatype",this.options.datatype)}if(!this.options.getCommandName){this.options.getCommandName=function(l,m,k){if(b.datepicker._datepickerShowing){return h._getCommandName(l,m,k)}return null}}this.element.dataTypeEditor(this.options);var g=b.data(d,"dataTypeEditor");if(!g){return}var c=g._tm;if(!c||(c.dataTypeName()!="date")){return}this._dte=g;this._tm=c;if(c.installCmd){c.installCmd({commandName:"Calendar",func:function(k){return h._popup.call(h,k)},ignoreCurrent:true})}var f=this.options.datepicker||{};f.constrainInput=false;if(!f.dateFormat){f.dateFormat=this._convertDatePattern(c._datePattern())}f.dayNames=c.dateTimeFormat("Days");f.dayNamesMin=c.dateTimeFormat("DaysShort");f.dayNamesShort=c.dateTimeFormat("DaysAbbr");f.monthNames=c.dateTimeFormat("Months");f.monthNamesShort=c.dateTimeFormat("MonthsAbbr");if(!f.minDate&&c.getMinValue&&c.getMinValue()){f.minDate=c.getMinValue}if(!f.maxDate&&c.getMaxValue&&c.getMaxValue()){f.maxDate=c.getMaxValue}if(!f.showOn){f.showOn="button"}this._prepAutoButton(this.options);this.element.datepicker(f);var j=b.data(d,"datepicker");this._finishAutoButton(j,this.options);b(document).ready(function(){if(b.validator){var k=b.data(d.form,"validator");if(k&&k.settings){var l=k.settings.ignore||"";if(l instanceof Array){if(l.length){k.settings.ignore.push(".ui-datepicker-trigger")}else{l=""}}if(typeof l=="string"){k.settings.ignore=(l?l+",":"")+".ui-datepicker-trigger"}}}})}finally{jTAC._internal.popContext()}},_convertDatePattern:function(c){if(c.indexOf("MMMM")>-1){c=c.replace("MMMM","MM")}else{if(c.indexOf("MMM")>-1){c=c.replace("MMM","M")}else{if(c.indexOf("MM")>-1){c=c.replace("MM","mm")}else{if(c.indexOf("M")>-1){c=c.replace("M","m")}}}}if(c.indexOf("yyyy")>-1){c=c.replace("yyyy","yy")}else{if(c.indexOf("yy")>-1){c=c.replace("yy","yy")}}return c},_getCommandName:function(d,f,c){switch(d.keyCode){case 37:case 38:case 39:case 40:case 35:case 36:return d.ctrlKey?"":null;case 27:case 13:case 33:case 34:return !d.ctrlKey?"":null}return null},_prepAutoButton:function(c){var d=c.datepicker;if(!d.buttonImage||d.buttonImage.toLowerCase().indexOf("spacer.gif")==-1){return}if(d.showOn=="focus"){return}c.autoButton=true;if(d.buttonImageOnly==null){d.buttonImageOnly=true}if(d.buttonText==null){d.buttonText="Open"}},_finishAutoButton:function(l,d){if(!d.autoButton){return}var g=window.document.styleSheets;if(!g){return}var k="ui-datepicker-trigger-pressed";for(var c=0;c<g.length;c++){var h=g[c];var j=h.cssRules?h.cssRules:h.rules;for(var f=0;f<j.length;f++){if(j[f].selectorText&&j[f].selectorText.toLowerCase()=="."+k){l.trigger.mousedown(function(m){l.trigger.addClass(k)});l.trigger.mouseup(function(m){l.trigger.removeClass(k)});l.trigger.mouseout(function(m){l.trigger.removeClass(k)});return}}}},_popup:function(c){this.element.datepicker("show");return false},_setOption:function(c,d){b.Widget.prototype._setOption.apply(this,arguments)}};b.widget("ui.dateTextBox",a)})(jQuery);if(jTAC.isDefined("TypeManagers.BaseDate")){var jTAC_DateCmds=jTAC.TypeManagers.BaseDate.prototype.getCommandKeys();jTAC_DateCmds.push({commandName:"Calendar",keyCode:13,ctrl:true});jTAC.TypeManagers.BaseDate.prototype.getCommandKeys=function(){return jTAC_DateCmds}}jTAC_Temp={config:{minValue:null,maxValue:null},invoke:function(c){var b=this._internal;var a=b.cmds;if(!a){b.cmds=a=[];this._initCmds()}else{if(b.needsCmds){this._initCmds();b.needsCmds=false}}c.changed=false;c.error=false;c.value=null;for(var d=0;d<a.length;d++){var g=a[d];if(g.commandName==c.commandName){if(!g.ignoreCurrent){try{c.value=this.toValueFromConnection(c.connection)}catch(f){if(!g.ignoreError){c.error=true;return}}}if(c.precmd){if(!c.precmd(c)||c.error){return}}if(!c.settings){c.settings=g}if(g.func.call(this,c)){c.changed=true;if(c.postcmd){if(!c.postcmd(c)||c.error){return}}c.connection.setTextValue(this.toString(c.value))}return}}},installCmd:function(c,f){var b=this._internal;var a=b.cmds;if(!a){b.cmds=a=[];b.needsCmds=true}if(!c.func){this._error("args.func not assigned.")}if(f){for(var d=0;d<a.length;d++){if(a[d].commandName==c.commandName){a[d]=c;return}}}a.push(c)},installValueCmd:function(c,b,a){this.installCmd({commandName:c,func:this.setValueCmd,value:b,ignoreCurrent:true},a)},getCmd:function(d){var b=this._internal;var a=b.cmds;if(!a){b.cmds=a=[];this._initCmds()}else{if(b.needsCmds){this._initCmds();b.needsCmds=false}}for(var c=0;c<a.length;c++){if(a[c].commandName==d){return a[c]}}return null},_initCmds:function(){},clearCmd:function(a){a.value=null;return true},setValueCmd:function(b){var a=this._internal.cmds;for(var c=0;c<a.length;c++){var d=a[c];if(d.commandName==b.commandName){b.value=d.value;return true}}return false},_inRange:function(b){var a=this.getMinValue();if((a!=null)&&(this.compare(b,a)<0)){return false}a=this.getMaxValue();if((a!=null)&&(this.compare(b,a)>0)){return false}return true},_adjustForRange:function(b){var a=this.getMinValue();if((a!=null)&&(this.compare(b,a)<0)){return a}a=this.getMaxValue();if((a!=null)&&(this.compare(b,a)>0)){return a}return b},setMinValue:function(a){this.config.minValue=(typeof a=="string")?this.toValueNeutral(a):this.toValue(a)},setMaxValue:function(a){this.config.maxValue=(typeof a=="string")?this.toValueNeutral(a):this.toValue(a)}};jTAC.addMembers("TypeManagers.Base",jTAC_Temp);if(jTAC.isDefined("TypeManagers.BaseDatesAndTimes")){jTAC_Temp={config:{blankStartsAt:null},_initCmds:function(){if(this.supportsDates()){this.installCmd({commandName:"NextDay",func:this.addDays,days:1});this.installCmd({commandName:"PrevDay",func:this.addDays,days:-1});this.installCmd({commandName:"NextMonth",func:this.addMonths,months:1});this.installCmd({commandName:"PrevMonth",func:this.addMonths,months:-1});this.installCmd({commandName:"NextYear",func:this.addMonths,months:12});this.installCmd({commandName:"PrevYear",func:this.addMonths,months:-12});this.installCmd({commandName:"Today",func:this.todayCmd,ignoreCurrent:true})}if(this.supportsTimes()){this.installCmd({commandName:"NextSeconds",func:this.addSeconds,seconds:1,roundBy:0});this.installCmd({commandName:"PrevSeconds",func:this.addSeconds,seconds:-1,roundBy:0});this.installCmd({commandName:"NextMinutes",func:this.addSeconds,seconds:60});this.installCmd({commandName:"PrevMinutes",func:this.addSeconds,seconds:-60});this.installCmd({commandName:"NextHours",func:this.addSeconds,seconds:3600});this.installCmd({commandName:"PrevHours",func:this.addSeconds,seconds:-3600});this.installCmd({commandName:"Now",func:this.nowCmd,ignoreCurrent:true})}this.installCmd({commandName:"Clear",func:this.clearCmd,ignoreCurrent:true})},addDays:function(c){var f=c.settings.days||1;var g=c.value;var b=g;if(!b){this._adjustBlank(c,f>0);c.value=this._adjustForRange(c.value);return true}if(!this.getUseUTC()){b=this.asUTCDate(b)}var d=b.valueOf()+(f*86400000);var a=new Date(d);if(!this.getUseUTC()){a=this._asLocalDate(a)}a=this._adjustForRange(a);c.value=a;return a.valueOf()!=g.valueOf()},addMonths:function(f){var g=f.settings.months||1;var k=f.value;var c=k;if(!c){this._adjustBlank(f,g>0);f.value=this._adjustForRange(f.value);return true}if(!this.getUseUTC()){c=this.asUTCDate(c)}var b=c.getUTCMonth(),j=c.getUTCFullYear(),h=c.getUTCDate(),a=null;if(g>0){b=b+g;j=j+Math.round((b/12)-0.5);b=b%12}else{b=11-b;b=b-g;j=j-Math.round((b/12)-0.5);b=11-(b%12)}do{a=this.asUTCDate(j,b,h);h--}while(a.getUTCMonth()!=b);if(!this.getUseUTC()){a=this._asLocalDate(a)}a=this._adjustForRange(a);f.value=a;return a.valueOf()!=k.valueOf()},_asLocalDate:function(a){return new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds())},todayCmd:function(b){var a=new Date();a=this.getUseUTC()?this.asUTCDate(a.getFullYear(),a.getMonth(),a.getDate()):new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0);b.value=a;return true},_adjustBlank:function(b,f){var d=this.getBlankStartsAt();var c=this.supportsDates();var g=this.supportsTimes();if(d==="Now"){if(g){this.nowCmd(b)}else{this.todayCmd(b)}}else{if((d instanceof Date)||(typeof(d)=="number")){b.value=d}else{var a=f?this.getMinValue():this.getMaxValue();if(a!=null){b.value=a}else{if(g){this.nowCmd(b)}else{this.todayCmd(b)}}}}},addSeconds:function(h){function n(u,r){var q=k.roundBy;if(q){var t=typeof(u)=="number";if(!t){u=g._dateToSeconds(u,b)}var p=Math.floor(u%q);if(p){u=u-p+(r?q:0)}if(!t){u=g._secondsToDate(u,b)}}return u}var o;var k=h.settings;if(k.roundBy===undefined){k.roundBy=60}if(k.nextMin==undefined){k.nextMin=58}var m=k.seconds||1;var d=m>0;var b=this.getUseUTC();var l=h.value;var c=l;var g=this;if(c==null){this._adjustBlank(h,d);if(k.roundBy){h.value=n(h.value,d)}h.value=this._adjustForRange(h.value);return true}if(c instanceof Date){c=this._dateToSeconds(c,b)}var j=c;if(!d&&k.nextMin&&k.roundBy&&(k.roundBy<Math.abs(m))){o=Math.floor(j%60);if(k.nextMin<o){j=j+(60-o)}}if(Math.floor(j%k.roundBy)){j=n(c,d)}else{j=n(j+m,d)}if(j<0){j=0}if(l instanceof Date){j=this._secondsToDate(j,b)}var a=this._adjustForRange(j);var f=this.compare(j,a);if(f<0){j=n(a,true)}else{if(f>0){j=n(a,false)}}h.value=j;return this.compare(l,j)!=0},nowCmd:function(b){if(b.now!=null){b.value=b.now;return true}var a=new Date();if(this._nativeTypeName=="number"){a=this._dateToSeconds(a,false)}else{if(this.getUseUTC()){a=this.asUTCDate(a)}}b.value=a;return true},_dateToSeconds:function(b,a){if(a){return b.getUTCHours()*3600+b.getUTCMinutes()*60+b.getUTCSeconds()}return b.getHours()*3600+b.getMinutes()*60+b.getSeconds()},_secondsToDate:function(f,b){if(f>=24*3600){f=24*3600-1}else{if(f<0){f=0}}var d=Math.floor(f/3600);var a=Math.floor((f%3600)/60);var c=Math.floor(f%60);f=new Date();f.setHours(d,a,c,0);if(b){f=jTAC.TypeManagers.Base.prototype.asUTCDate(f)}return f},getMinValue:function(){if(this.config.minValue==null){if(!this.supportsDates()&&this.supportsTimes()){if(this.nativeTypeName()=="number"){return 0}var a=new Date();a.setHours(0,0,0,0);if(this.getUseUTC()){a=this.asUTCDate(a)}return a}}return this.config.minValue},getMaxValue:function(){if(this.config.maxValue==null){if(!this.supportsDates()&&this.supportsTimes()){var b=23;if(this.getMaxHours&&(this.getMaxHours()!=null)){b=this.getMaxHours()}if(this.nativeTypeName()=="number"){return(b+1)*3600-1}var a=new Date();if(b>23){b=23}a.setHours(b,59,59,0);if(this.getUseUTC()){a=this.asUTCDate(a)}return a}}return this.config.maxValue},setBlankStartsAt:function(b){if((typeof b=="string")&&(b!="Now")&&(b!="")){if(/^\d*$/.test(b)){b=parseInt(b,10)}else{var a=/^(\d+)\-(\d+)\-(\d+)( (\d+)\:(\d+)\:(\d+))?$/.exec(b);if(!a){this._error("Illegal value in BlankStartsAt")}b=new Date(a[1],parseInt(a[2],10)-1,a[3]);if(a[4]!=null){b.setHours(a[5],a[6],a[7])}if(!b){this._error("Illegal date in BlankStartsAt")}}}this.config.blankStartsAt=b}};jTAC.addMembers("TypeManagers.BaseDatesAndTimes",jTAC_Temp)}if(jTAC.isDefined("TypeManagers.BaseNumber")){jTAC_Temp={_initCmds:function(){this.installCmd({commandName:"PrevBy1",func:this.addBy,inc:-1});this.installCmd({commandName:"NextBy1",func:this.addBy,inc:1});this.installCmd({commandName:"PrevBy10",func:this.addBy,inc:-10});this.installCmd({commandName:"NextBy10",func:this.addBy,inc:10});this.installCmd({commandName:"PrevBy100",func:this.addBy,inc:-100});this.installCmd({commandName:"NextBy100",func:this.addBy,inc:100});this.installCmd({commandName:"PrevBy1000",func:this.addBy,inc:-1000});this.installCmd({commandName:"NextBy1000",func:this.addBy,inc:1000});if(this.getMaxDecimalPlaces()!=0){this.installCmd({commandName:"PrevByPt1",func:this.addBy,inc:-0.1});this.installCmd({commandName:"NextByPt1",func:this.addBy,inc:0.1});this.installCmd({commandName:"PrevByPt01",func:this.addBy,inc:-0.01});this.installCmd({commandName:"NextByPt01",func:this.addBy,inc:0.01})}this.installCmd({commandName:"Clear",func:this.clearCmd,ignoreCurrent:true})},addBy:function(b){var d=b.settings.inc||1;var g=b.value;var f=g;if(f==null){this._adjustBlank(b,d>0);b.value=this._adjustForRange(b.value);return true}if(this.numDecPlaces){var a=this.numDecPlaces(d);var c=this.numDecPlaces(f);f=this.round(f+d,0,Math.max(a,c))}else{f=f+d}f=this._adjustForRange(f);b.value=f;return f!=g},_adjustBlank:function(b,c){var a=c?this.getMinValue():this.getMaxValue();b.value=(a!=null)?a:0},getMinValue:function(){if(this.config.minValue==null){if(!this.getAllowNegatives()){return 0}}return this.config.minValue}};jTAC.addMembers("TypeManagers.BaseNumber",jTAC_Temp)}(function($){function applyOne(idx,element){element=$(element);var options=element.data("jtac-datatypeeditor");if(options!=null){element.data("datatypeeditor",null);try{if(options){if(typeof options=="string"){options=window.eval("("+options+");")}element.dataTypeEditor(options)}else{element.dataTypeEditor()}}catch(e){jTAC.error("Could not parse the data-jtac-datatypeeditor attribute of id ["+element.get()[0].id+"] Error info:"+e.toString())}}}function apply(){try{jTAC._internal.pushContext("datatypeeditor-unobtrusive.apply()");var elements=$("input[type=text]");elements.each(applyOne)}finally{jTAC._internal.popContext()}}if(!window.jTAC_DataTypeEditorOptions){jTAC.error("Requires the datatypeeditor scripts.")}$(document).ready(apply)})(jQuery);(function($){function applyOne(idx,element){element=$(element);var options=element.data("jtac-datetextbox");if(options!=null){element.data("datetextbox",null);try{if(options){if(typeof options=="string"){options=window.eval("("+options+");")}element.dateTextBox(options)}else{element.dateTextBox()}}catch(e){jTAC.error("Could not parse the data-jtac-datetextbox attribute of id ["+element.get()[0].id+"] Error info:"+e.toString())}}}function apply(){try{jTAC._internal.pushContext("datetextbox-unobtrusive.apply()");var elements=$("input[type=text]");elements.each(applyOne)}finally{jTAC._internal.popContext()}}if(jTAC.TypeManagers.BaseDate){if(!window.jTAC_DataTypeEditorOptions){jTAC.error("Requires the datatypeeditor scripts.")}$(document).ready(apply)}})(jQuery);